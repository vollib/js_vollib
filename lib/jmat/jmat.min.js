/*

Jmat.js

Copyright (c) 2011-2016, Lode Vandevenne
All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:
1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.
3. The name of the author may not be used to endorse or promote products
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
function Jmat(){}Jmat.Real=function(){};Jmat.Real.cast=function(a){return a&&void 0!=a.re?a.re:void 0==a?0:a};Jmat.Real.caststrict=function(a){return a&&void 0!=a.re?0==a.im?a.re:NaN:void 0==a?0:a};Jmat.Real.SQRT2=Math.sqrt(2);Jmat.Real.SQRTPI=Math.sqrt(Math.PI);Jmat.Real.EM=.5772156649015329;Jmat.Real.APERY=1.2020569;Jmat.Real.BIGGESTJSINT=9007199254740992;Jmat.Real.BIGGESTJSPRIME=9007199254740881;Jmat.Real.isInt=function(a){return a==Math.floor(a)};
Jmat.Real.isPositiveInt=function(a){return a==Math.floor(a)&&0<a};Jmat.Real.isNegativeInt=function(a){return a==Math.floor(a)&&0>a};Jmat.Real.isPositiveIntOrZero=function(a){return a==Math.floor(a)&&0<=a};Jmat.Real.isNegativeIntOrZero=function(a){return a==Math.floor(a)&&0>=a};Jmat.Real.isOdd=function(a){return 1==Math.abs(a%2)};Jmat.Real.isEven=function(a){return 0==a%2};Jmat.Real.isPOT=function(a){return 0!=a&&0==(a&a-1)};Jmat.Real.isInfOrNaN=function(a){return Infinity==a||-Infinity==a||isNaN(a)};
Jmat.Real.dist=function(a,b){return a==b?0:Math.abs(a-b)};Jmat.Real.cheb=function(a,b){return Jmat.Real.dist(a,b)};Jmat.Real.manhattan=function(a,b){return Jmat.Real.dist(a,b)};Jmat.Real.mod=function(a,b){return a-Math.floor(a/b)*b};Jmat.Real.rem=function(a,b){return a%b};Jmat.Real.wrap=function(a,b,c){if(b==c)return b;var d=Math.min(b,c);return d+Jmat.Real.mod(a-d,Math.max(b,c)-d)};Jmat.Real.clamp=function(a,b,c){return Math.max(Math.min(b,c),Math.min(Math.max(b,c),a))};
Jmat.Real.idiv=function(a,b){return Math.floor(a/b)};
Jmat.Real.gamma=function(a){if(Infinity==a)return Infinity;if(Jmat.Real.useFactorialLoop_(a-1))return Jmat.Real.factorial(a-1);if(.5==a)return Jmat.Real.SQRTPI;var b=function(a){if(0>=a&&a==Math.round(a))return Infinity;if(.5>a)return Math.PI/(Math.sin(Math.PI*a)*b(1-a));var d=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9.984369578019572E-6,1.5056327351493116E-7];--a;for(var e=d[0],f=1;9>f;f++)e+=d[f]/(a+f);d=
a+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(d,a+.5)*Math.exp(-d)*e};return b(a)};Jmat.Real.factorialmem_=[1];Jmat.Real.useFactorialLoop_=function(a){return Jmat.Real.isPositiveIntOrZero(a)&&200>a};Jmat.Real.factorial=function(a){if(!Jmat.Real.useFactorialLoop_(a))return Jmat.Real.gamma(a+1);if(Jmat.Real.factorialmem_[a])return Jmat.Real.factorialmem_[a];for(var b=Jmat.Real.factorialmem_[Jmat.Real.factorialmem_.length-1],c=Jmat.Real.factorialmem_.length;c<=a;c++)b*=c,Jmat.Real.factorialmem_[c]=b;return b};
Jmat.Real.isPowerOf=function(a,b){var c=Jmat.Real;if(a==b)return 1;if(0>=b||0>=a||1==a||b>a)return 0;if(c.isPOT(a)&&c.isPOT(b)){var d=c.ilog2(a),c=c.ilog2(b);return 0==d%c?d/c:0}if(c.isPOT(a)!=c.isPOT(b)||c.isEven(a)!=c.isEven(b))return 0;for(var d=b,c=[],e=b,f=1;d<a;){c.push(e);d*=e;f*=2;if(d==a)return f;e*=e}if(Infinity==d)return 0;for(;0<c.length;)if(e=c.pop(),d>a?(d/=e,f-=1<<c.length):(d*=e,f+=1<<c.length),d==a)return f;return 0};
Jmat.Real.firstPrimes_=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97];Jmat.Real.isPrimeInit_=function(a){if(Infinity==a||a!=a)return NaN;if(a!=Math.round(a)||2>a)return 0;if(a>Jmat.Real.BIGGESTJSINT)return NaN;for(var b=0;b<Jmat.Real.firstPrimes_.length;b++){if(a==Jmat.Real.firstPrimes_[b])return 1;if(0==a%Jmat.Real.firstPrimes_[b])return 0}return-1};
Jmat.Real.isPrimeSlow_=function(a){var b=Jmat.Real.isPrimeInit_(a);if(-1!=b)return b;for(var b=Jmat.Real.firstPrimes_[Jmat.Real.firstPrimes_.length-1],c=Math.ceil(Math.sqrt(a))+6,b=6*Math.floor(b/6);b<c;){if(0==a%(b-1)||0==a%(b+1))return 0;b+=6}return 1};
Jmat.Real.isPrimeMillerRabin_=function(a){var b=Jmat.Real.isPrimeInit_(a);if(-1!=b)return b;for(var b=1373653>a?[2,3]:9080191>a?[31,73]:4759123141>a?[2,7,61]:1122004669633>a?[2,13,23,1662803]:2152302898747>a?[2,3,5,7,11]:3474749660383>a?[2,3,5,7,11,13]:341550071728321>a?[2,3,5,7,11,13,17]:0xd655278977733>a?[2,2570940,880937,610386380,4130785767]:[2,325,9375,28178,450775,9780504,1795265022],c=Math.floor(a/2),d=1;!(c&1);)c=Math.floor(c/2),++d;for(var e=function(a,b,c){return a+b<Jmat.Real.BIGGESTJSINT?
(a+b)%c:a+b>c?(a-c+b)%c:(a%c+b%c)%c},f=function(a,b,c){if(a*b<Jmat.Real.BIGGESTJSINT)return a*b%c;var d=0;for(a%=c;0<b;)b&1&&(d=e(d,a,c)),a=e(a,a,c),b=Math.floor(b/2);return d%c},g=function(a,b,c,d){for(var e=1;0<c;)c&1&&(e=f(e,d,a)),d=f(d,d,a),c=Math.floor(c/2);for(d=e;b;){var g=f(d,d,a);if(1==g&&1!=d&&d!=a-1)return!1;d=g;b--}return 1==g},h=0;h<b.length;h++)if(!g(a,d,c,b[h]))return 0;return 1};Jmat.Real.isPrime=function(a){return 15E5>a?Jmat.Real.isPrimeSlow_(a):Jmat.Real.isPrimeMillerRabin_(a)};
Jmat.Real.eratosthenes=function(a){if(2>a)return[];for(var b=[2],c=[],d=Math.floor(Math.sqrt(a)),e=Math.ceil(a/2),f=0;f<e;f++)c[f]=!0;for(var g=3;g<=d;g+=2)if(f=Math.floor(g/2),c[f])for(f+=g;f<e;f+=g)c[f]=!1;for(f=1;f<=a;f++)c[f]&&b.push(2*f+1);return b};
Jmat.Real.smallestPrimeFactor=function(a){if(Infinity==a||a!=a||a!=Math.round(a)||1>a||a>Jmat.Real.BIGGESTJSINT)return NaN;if(1==a)return 1;for(var b=0;b<Jmat.Real.firstPrimes_.length;b++){if(a==Jmat.Real.firstPrimes_[b])return a;if(0==a%Jmat.Real.firstPrimes_[b])return Jmat.Real.firstPrimes_[b]}for(var b=Jmat.Real.firstPrimes_[Jmat.Real.firstPrimes_.length-1],c=Math.ceil(Math.sqrt(a)),b=6*Math.floor(b/6);b<c+5;){if(0==a%(b-1))return b-1;if(0==a%(b+1))return b+1;b+=6}return a};
Jmat.Real.factorize=function(a){if(!(a>Jmat.Real.BIGGESTJSINT)){a=Math.round(a);var b=[];0>a&&(a=-a,b.push(-1));if(2>=a)return 0!=b.length&&1==a||b.push(a),b;for(;!(1>a);){var c=Jmat.Real.smallestPrimeFactor(a);b.push(c);if(a==c)break;a=Math.round(a/c)}return b}};
Jmat.Real.primeCount=function(a){var b=[0,2,3,5,7,11,13,17],c=function(a){if(a<b.length)return b[a];for(var c=b[b.length-1]+2,d=b.length-1;;){if(Jmat.Real.isPrime(c)&&(b.push(c),d++,d==a))return c;c+=2}},d={},e=function(a,b){if(0==b)return Math.floor(a);if(1==b)return Math.floor((a+1)/2);if(d[a]&&void 0!=d[a][b])return d[a][b];var f=e(a,b-1)-e(Math.floor(a/c(b)),b-1);d[a]||(d[a]={});return d[a][b]=f},f={},g=function(a){if(1E9<a)return NaN;if(2>a)return 0;if(3>a)return 1;if(5>a)return 2;var b=Math.floor(a);
if(f[b])return f[b];var d=Math.floor(g(Math.pow(a,.25))),m=Math.floor(g(Math.sqrt(a)));a=Math.floor(g(Math.pow(a,1/3)));for(var n=e(b,d)+Math.floor((m+d-2)*(m-d+1)/2),d=d+1;d<=m;d++){var p=b/c(d),n=n-g(p);if(d<=a)for(var r=g(Math.sqrt(p)),q=d;q<=r;q++)n-=g(p/c(q))-q+1}return f[b]=n};return g(a)};
Jmat.Real.nearestPrime=function(a){a=Math.round(a);if(7>a)return 2>=a?2:4>=a?3:5;if(Infinity==a||a!=a||9007199254740881<=a)return NaN;if(Jmat.Real.isPrime(a))return a;for(var b=a%6,c=6-b,d=0,e=0;;){Jmat.Real.isPrime(a-d-b+1)?e=a-d-b+1:Jmat.Real.isPrime(a-d-b-1)&&(e=a-d-b-1);(!e||a-e>d+c-1)&&Jmat.Real.isPrime(a+d+c-1)?e=a+d+c-1:(!e||a-e>d+c+1)&&Jmat.Real.isPrime(a+d+c+1)&&(e=a+d+c+1);if(e)return e;d+=6}};
Jmat.Real.nextPrime=function(a){a=Math.floor(a);if(2>a)return 2;if(3>a)return 3;if(Infinity==a||a!=a||9007199254740881<=a)return NaN;var b=a%6,c=2;0==b||5==b?(a+=0==b?1:2,c=4):a+=5-b;for(;;){if(Jmat.Real.isPrime(a))return a;a+=c;c^=6}};
Jmat.Real.previousPrime=function(a){a=Math.ceil(a);if(2>=a)return NaN;if(3>=a)return 2;if(5>=a)return 3;if(7>=a)return 5;if(Infinity==a||a!=a||a>Jmat.Real.BIGGESTJSINT)return NaN;var b=a%6,c=2;0==b||1==b?(a-=b+1,c=4):a-=b-1;for(;;){if(Jmat.Real.isPrime(a))return a;a-=c;c^=6}};Jmat.Real.eulerTotient=function(a){if(0>=a)return NaN;var b=Math.floor(a);a=Jmat.Real.factorize(b);for(var c=-1,d=0;d<a.length;d++)if(c!=a[d]){if(1==a[d])break;c=a[d];b*=1-1/a[d]}return b};
Jmat.Real.pascal_triangle_cache_=[[1],[1,1],[1,2,1],[1,3,3,1],[1,4,6,4,1],[1,5,10,10,5,1],[1,6,15,20,15,6,1],[1,7,21,35,35,21,7,1]];Jmat.Real.pascal_triangle=function(a,b){if(0>a||0>b||a<b||180<a)return NaN;for(var c=Jmat.Real.pascal_triangle_cache_;c.length<=a;){var d=c.length,e=d+1;c[d]=[];for(var f=0;f<e;f++)c[d][f]=0==f||f==e-1?1:c[d-1][f-1]+c[d-1][f]}return c[a][b]};
Jmat.Real.gcd=function(a,b){if(!Jmat.Real.isInt(a)||!Jmat.Real.isInt(b)||Math.abs(a)>Jmat.Real.BIGGESTJSINT||Math.abs(b)>Jmat.Real.BIGGESTJSINT)return NaN;for(;;){if(0==b)return Math.abs(a);var c=Jmat.Real.mod(a,b);a=b;b=c}};Jmat.Real.lcm=function(a,b){return Math.abs(a*b)/Jmat.Real.gcd(a,b)};
Jmat.Real.decompose=function(a,b){b||(b=1E5);var c=0>a;c&&(a=-a);var d=Math.floor(a),e=a-d;if(0==e)return[a,1];for(var f,g=0,h=1,k=1,l=1;h<=b&&l<=b;){var m=(g+k)/(h+l);if(e==m){f=h+l<=b?[g+k,h+l]:l>h?[k,l]:[g,h];break}else e>m?(g+=k,h+=l):(k=g+k,l=h+l)}f||(f=h>b?[k,l]:[g,h]);f[0]+=d*f[1];c&&(f[0]=-f[0]);return f};
Jmat.Real.decomposeSemiFast=function(a,b){if(1E3>b)return Jmat.Real.decompose(a,b);var c=Jmat.Real.decompose(a,1E3),d=c[0]/c[1];if(d==a)return c;var e=Jmat.Real.decomposeFast(a,1E3);return Math.abs(a-d)<Math.abs(a-e[0]/e[1])?c:e};Jmat.Real.decomposeFast=function(a,b){b||(b=1E5);var c=b-1;if(a<=c&&a>=-c&&(a<-1/c||a>1/c)){(c=0>a)&&(a=-a);var d=Math.floor(a),e,f=b;e=Math.floor((a-d)*f);var g=Jmat.Real.gcd(e,f),f=f/g;e/=g;e+=d*f;c&&(e=-e);return[e,f]}return[a,1]};
Jmat.Real.near=function(a,b,c){return a>=b-c&&a<=b+c};Jmat.Real.relnear=function(a,b,c){if(a==b)return!0;if(0==a||0==b||0>a!=0>b)return!1;a=Math.abs(a);b=Math.abs(b);return(a>b?a/b:b/a)<1+c};Jmat.Real.frac=function(a){return a-Math.floor(a)};Jmat.Real.fracn=function(a){return 0<a?a-Math.floor(a):-(-a-Math.floor(-a))};
Jmat.Real.lambertw=function(a){if(isNaN(a))return NaN;if(Infinity==a||-Infinity==a)return Infinity;if(a>=-1/Math.E&&703>=a){for(var b=10>a?0:Math.log(a)-Math.log(Math.log(a)),c=Math.max(30,0<a?10+Math.floor(a):30),d=0;d<c;d++)var e=Math.exp(b),b=b-(b*e-a)/(e+b*e);return b}if(0<a)for(b=1,c=0,d=Math.log(a)-Math.log(Math.log(a));;){if(0==b||.5*b==b||d+b==d)return d;e=d*Math.exp(d);if(Jmat.Real.near(e,a,1E-15))return d;e>a?(d-=b,-1==c&&(b*=.5),c=1):(d+=b,1==c&&(b*=.5),c=-1)}return NaN};
Jmat.Real.logy=function(a,b){return Math.log(a)/Math.log(b)};Jmat.Real.clz32=Math.clz32||function(a){for(var b=0;0<a;)a=Math.floor(a/2),b++;return 32-b};Jmat.Real.log2=Math.log2||function(a){return Math.log(a)/Math.LN2};Jmat.Real.ilog2=function(a){return 0>=a?NaN:2147483648>a?31-Jmat.Real.clz32(a):Math.floor(Jmat.Real.log2(Math.floor(a)+.5))};Jmat.Real.getNumBits=function(a){return Jmat.Real.ilog2(Math.abs(a))+1};Jmat.Real.log10=Math.log10||function(a){return Math.log(a)/Math.LN10};
Jmat.Real.root=function(a,b){return Math.pow(a,1/b)};
Jmat.Real.faddeeva=function(a,b){var c=Jmat.Real,d=2/c.SQRTPI,e=function(a,b){var c=Math.exp(a);return[c*Math.cos(b),c*Math.sin(b)]},f=function(a,b,c,d){return[a*c-b*d,a*d+b*c]},g=function(a,b){var c=a*a+b*b;return[a/c,-b/c]},h=a/6.3*a/6.3+b/4.4*b/4.4;if(0>b&&h>=.292*.292){if(0==a&&-26.64>b)return[Infinity,0];h=e(b*b-a*a,-2*a*b);d=c.faddeeva(-a,-b);return[2*h[0]-d[0],2*h[1]-d[1]]}c=[0,0];if(h<.292*.292){for(var k=(1-.85*b/4.4)*Math.sqrt(h),h=Math.ceil(6+72*k),g=1,k=[b*b-a*a,-2*a*b],l=[b,-a],m=0;m<
h;m++)0<m&&(g*=-m,l=f(l[0],l[1],k[0],k[1])),c[0]+=l[0]/(g*(2*m+1)),c[1]+=l[1]/(g*(2*m+1));h=e(k[0],k[1]);c=f(h[0],h[1],c[0],c[1]);c[0]=h[0]-c[0]*d;c[1]=h[1]-c[1]*d}else{if(1>h){k=(1-b/4.4)*Math.sqrt(1-h);m=Math.ceil(16+26*k)+1;h=Math.ceil(7+34*k)+1;e=1.88*k;for(k=[0,0];m>h;m--)k=g(2*(b+m*k[0]+e),2*(m*k[1]-a));l=Math.pow(2*e,h-1);for(m=h;0<m;m--)k=g(2*(b+m*k[0]+e),2*(m*k[1]-a)),c=f(c[0]+l,c[1],k[0],k[1]),l/=2*e}else for(m=Math.ceil(3+1442/(26*Math.sqrt(h)+77))+1;0<m;m--)c=g(2*(b+m*c[0]),2*(m*c[1]-
a));c[0]*=d;c[1]*=d}0==a&&(c[1]=0);0==b&&(c[0]=Math.exp(-a*a));return c};Jmat.Real.erfcx=function(a){return Jmat.Real.faddeeva(0,a)[0]};Jmat.Real.erf=function(a){var b=Math.exp(-a*a);return 0<=a?1-b*Jmat.Real.faddeeva(0,a)[0]:b*Jmat.Real.faddeeva(0,-a)[0]-1};Jmat.Real.erfc=function(a){var b=Math.exp(-a*a);return 0<=a?b*Jmat.Real.faddeeva(0,a)[0]:2-b*Jmat.Real.faddeeva(0,-a)[0]};Jmat.Real.erfi=function(a){return Math.exp(a*a)*Jmat.Real.faddeeva(a,0)[1]};
Jmat.Real.dawson=function(a){var b=Math.exp(-a*a);a=Jmat.Real.faddeeva(a,0)[1];return Jmat.Real.SQRTPI/2*-(b-a)};Jmat.Real.erf_fast_=function(a){var b=0>a;b&&(a=-a);if(0==a)return 0;var c=1/(1+.3275911*a);a=1-c*(.254829592+c*(-.284496736+c*(1.421413741+c*(-1.453152027+1.061405429*c))))*Math.exp(-(a*a));b&&(a=-a);return a};
Jmat.Real.erfc_fast_=function(a){var b=0>a;b&&(a=-a);if(.5>=a){var c=a*a,d=a*c,e=d*c;a=1-2/Jmat.Real.SQRTPI*(a-d/3+e/10+e*c/42)}else 5<=a?(c=a*a,d=c*c,e=d*c,a=Math.exp(-(a*a))/(a*Jmat.Real.SQRTPI)*(1-.5/c+.75/d-1.875/e+6.5625/(e*c))):(c=1/(1+.3275911*a),a=c*(.254829592+c*(-.284496736+c*(1.421413741+c*(-1.453152027+1.061405429*c))))*Math.exp(-(a*a)));b&&(a=2-a);return a};
Jmat.Real.dawson_fast_=function(a){var b=a*a,c=b*b,d=c*b,e=d*b,f=e*b;return(1+.1049934947*b+.0424060604*c+.0072644182*d+5.064034E-4*e+1.789971E-4*f)/(1+.7715471019*b+.2909738639*c+.0694555761*d+.0140005442*e+8.327945E-4*f+3.579942E-4*f*b)*a};
Jmat.Real.erfi_fast_=function(a){var b=!1;0>a&&(a=-a,b=!0);var c=0,c=1/Jmat.Real.SQRTPI;if(.5>=a)var d=a*a*a,e=d*a*a,c=c*(2*a+2/3*d+.2*e+1/21*e*a*a);else if(5<=a){var d=1/a,e=d*d*d,f=e*d*d;a=Math.exp(a*a);c=c*a*(d+.5*e+.75*f+1.875*f*d*d)}else c=2/Jmat.Real.SQRTPI*Math.exp(a*a)*Jmat.Real.dawson(a);b&&(c=-c);return c};Jmat.Real.dms=function(a){var b=0>a;b&&(a=-a);var c=Math.floor(a),d=Math.floor(60*a-60*c);a=c+d/100+Math.floor(3600*a-3600*c-60*d)/1E4;b&&(a=-a);return a};
Jmat.Real.dd=function(a){var b=0>a;b&&(a=-a);var c=Math.floor(a),d=Math.floor(100*a-100*c);a=c+d/60+Math.floor(1E4*a-1E4*c-100*d)/3600;b&&(a=-a);return a};Jmat.Real.round=function(a){var b=Math.floor(a);a-=b;return.5==a?0==b%2?b:b+1:.5>a?b:b+1};Jmat.Real.trunc=Math.trunc||function(a){return 0>a?Math.ceil(a):Math.floor(a)};Jmat.Real.lerp=function(a,b,c){return(1-c)*a+c*b};Jmat.Real.sinh=Math.sinh||function(a){return(Math.exp(a)-Math.exp(-a))/2};
Jmat.Real.cosh=Math.cosh||function(a){return(Math.exp(a)+Math.exp(-a))/2};Jmat.Real.tanh=Math.tanh||function(a){return 354<a?1:(Math.exp(2*a)-1)/(Math.exp(2*a)+1)};Jmat.Real.asinh=Math.asinh||function(a){return-Infinity==a?a:Math.log(a+Math.sqrt(a*a+1))};Jmat.Real.acosh=Math.acosh||function(a){return Math.log(a+Math.sqrt(a*a-1))};Jmat.Real.atanh=Math.atanh||function(a){return Math.log((1+a)/(1-a))/2};
Jmat.Real.hypot=function(a,b){a=Math.abs(a);b=Math.abs(b);var c=Math.min(a,b);a=Math.max(a,b);if(Infinity==a)return Infinity;c/=a;return a*Math.sqrt(1+c*c)};Jmat.Real.expm1=function(a){return 1E-5>Math.abs(a)?a+a*a/2+a*a*a/6:Math.exp(a)-1};Jmat.Real.abs=Math.abs;Jmat.Real.floor=Math.floor;Jmat.Real.ceil=Math.ceil;Jmat.Real.min=Math.min;Jmat.Real.max=Math.max;Jmat.Real.exp=Math.exp;Jmat.Real.log=Math.log;Jmat.Real.sqrt=Math.sqrt;Jmat.Real.pow=Math.pow;Jmat.Real.sin=Math.sin;Jmat.Real.cos=Math.cos;
Jmat.Real.tan=Math.tan;Jmat.Real.asin=Math.asin;Jmat.Real.acos=Math.acos;Jmat.Real.atan=Math.atan;Jmat.Real.atan2=Math.atan2;Jmat.Real.isLeapYear=function(a){return 0==a%400||0==a%4&&0!=a%100};Jmat.Real.montharray_=[-1,31,28,31,30,31,30,31,31,30,31,30,31];Jmat.Real.monthLength=function(a,b){return b&&2==a?29:Jmat.Real.montharray_[a]};
Jmat.Real.numDaysSince0=function(a,b,c){var d=Jmat.Real,e=0==a?0:d.idiv(a-1,4)-d.idiv(a-1,100)+d.idiv(a-1,400)+1,e=365*a+e;a=2<b?Jmat.Real.isLeapYear(a)?1:2:0;var f=8<b&&1==b%2?1:0;b=30*(b-1)+d.idiv(b,2)-a+f;return e+b+c-1};Jmat.Real.daysSince0ToDate=function(a){var b=Math.floor(a/365.2425),c=Jmat.Real.isLeapYear(b);a-=Jmat.Real.numDaysSince0(b,1,1);for(var d=0,e=1;12>=e;e++){d++;var f=Jmat.Real.monthLength(e,c);if(a>=f)a-=f;else break}return[b,d,a+1]};
Jmat.Real.dayOfWeek=function(a,b,c){var d=Jmat.Real;c+=3>b?a--:a-2;return(d.idiv(23*b,9)+c+4+d.idiv(a,4)-d.idiv(a,100)+d.idiv(a,400))%7};Jmat.Real.matrix_add=function(a,b){if(a.length==b.length&&a[0].length==b[0].length){for(var c=[],d=0;d<a.length;d++){c[d]=[];for(var e=0;e<a[d].length;e++)c[d][e]=a[d][e]+b[d][e]}return c}};Jmat.Real.matrix_sub=function(a,b){if(a.length==b.length&&a[0].length==b[0].length){for(var c=[],d=0;d<a.length;d++){c[d]=[];for(var e=0;e<a[d].length;e++)c[d][e]=a[d][e]-b[d][e]}return c}};
Jmat.Real.matrix_mul=function(a,b){var c=a.length,d=a[0].length,e=b[0].length;if(d==b.length){for(var f=[],g=0;g<c;g++)f[g]=[];for(var h=[],k=0;k<e;k++){for(var l=0;l<d;l++)h[l]=b[l][k];for(g=0;g<c;g++){for(var m=0,l=0;l<d;l++)m+=a[g][l]*h[l];f[g][k]=m}}return f}};Jmat.Real.matrix_mulr=function(a,b){for(var c=[],d=0;d<a.length;d++){c[d]=[];for(var e=0;e<a[d].length;e++)c[d][e]=a[d][e]*b}return c};
Jmat.Real.matrix_divr=function(a,b){for(var c=[],d=0;d<a.length;d++){c[d]=[];for(var e=0;e<a[d].length;e++)c[d][e]=a[d][e]/b}return c};Jmat.Real.matrix_transpose=function(a){for(var b=[],c=0;c<a[0].length;c++){b[c]=[];for(var d=0;d<a.length;d++)b[c][d]=a[d][c]}return b};
Jmat.Real.matrix_rref=function(a){for(var b=a.length,c=a[0].length,d=function(a,b,c){var d=a[b];a[b]=a[c];a[c]=d},e=function(a,b,c,d,e){for(var f=a[0].length;b<f;b++)a[d][b]-=e*a[c][b]},f=function(a,b,d,e){for(;b<c;b++)a[d][b]*=e},g=[],h=0,k=0;k<c;k++){var l=Jmat.Real.argmax(h,b,function(b){return Math.abs(a[b][k])});if(0!=a[l][k]){h!=l&&d(a,h,l);f(a,k,h,1/a[h][k]);for(l=h+1;l<b;l++)0!=a[l][k]&&e(a,k,h,l,a[l][k]),a[l][k]=0;g.push(k);h++;if(h>=b)break}}for(k=0;k<g.length;k++)for(b=g[k],d=k-1;0<=d;d--)0!=
a[d][b]&&e(a,b,k,d,a[d][b]),a[d][b]=0;return a};Jmat.Real.matrix_solve=function(a,b){for(var c=[],d=0;d<a.length;d++){c[d]=[];for(var e=0;e<a[d].length;e++)c[d][e]=a[d][e];c[d].push(b[d]||0)}c=Jmat.Real.matrix_rref(c);d=[];for(e=0;e<c[0].length-1;e++)d[e]=c[e][c[e].length-1];return d};
Jmat.Real.matrix_jacobi=function(a,b,c,d){d=void 0==d?1E-15:d;for(var e=0;e<c;e++){b[e]=[];for(var f=0;f<c;f++)b[e][f]=f==e?1:0}for(var g=0,e=0;e<c;e++)for(f=e+1;f<c;f++)f!=e&&(g+=2*a[e][f]*a[e][f]);for(;g>d;)for(e=0;e<c;e++)for(f=e+1;f<c;f++)if(!(a[e][f]*a[e][f]<=g/(2*c*c))){for(var g=g-2*a[e][f]*a[e][f],h=(a[f][f]-a[e][e])/(2*a[e][f]),h=Math.sign(h)/(Math.abs(h)+Math.sqrt(h*h+1)),k=1/Math.sqrt(h*h+1),l=k*h,h=0;h<c;h++){var m=a[h][e];a[h][e]=k*a[h][f]+l*m;a[h][f]=l*a[h][f]-k*m}for(h=0;h<c;h++)m=
a[e][h],a[e][h]=k*a[f][h]+l*m,a[f][h]=l*a[f][h]-k*m,m=b[e][h],b[e][h]=k*b[f][h]+l*m,b[f][h]=l*b[f][h]-k*m}for(h=0;h<c;h++){d=h;for(e=h+1;e<c;e++)a[e][e]>a[d][d]&&(d=e);if(h!=d)for(m=a[d][d],a[d][d]=a[h][h],a[h][h]=m,e=0;e<c;e++)m=b[d][e],b[d][e]=b[h][e],b[h][e]=m}};Jmat.Real.argmax=function(a,b,c){var d=c(a),e=a;for(a+=1;a<b;a++){var f=c(a);f>d&&(d=f,e=a)}return e};/*

License of Jmat.Complex.kiss_fft_ (converted from C to JavaScript):
Kiss FFT
Copyright (c) 2003-2010, Mark Borgerding
All rights reserved.
Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
 Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
 Neither the author nor the names of any contributors may be used to endorse or promote products derived from this software without specific prior written permission.
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
Jmat.Complex=function(a,b){if(this instanceof Jmat.Complex)this.re=a,this.im=b;else return Jmat.Complex.make(a,b)};Jmat.Complex.make=function(a,b){return void 0==a?new Jmat.Complex(0,0):"number"==typeof a?new Jmat.Complex(a,void 0==b?0:b):"string"==typeof a?Jmat.Complex.parse(a):new Jmat.Complex(a.re,a.im)};Jmat.Complex.newr=function(a){return new Jmat.Complex(a,0)};Jmat.Complex.newi=function(a){return new Jmat.Complex(0,a)};
Jmat.Complex.polar=function(a,b){return new Jmat.Complex(a*Math.cos(b),a*Math.sin(b))};Jmat.Complex.cast=function(a){return a&&void 0!=a.re?a:void 0==a?Jmat.Complex(0):Jmat.Complex(a)};Jmat.Complex.copy=function(a){return new Jmat.Complex(a.re,a.im)};Jmat.Complex.formatFloat_=function(a,b){var c=Math.pow(10,b||0);return String(Math.round(a*c)/c)};
Jmat.Complex.toString=function(a,b){if(!a)return 0==a?"invalid0":""+a;var c=b?Jmat.Complex.formatFloat_(a.re,b):""+a.re,d=b?Jmat.Complex.formatFloat_(a.im,b):""+a.im;return 0==a.im||"0"==d?""+c:0==a.re?""+d+"i":0>a.im?""+c+d+"i":""+c+"+"+d+"i"};Jmat.Complex.prototype.toString=function(a){return Jmat.Complex.toString(this,a)};
Jmat.Complex.parse=function(a){var b=a.indexOf("i");if(-1==b)return Jmat.Complex(parseFloat(a));if("i"==a)return Jmat.Complex(0,1);a=a.substr(0,b);a=a.replace(/ /g,"");if("+"==a[b-1]||"-"==a[b-1])a+="1";for(b=1;b<a.length;b++)if(("+"==a[b]||"-"==a[b])&&"e"!=a[b-1]&&"E"!=a[b-1])return Jmat.Complex(parseFloat(a.substr(0,b)),parseFloat(a.substr(b)));return Jmat.Complex(0,parseFloat(a))};Jmat.Complex.ZERO=Jmat.Complex(0);Jmat.Complex.ONE=Jmat.Complex(1);Jmat.Complex.TWO=Jmat.Complex(2);
Jmat.Complex.I=Jmat.Complex.newi(1);Jmat.Complex.PI=Jmat.Complex(Math.PI);Jmat.Complex.E=Jmat.Complex(Math.E);Jmat.Complex.SQRT2=Jmat.Complex(Math.sqrt(2));Jmat.Complex.SQRTPI=Jmat.Complex(Math.sqrt(Math.PI));Jmat.Complex.INVSQRT2PI=Jmat.Complex(1/Math.sqrt(2*Math.PI));Jmat.Complex.EM=Jmat.Complex(Jmat.Real.EM);Jmat.Complex.APERY=Jmat.Complex(Jmat.Real.APERY);Jmat.Complex.real=function(a){return Jmat.Complex(a.re)};Jmat.Complex.prototype.real=function(){return Jmat.Complex(this.re)};
Jmat.Complex.imag=function(a){return Jmat.Complex(a.im)};Jmat.Complex.prototype.imag=function(){return Jmat.Complex(this.im)};Jmat.Complex.add=function(a,b){return new Jmat.Complex(a.re+b.re,a.im+b.im)};Jmat.Complex.prototype.add=function(a){return new Jmat.Complex(this.re+a.re,this.im+a.im)};Jmat.Complex.sub=function(a,b){return new Jmat.Complex(a.re-b.re,a.im-b.im)};Jmat.Complex.prototype.sub=function(a){return new Jmat.Complex(this.re-a.re,this.im-a.im)};
Jmat.Complex.mul=function(a,b){return 0==a.im&&0==b.im?new Jmat.Complex(a.re*b.re,0):new Jmat.Complex(a.re*b.re-a.im*b.im,a.im*b.re+a.re*b.im)};Jmat.Complex.prototype.mul=function(a){return Jmat.Complex.mul(this,a)};
Jmat.Complex.div=function(a,b){if(0==a.im&&0==b.im)return new Jmat.Complex(a.re/b.re,0);if(Jmat.Complex.isInf(a)&&!Jmat.Complex.isInfOrNaN(b))return a;var c=b.re*b.re+b.im*b.im;if((Infinity==c||-Infinity==c)&&!Jmat.Complex.isInfOrNaN(a))return Jmat.Complex(0);if(0==c&&!Jmat.Complex.isInfOrNaN(a)&&(0!=a.re||0!=a.im))return new Jmat.Complex(0==a.re?0:0>a.re?-Infinity:Infinity,0==a.im?0:0>a.im?-Infinity:Infinity);var c=1/c,d;1<c?(d=(a.re*b.re+a.im*b.im)*c,c*=a.im*b.re-a.re*b.im):(d=a.re*c*b.re+a.im*
c*b.im,c=a.im*c*b.re-a.re*c*b.im);return new Jmat.Complex(d,c)};Jmat.Complex.prototype.div=function(a){return Jmat.Complex.div(this,a)};Jmat.Complex.addr=function(a,b){return new Jmat.Complex(a.re+b,a.im)};Jmat.Complex.prototype.addr=function(a){return new Jmat.Complex(this.re+a,this.im)};Jmat.Complex.addi=function(a,b){return new Jmat.Complex(a.re,a.im+b)};Jmat.Complex.prototype.addi=function(a){return new Jmat.Complex(this.re,this.im+a)};
Jmat.Complex.subr=function(a,b){return new Jmat.Complex(a.re-b,a.im)};Jmat.Complex.prototype.subr=function(a){return new Jmat.Complex(this.re-a,this.im)};Jmat.Complex.rsub=function(a,b){return new Jmat.Complex(a-b.re,-b.im)};Jmat.Complex.prototype.rsub=function(a){return new Jmat.Complex(a-this.re,-this.im)};Jmat.Complex.subi=function(a,b){return new Jmat.Complex(a.re,a.im-b)};Jmat.Complex.prototype.subi=function(a){return new Jmat.Complex(this.re,this.im-a)};
Jmat.Complex.mulr=function(a,b){return new Jmat.Complex(a.re*b,a.im*b)};Jmat.Complex.prototype.mulr=function(a){return new Jmat.Complex(this.re*a,this.im*a)};Jmat.Complex.muli=function(a,b){return new Jmat.Complex(-a.im*b,a.re*b)};Jmat.Complex.prototype.muli=function(a){return new Jmat.Complex(-this.im*a,this.re*a)};Jmat.Complex.divr=function(a,b){return new Jmat.Complex(a.re/b,a.im/b)};Jmat.Complex.prototype.divr=function(a){return new Jmat.Complex(this.re/a,this.im/a)};
Jmat.Complex.rdiv=function(a,b){return new Jmat.Complex.div(Jmat.Complex(a),b)};Jmat.Complex.prototype.rdiv=function(a){return Jmat.Complex.div(Jmat.Complex(a),this)};Jmat.Complex.divi=function(a,b){return new Jmat.Complex(a.im/b,-a.re/b)};Jmat.Complex.prototype.divi=function(a){return new Jmat.Complex(this.im/a,-this.re/a)};Jmat.Complex.rotate=function(a,b){return 0==b?a:Jmat.Complex.polar(a.abs(),a.arg()+b)};
Jmat.Complex.nextroot=function(a,b){var c=Jmat.Complex.rotate(a,2*Math.PI/b);Jmat.Real.near(c.im,0,1E-14)&&(c.im=0);return c};Jmat.Complex.mod=function(a,b){return 0!=a.im||0!=b.im?a.sub(Jmat.Complex.floor(a.div(b)).mul(b)):Jmat.Complex(Jmat.Real.mod(a.re,b.re))};Jmat.Complex.rem=function(a,b){return 0!=a.im||0!=b.im?a.sub(Jmat.Complex.trunc(a.div(b)).mul(b)):Jmat.Complex(a.re%b.re)};
Jmat.Complex.wrap=function(a,b,c){return new Jmat.Complex(Jmat.Real.wrap(a.re,b.re,c.re),Jmat.Real.wrap(a.im,b.im,c.im))};Jmat.Complex.clamp=function(a,b,c){return new Jmat.Complex(Jmat.Real.clamp(a.re,b.re,c.re),Jmat.Real.clamp(a.im,b.im,c.im))};Jmat.Complex.bitneg=function(a){var b=Jmat.Complex(0);b.re=~a.re;b.im=-a.im;return b};Jmat.Complex.bitand=function(a,b){var c=Jmat.Complex(0);c.re=a.re&b.re;c.im=a.im&b.im;return c};
Jmat.Complex.bitor=function(a,b){var c=Jmat.Complex(0);c.re=a.re|b.re;c.im=a.im|b.im;return c};Jmat.Complex.bitxor=function(a,b){var c=Jmat.Complex(0);c.re=a.re^b.re;c.im=a.im^b.im;return c};Jmat.Complex.lshift=function(a,b){var c=Jmat.Complex(0);c.re=a.re<<b.re;c.im=a.im<<b.im;return c};Jmat.Complex.rshift=function(a,b){var c=Jmat.Complex(0);c.re=a.re>>b.re;c.im=a.im>>b.im;return c};Jmat.Complex.neg=function(a){return Jmat.Complex(-a.re,-a.im)};
Jmat.Complex.prototype.neg=function(){return Jmat.Complex(-this.re,-this.im)};Jmat.Complex.sign=function(a){return 0==a.im?0==a.re?Jmat.Complex(0):0>a.re?Jmat.Complex(-1):Jmat.Complex(1):a.divr(a.abs())};Jmat.Complex.csgn=function(a){if(Jmat.Real.near(a.re,0,1E-15)){if(0==a.im)return Jmat.Complex(0);if(0>a.im)return Jmat.Complex(-1)}else{if(0==a.re)return Jmat.Complex(0);if(0>a.re)return Jmat.Complex(-1)}return Jmat.Complex(1)};
Jmat.Complex.sign1=function(a){return 0==a.im?0>a.re?Jmat.Complex(-1):Jmat.Complex(1):a.divr(a.abs())};Jmat.Complex.csgn1=function(a){if(Jmat.Real.near(a.re,0,1E-15))return 0>a.im?Jmat.Complex(-1):Jmat.Complex(1);if(0>a.re)return Jmat.Complex(-1);Jmat.Complex(1)};Jmat.Complex.copysign=function(a,b){return Jmat.Complex.abs(a).mul(Jmat.Complex.sign(b))};Jmat.Complex.conj=function(a){return Jmat.Complex(a.re,-a.im)};Jmat.Complex.prototype.conj=function(){return Jmat.Complex(this.re,-this.im)};
Jmat.Complex.eq=function(a,b){return a&&b?a.re==b.re&&a.im==b.im:a==b};Jmat.Complex.prototype.eq=function(a){return a&&this.re==a.re&&this.im==a.im};Jmat.Complex.eqr=function(a,b){return a.re==b&&0==a.im};Jmat.Complex.prototype.eqr=function(a){return this.re==a&&0==this.im};Jmat.Complex.inv=function(a){return Jmat.Complex.ONE.div(a)};Jmat.Complex.prototype.inv=function(){return Jmat.Complex.ONE.div(this)};Jmat.Complex.inc=function(a){return new Jmat.Complex(a.re+1,a.im)};
Jmat.Complex.prototype.inc=function(){return new Jmat.Complex(this.re+1,this.im)};Jmat.Complex.dec=function(a){return new Jmat.Complex(a.re-1,a.im)};Jmat.Complex.prototype.dec=function(){return new Jmat.Complex(this.re-1,this.im)};Jmat.Complex.abs=function(a){return Jmat.Complex(a.abs())};
Jmat.Complex.prototype.abs=function(){return 0==this.im?Math.abs(this.re):0==this.re?Math.abs(this.im):Infinity==this.re||-Infinity==this.re||Infinity==this.im||-Infinity==this.im?Infinity:Jmat.Real.hypot(this.re,this.im)};Jmat.Complex.abssq=function(a){return Jmat.Complex(a.re*a.re+a.im*a.im)};Jmat.Complex.prototype.abssq=function(){return this.re*this.re+this.im*this.im};Jmat.Complex.arg=function(a){return Jmat.Complex(a.arg())};
Jmat.Complex.prototype.arg=function(){return 0==this.im?0>this.re?Math.PI:0:Math.atan2(this.im,this.re)};Jmat.Complex.arg1=function(a){a=a.arg();0>a&&(a+=2*Math.PI);a/=2*Math.PI;0>a&&(a=0);1<a&&(a=1);return a};Jmat.Complex.abs1r=function(a){return Math.abs(a.re)+Math.abs(a.im)};Jmat.Complex.hypot=function(a,b){var c=Jmat.Complex;if(c.abs1r(b)>c.abs1r(a)){var d=a;a=b;b=d}if(c.isInf(a))return Infinity;d=b.div(a);return a.mul(c.sqrt(c.abssq(d).addr(1)))};Jmat.Complex.isReal=function(a){return 0==a.im};
Jmat.Complex.isImaginary=function(a){return 0==a.re};Jmat.Complex.isInt=function(a){return 0==a.im&&Jmat.Real.isInt(a.re)};Jmat.Complex.isGaussian=function(a){return Jmat.Real.isInt(a.re)&&Jmat.Real.isInt(a.im)};Jmat.Complex.isNaN=function(a){return!a||isNaN(a.re)||isNaN(a.im)};Jmat.Complex.isInf=function(a){return Infinity==Math.abs(a.re)||Infinity==Math.abs(a.im)};Jmat.Complex.isInfOrNaN=function(a){return!a||Jmat.Real.isInfOrNaN(a.re)||Jmat.Real.isInfOrNaN(a.im)};
Jmat.Complex.isPositive=function(a){return 0<a.re&&0==a.im};Jmat.Complex.isNegative=function(a){return 0>a.re&&0==a.im};Jmat.Complex.isPositiveOrZero=function(a){return 0<=a.re&&0==a.im};Jmat.Complex.isNegativeOrZero=function(a){return 0>=a.re&&0==a.im};Jmat.Complex.isPositiveInt=function(a){return Jmat.Complex.isInt(a)&&0<a.re};Jmat.Complex.isNegativeInt=function(a){return Jmat.Complex.isInt(a)&&0>a.re};Jmat.Complex.isPositiveIntOrZero=function(a){return Jmat.Complex.isInt(a)&&0<=a.re};
Jmat.Complex.isNegativeIntOrZero=function(a){return Jmat.Complex.isInt(a)&&0>=a.re};Jmat.Complex.isOdd=function(a){return Jmat.Complex.isInt(a)&&1==Math.abs(a.re%2)};Jmat.Complex.isEven=function(a){return Jmat.Complex.isInt(a)&&0==a.re%2};
Jmat.Complex.pow=function(a,b){var c=Jmat.Complex;if(c.isReal(a)&&c.isReal(b)&&(0<=a.re||Infinity==b.re||-Infinity==b.re||Jmat.Real.isInt(b.re)))return c(Math.pow(a.re,b.re));if(a.eqr(0))return 0==b.re?c(NaN):c(0>b.re?Infinity:0);var d=a.abs(),e=a.arg(),f=Math.pow(d,b.re)*Math.exp(-b.im*e);isNaN(f)&&(f=Math.pow(1,b.re/d)*Math.exp(-b.im*e/d),f=0>f?-Infinity:0<f?Infinity:NaN);d=b.im*Math.log(d)+b.re*e;return c(f*Math.cos(d),f*Math.sin(d))};
Jmat.Complex.prototype.pow=function(a){return Jmat.Complex.pow(this,a)};Jmat.Complex.powr=function(a,b){return Jmat.Complex.pow(a,Jmat.Complex(b))};Jmat.Complex.prototype.powr=function(a){return Jmat.Complex.pow(this,Jmat.Complex(a))};Jmat.Complex.rpow=function(a,b){return Jmat.Complex.pow(Jmat.Complex(a),b)};Jmat.Complex.prototype.rpow=function(a){return Jmat.Complex.pow(Jmat.Complex(a),this)};
Jmat.Complex.sin=function(a){if(0==a.im)return Jmat.Complex(Math.sin(a.re));a=Jmat.Complex(-a.im,a.re);a=Jmat.Complex.exp(a);var b=Jmat.Complex.inv(a);return a.sub(b).div(Jmat.Complex(0,2))};Jmat.Complex.sinc=function(a){return a.eqr(0)?Jmat.Complex(1):Jmat.Complex.sin(a).div(a)};Jmat.Complex.cos=function(a){if(0==a.im)return Jmat.Complex(Math.cos(a.re));a=Jmat.Complex(-a.im,a.re);a=Jmat.Complex.exp(a);var b=Jmat.Complex.inv(a);return a.add(b).mulr(.5)};
Jmat.Complex.tan=function(a){if(0==a.im)return Jmat.Complex(Math.tan(a.re));a=Jmat.Complex(-a.im,a.re);a=Jmat.Complex.exp(a);var b=Jmat.Complex.inv(a);return a.sub(b).div(Jmat.Complex(0,2)).div(a.add(b).mulr(.5))};Jmat.Complex.asin=function(a){if(0==a.im&&-1<=a.re&&1>=a.re)return Jmat.Complex(Math.asin(a.re));var b=Jmat.Complex.sqrt(Jmat.Complex.ONE.sub(a.mul(a)));a=Jmat.Complex.log(Jmat.Complex(-a.im,a.re).add(b));return Jmat.Complex(a.im,-a.re)};
Jmat.Complex.acos=function(a){if(0==a.im&&-1<=a.re&&1>=a.re)return Jmat.Complex(Math.acos(a.re));var b=Jmat.Complex.sqrt(Jmat.Complex.ONE.sub(a.mul(a))).mul(Jmat.Complex.I);a=Jmat.Complex.log(a.add(b));return Jmat.Complex(a.im,-a.re)};Jmat.Complex.atan=function(a){if(0==a.im)return Jmat.Complex(Math.atan(a.re));a=Jmat.Complex(-a.im,a.re);a=Jmat.Complex.ONE.sub(a).div(a.inc());a=Jmat.Complex.log(a);return Jmat.Complex(-.5*a.im,.5*a.re)};
Jmat.Complex.atan2=function(a,b){var c=Jmat.Complex;return c.isReal(a)&&c.isReal(b)?(c=c(0),c.re=Math.atan2(a.re,b.re),c):b.eqr(0)?c(Math.PI/2):c.atan(a.div(b))};Jmat.Complex.sinh=function(a){a=Jmat.Complex.exp(a);var b=Jmat.Complex.inv(a);return a.sub(b).divr(2)};Jmat.Complex.cosh=function(a){a=Jmat.Complex.exp(a);var b=Jmat.Complex.inv(a);return a.add(b).divr(2)};
Jmat.Complex.tanh=function(a){if(350<a.re)return Jmat.Complex(1);if(-350>a.re)return Jmat.Complex(-1);a=Jmat.Complex.exp(a);var b=Jmat.Complex.inv(a);return a.sub(b).div(a.add(b))};Jmat.Complex.asinh=function(a){return Jmat.Complex.log(a.add(Jmat.Complex.sqrt(a.mul(a).addr(1))))};Jmat.Complex.acosh=function(a){return Jmat.Complex.log(a.add(Jmat.Complex.sqrt(a.subr(1)).mul(Jmat.Complex.sqrt(a.addr(1)))))};Jmat.Complex.atanh=function(a){return Jmat.Complex.log(a.addr(1).div(a.rsub(1))).mulr(.5)};
Jmat.Complex.logsin=function(a){if(-10<a.im&&10>a.im)return Jmat.Complex.log(Jmat.Complex.sin(a));var b=Jmat.Complex(.69314718056,1.570796326795),c=Jmat.Complex(Jmat.Real.wrap(a.re,-Math.PI/2,3*Math.PI/2),a.im);return 0<a.im?Jmat.Complex.newi(Jmat.Complex.PI).sub(Jmat.Complex.I.mul(c)).sub(b):Jmat.Complex.I.mul(c).sub(b)};Jmat.Complex.logcos=function(a){return Jmat.Complex.logsin(a.rsub(Math.PI/2))};Jmat.Complex.floor=function(a){var b=Jmat.Complex(0);b.re=Math.floor(a.re);b.im=Math.floor(a.im);return b};
Jmat.Complex.ceil=function(a){var b=Jmat.Complex(0);b.re=Math.ceil(a.re);b.im=Math.ceil(a.im);return b};Jmat.Complex.round=function(a){var b=Jmat.Complex(0);b.re=Jmat.Real.round(a.re);b.im=Jmat.Real.round(a.im);return b};Jmat.Complex.trunc=function(a){var b=Jmat.Complex(0);b.re=0>a.re?Math.ceil(a.re):Math.floor(a.re);b.im=0>a.im?Math.ceil(a.im):Math.floor(a.im);return b};Jmat.Complex.frac=function(a){return Jmat.Complex(Jmat.Real.frac(a.re),Jmat.Real.frac(a.im))};
Jmat.Complex.fracn=function(a){return Jmat.Complex(Jmat.Real.fracn(a.re),Jmat.Real.fracn(a.im))};Jmat.Complex.lerp=function(a,b,c){return c.rsub(1).mul(a).add(c.mul(b))};Jmat.Complex.exp=function(a){if(0==a.im)return Jmat.Complex(Math.exp(a.re));var b=Math.exp(a.re);return new Jmat.Complex(b*Math.cos(a.im),b*Math.sin(a.im))};Jmat.Complex.expm1=function(a){return 1E-5>a.abssq()?a.add(a.mul(a).divr(2)).add(a.mul(a).mul(a).divr(6)):Jmat.Complex.exp(a).subr(1)};
Jmat.Complex.log=function(a){return a.eqr(-Infinity)?Jmat.Complex(Infinity):Jmat.Complex.isReal(a)&&0<=a.re?Jmat.Complex(Math.log(a.re)):Jmat.Complex(Math.log(a.abs()),a.arg())};Jmat.Complex.log1p=function(a){return 1E-8>a.abssq()?a.mulr(-.5).addr(1).mul(a):Jmat.Complex.log(a.addr(1))};Jmat.Complex.logy=function(a,b){return Jmat.Complex.log(a).div(Jmat.Complex.log(b))};Jmat.Complex.logr=function(a,b){return Jmat.Complex.log(a).divr(Math.log(b))};Jmat.Complex.log2=function(a){return Jmat.Complex.log(a).divr(Math.LN2)};
Jmat.Complex.log10=function(a){return Jmat.Complex.log(a).divr(Math.LN10)};Jmat.Complex.sqrt=function(a){if(Jmat.Complex.isReal(a)){var b=Jmat.Complex(0);0<=a.re||a.re!=a.re?b.re=Math.sqrt(a.re):b.im=Math.sqrt(-a.re);return b}return a.pow(Jmat.Complex(.5))};Jmat.Complex.root=function(a,b){return a.pow(Jmat.Complex(Jmat.Complex.inv(b)))};Jmat.Complex.rootr=function(a,b){return a.pow(Jmat.Complex(1/b))};Jmat.Complex.toInt=function(a){return Math.round(a.re)};
Jmat.Complex.infNormalize=function(a){return Jmat.Complex.isNaN(a)?Jmat.Complex(NaN):Infinity==a.re?Infinity==a.im?Jmat.Complex(1,1):-Infinity==a.im?Jmat.Complex(1,-1):Jmat.Complex(1,0):-Infinity==a.re?Infinity==a.im?Jmat.Complex(-1,1):-Infinity==a.im?Jmat.Complex(-1,-1):Jmat.Complex(-1,0):Infinity==a.im?Infinity==a.re?Jmat.Complex(1,1):-Infinity==a.re?Jmat.Complex(-1,1):Jmat.Complex(0,1):-Infinity==a.im?Infinity==a.re?Jmat.Complex(1,-1):-Infinity==a.re?Jmat.Complex(-1,-1):Jmat.Complex(0,-1):a.divr(a.abs())};
Jmat.Complex.calcCache_=function(a,b,c,d){if(d){for(var e=0;e<d;e++)if(a.eq(c[2*e+1]))return c[2*e+2];e=c[0]||0;e++;e>=d&&(e=0);b=b(a);c[2*e+1]=a;c[2*e+2]=b;c[0]=e}else{if(a.eq(c[0]))return c[1];b=b(a);c[0]=a;c[1]=b}return b};
Jmat.Complex.gamma=function(a){if(Infinity==a.re)return Jmat.Complex(Infinity);if(Jmat.Complex.isNegativeIntOrZero(a))return Jmat.Complex(Infinity,Infinity);if(0==a.im)return Jmat.Complex(Jmat.Real.gamma(a.re));var b=function(a){if(.5>a.re){var d=Jmat.Complex.PI.div(Jmat.Complex.sin(Jmat.Complex.PI.mul(a))).div(b(Jmat.Complex.ONE.sub(a)));Jmat.Complex.isNaN(d)&&(d=Jmat.Complex(0));return d}var e=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,
-.13857109526572012,9.984369578019572E-6,1.5056327351493116E-7];a=a.subr(1);for(var d=Jmat.Complex(e[0]),f=1;9>f;f++)d=d.add(Jmat.Complex(e[f]).div(a.addr(f)));f=a.addr(7.5);e=Math.sqrt(2*Math.PI);a=f.pow(a.addr(.5));f=Jmat.Complex.exp(f.neg());return d=a.mul(f).mul(d).mulr(e)};return b(a)};Jmat.Complex.factorial=function(a){return Jmat.Complex.gamma(Jmat.Complex.inc(a))};Jmat.Complex.isPrime=function(a){return Jmat.Complex.isReal(a)?Jmat.Real.isPrime(a.re):0};
Jmat.Complex.decompose=function(a,b){if(Math.abs(a.re)>=Math.abs(a.im)){var c=Jmat.Real.decompose(a.re,b);return[Jmat.Complex(c[0],Math.round(a.im*c[1])),Jmat.Complex(c[1])]}c=Jmat.Real.decompose(a.im,b);return[Jmat.Complex(Math.round(a.re*c[1]),c[0]),Jmat.Complex(c[1])]};Jmat.Complex.near=function(a,b,c){c=void 0==c?1E-15:c;return a.re-c<=b.re&&a.re+c>=b.re&&a.im-c<=b.im&&a.im+c>=b.im};Jmat.Complex.nearr=function(a,b,c){c=void 0==c?1E-15:c;return a.re-c<=b&&a.re+c>=b&&0>=a.im-c&&0<=a.im+c};
Jmat.Complex.dist=function(a,b){return a.sub(b).abs()};Jmat.Complex.cheb=function(a,b){return Math.max(Jmat.Real.dist(a.re,b.re),Jmat.Real.dist(a.im,b.im))};Jmat.Complex.manhattan=function(a,b){return Math.max(Math.abs(a.re-b.re),Math.abs(a.im-b.im))};Jmat.Complex.relnear=function(a,b,c){return a.eq(b)?!0:a.sub(b).abs()<Math.max(a.abs(),b.abs())*c};
Jmat.Complex.lambertwb_generic_=function(a,b,c){if(a.isReal(c)&&-.36<c.re&&0==b)return a(Jmat.Real.lambertw(c));if(!Jmat.Real.isInt(b))return a(NaN);if(a.isNaN(c))return NaN;if(a.isInf(c))return a(Infinity);if(0==b&&c.eqr(0))return a(0);if(0!=b&&c.eqr(0))return a(-Infinity);var d=a.log(c).add(a(0,b*Math.PI*2));0==b&&1.2>c.abs()&&(d=a.sqrt(c.mulr(5.43656365691809).addr(2)).add(a(-1,b*Math.PI*2)));0!=b&&0==c.im&&(c.im+=1E-14);for(b=0;36>b;b++){var e=a.exp(d),f=d.mul(e),g=f.sub(c),e=e.mul(d.addr(1)),
h=d.addr(2).mul(g).div(d.mulr(2).addr(2)),d=d.sub(g.div(e.sub(h))),g=a.log(c.div(d));if(a.near(g,d,1E-16)||a.near(f,c,1E-16))break;if(36==b+1&&!a.near(g,d,1)&&!a.near(f,c,1))return a(NaN)}0==c.im&&0<=c.re&&(d.im=0);return d};Jmat.Complex.lambertwb=function(a,b){return Jmat.Complex.lambertwb_generic_(Jmat.Complex,a,b)};Jmat.Complex.lambertw=function(a){return Jmat.Complex.lambertwb(0,a)};Jmat.Complex.lambertwm=function(a){return Jmat.Complex.lambertwb(-1,a)};
Jmat.Complex.faddeeva=function(a){a=Jmat.Real.faddeeva(a.re,a.im);return Jmat.Complex(a[0],a[1])};Jmat.Complex.erfcx=function(a){return Jmat.Complex.faddeeva(Jmat.Complex(-a.im,a.re))};Jmat.Complex.erf=function(a){var b=Jmat.Complex.exp(a.mul(a).neg());if(0<=a.re)b=Jmat.Complex.ONE.sub(b.mul(Jmat.Complex.faddeeva(a.mul(Jmat.Complex.I))));else return b.mul(Jmat.Complex.faddeeva(a.mul(Jmat.Complex.I.neg()))).sub(Jmat.Complex.ONE);0==a.re&&(b.re=0);return b};
Jmat.Complex.erfc=function(a){var b=Jmat.Complex.exp(a.mul(a));return 0<=a.re?Jmat.Complex.faddeeva(a.mul(Jmat.Complex.I)).div(b):Jmat.Complex.TWO.sub(Jmat.Complex.faddeeva(a.mul(Jmat.Complex.I.neg())).div(b))};Jmat.Complex.erfi=function(a){return Jmat.Complex.erf(a.mul(Jmat.Complex.I)).mul(Jmat.Complex.I).neg()};Jmat.Complex.dawson=function(a){var b=Jmat.Complex.faddeeva(a);return Jmat.Complex.exp(a.mul(a).neg()).sub(b).mul(Jmat.Complex.I.mulr(Jmat.Real.SQRTPI/2))};
Jmat.Complex.random=function(a,b){a=void 0==a?0:a;return Jmat.Complex.polar(Math.random()*((void 0==b?1:b)-a)+a,Math.random()*Math.PI*2)};
Jmat.Complex.kiss_fft_=function(a,b,c){var d=function(a,b){this.nfft=a;this.inverse=b;this.factors=[];this.twiddles=[]},e=function(a,b,c,d,l,m,n,p,r){var q=n[p+0],u=n[p+1],t=0;if(1==u)for(var v=0;v<q*u;v++)a[v+b]=Jmat.Complex(c[d+t]),t+=l*m;else for(v=0;v<q*u;v+=u)e(a,b+v,c,d+t,l*q,m,n,p+2,r),t+=l*m;switch(q){case 2:for(c=q=0;c<u;c++)d=a[b+c+u].mul(r.twiddles[q]),q+=l,a[b+c+u]=a[b+c].sub(d),a[b+c]=a[b+c].add(d);break;case 3:q=2*u;d=c=0;m=[];n=r.twiddles[l*u];for(p=0;p<u;p++)m[1]=a[b+p+u].mul(r.twiddles[c]),
m[2]=a[b+p+q].mul(r.twiddles[d]),m[3]=m[1].add(m[2]),m[0]=m[1].sub(m[2]),c+=l,d+=2*l,a[b+p+u].re=a[b+p].re-m[3].re/2,a[b+p+u].im=a[b+p].im-m[3].im/2,m[0]=m[0].mulr(n.im),a[b+p]=a[b+p].add(m[3]),a[b+p+q].re=a[b+p+u].re+m[0].im,a[b+p+q].im=a[b+p+u].im-m[0].re,a[b+p+u].re-=m[0].im,a[b+p+u].im+=m[0].re;break;case 4:q=[];c=2*u;d=3*u;for(t=p=n=m=0;t<u;t++)q[0]=a[b+t+u].mul(r.twiddles[m]),q[1]=a[b+t+c].mul(r.twiddles[n]),q[2]=a[b+t+d].mul(r.twiddles[p]),q[5]=a[b+t].sub(q[1]),a[b+t]=a[b+t].add(q[1]),q[3]=
q[0].add(q[2]),q[4]=q[0].sub(q[2]),a[b+t+c]=a[b+t].sub(q[3]),m+=l,n+=2*l,p+=3*l,a[b+t]=a[b+t].add(q[3]),r.inverse?(a[b+t+u].re=q[5].re-q[4].im,a[b+t+u].im=q[5].im+q[4].re,a[b+t+d].re=q[5].re+q[4].im,a[b+t+d].im=q[5].im-q[4].re):(a[b+t+u].re=q[5].re+q[4].im,a[b+t+u].im=q[5].im-q[4].re,a[b+t+d].re=q[5].re-q[4].im,a[b+t+d].im=q[5].im+q[4].re);break;case 5:q=[];c=r.twiddles[l*u];d=r.twiddles[2*l*u];m=2*u;n=3*u;p=4*u;for(t=0;t<u;++t)q[0]=Jmat.Complex(a[b+t]),q[1]=a[b+u+t].mul(r.twiddles[t*l]),q[2]=a[b+
m+t].mul(r.twiddles[2*t*l]),q[3]=a[b+n+t].mul(r.twiddles[3*t*l]),q[4]=a[b+p+t].mul(r.twiddles[4*t*l]),q[7]=q[1].add(q[4]),q[10]=q[1].sub(q[4]),q[8]=q[2].add(q[3]),q[9]=q[2].sub(q[3]),a[b+t].re+=q[7].re+q[8].re,a[b+t].im+=q[7].im+q[8].im,q[5]=Jmat.Complex(0),q[5].re=q[0].re+q[7].re*c.re+q[8].re*d.re,q[5].im=q[0].im+q[7].im*c.re+q[8].im*d.re,q[6]=Jmat.Complex(0),q[6].re=q[10].im*c.im+q[9].im*d.im,q[6].im=-q[10].re*c.im-q[9].re*d.im,a[b+u+t]=q[5].sub(q[6]),a[b+p+t]=q[5].add(q[6]),q[11]=Jmat.Complex(0),
q[11].re=q[0].re+q[7].re*d.re+q[8].re*c.re,q[11].im=q[0].im+q[7].im*d.re+q[8].im*c.re,q[12]=Jmat.Complex(0),q[12].re=-q[10].im*d.im+q[9].im*c.im,q[12].im=q[10].re*d.im-q[9].re*c.im,a[b+m+t]=q[11].add(q[12]),a[b+n+t]=q[11].sub(q[12]);break;default:for(t=r.nfft,v=[],c=0;c<u;++c){d=c;for(m=0;m<q;++m)v[m]=Jmat.Complex(a[b+d]),d+=u;d=c;for(m=0;m<q;++m){var w=0;a[b+d]=v[0];for(n=1;n<q;++n)w+=l*d,w>=t&&(w-=t),p=v[n].mul(r.twiddles[w]),a[b+d]=a[b+d].add(p);d+=u}}}};c=function(a,b){for(var c=new d(a,b),e=
0;e<a;++e){var l=2*-Math.PI*e/a;c.inverse&&(l*=-1);c.twiddles[e]=new Jmat.Complex(Math.cos(l),Math.sin(l))}var e=a,l=c.factors,m=0,n=4,p=Math.floor(Math.sqrt(e));do{for(;0!=e%n;){switch(n){case 4:n=2;break;case 2:n=3;break;default:n+=2}n>p&&(n=e)}e=Math.floor(e/n);l[m+0]=n;l[m+1]=e;m+=2}while(1<e);return c}(a.length,c);e(b,0,a,0,1,1,c.factors,0,c)};
Jmat.Complex.fft=function(a,b){for(var c=[],d=0;d<a.length;d++)c[d]=Jmat.Complex(0);Jmat.Complex.kiss_fft_(a,c,b);for(var e=1/Math.sqrt(a.length),d=0;d<a.length;d++)c[d]=c[d].mulr(e);return c};/*

License of Jmat.Matrix.zsvdc_: this function is from linpack, from http://www.netlib.org/linpack/
The license is not mentioned directly in the source code or the website, but
has been said to now be a variant of the BSD license: see
https://bugzilla.redhat.com/show_bug.cgi?id=1000829.
Here is the original author comment from zsvdc.f:
    linpack. this version dated 03/19/79 .
             correction to shift calculation made 2/85.
    g.w. stewart, university of maryland, argonne national lab.
*/
Jmat.Matrix=function(a,b,c){if(this instanceof Jmat.Matrix){this.h=a;this.w=b;this.e=[];for(var d=0;d<a;d++)this.e[d]=[]}else return Jmat.Matrix.make.apply(this,arguments)};
Jmat.Matrix.make=function(a,b,c){if(!a)return new Jmat.Matrix(0,0);if(a instanceof Jmat.Matrix)return Jmat.Matrix.copy(a);if("string"==typeof a)return Jmat.Matrix.parse(a);var d=function(a,b,c){return a&&void 0!=a[b]?Jmat.Real.cast(void 0==a[b][c]?a[b]:a[b][c]):0},e=function(a){return a&&void 0!=a[0]?void 0==a[0].length?1:a[0].length:0},f=function(a,b,c,e,f){var g;if(0<=e&&c.length<a*b){g=Jmat.Matrix.zero(a,b);if(0<=e&&1==c.length-e){for(var r=0;r<b&&r<a;r++)g.e[r][r]=Jmat.Complex.cast(c[e]);return g}if(0<=
e&&c.length-e==Math.min(a,b)){for(r=0;r<b&&r<a;r++)g.e[r][r]=Jmat.Complex.cast(c[r+e]);return g}return null}g=new Jmat.Matrix(a,b);for(a=0;a<g.h;a++)for(r=0;r<g.w;r++)if(0>e){var q=g.e[a],u=r,t;if(f){t=f;var v=a,w=r;t=new Jmat.Complex(d(c,v,w),d(t,v,w))}else t=c&&void 0!=c[a]?Jmat.Complex.cast(void 0==c[a][r]?c[a]:c[a][r]):Jmat.Complex();q[u]=t}else g.e[a][r]=Jmat.Complex.cast(c[a*b+r+e]);return g};if("undefined"!==typeof a&&a.length||"undefined"!==typeof b&&b.length){var g=Math.max(a&&a.length||
0,b&&b.length||0),e=Math.max(e(a),e(b));return f(g,e,a,-1,b)}if(void 0!=a&&void 0==b)return f=new Jmat.Matrix(1,1),f.e[0][0]=Jmat.Complex.cast(a),f;if(void 0!=a&&void 0!=b){if(void 0==c)return new Jmat.Matrix(a,b);g=a;e=b;return c&&c.length?f(g,e,c,0):f(g,e,arguments,2)}return new Jmat.Matrix(0,0)};
Jmat.Matrix.toString=function(a,b){if(!a)return""+a;for(var c="[",d=0;d<a.h;d++){for(var c=c+"[",e=0;e<a.w;e++)c+=Jmat.Complex.toString(a.e[d][e],b),e+1<a.w&&(c+=", ");c+="]";d+1<a.h&&(c+=", ")}return c+"]"};Jmat.Matrix.prototype.toString=function(a){return Jmat.Matrix.toString(this,a)};Jmat.Matrix.toCurly=function(a,b){return Jmat.Matrix.toString(a,b).replace(/\[/g,"{").replace(/\]/g,"}")};Jmat.Matrix.prototype.toCurly=function(a){return Jmat.Matrix.toCurly(this,a)};
Jmat.Matrix.toSemi=function(a,b){if(!a)return""+a;for(var c="[",d=0;d<a.h;d++){for(var e=0;e<a.w;e++)c+=Jmat.Complex.toString(a.e[d][e],b),e+1<a.w&&(c+=" ");d+1<a.h&&(c+="; ")}return c+"]"};Jmat.Matrix.prototype.toSemi=function(a){return Jmat.Matrix.toSemi(this,a)};
Jmat.Matrix.parse=function(a){for(var b=[],c=[b],d="",e=1;e<a.length-1&&0<c.length;e++){var f=a.charAt(e);"["==f?(f=[],c[c.length-1].push(f),c.push(f)):"]"==f?(""!=d&&(c[c.length-1].push(Jmat.Complex.parse(d)),d=""),c.pop()):","==f?""!=d&&(c[c.length-1].push(Jmat.Complex.parse(d)),d=""):d+=f}""!=d&&c[c.length-1].push(Jmat.Complex.parse(d));return Jmat.Matrix.make(b)};
Jmat.Matrix.render=function(a,b){if(!a)return""+a;if(!Jmat.Matrix.isValid(a)){a=Jmat.Matrix.copy(a);for(var c=0;c<a.h;c++)for(var d=0;d<a.w;d++)a.e[c][d]||(a.e[c][d]=Jmat.Complex(NaN))}b=void 0==b?Jmat.Matrix.isInteger(a)?0:3:b;for(var e="",f=Jmat.Matrix.isReal(a),g=[],h=[],c=0;c<a.h;c++)for(g.push([]),d=0;d<a.w;d++){0==c&&h.push([0,0]);var k=[a.e[c][d].re.toFixed(b),Math.abs(a.e[c][d].im).toFixed(b)];h[d]=[Math.max(k[0].length,h[d][0]),Math.max(k[1].length,h[d][1])];g[c].push(k)}for(c=0;c<a.h;c++){for(var l=
"",l=l+("|"+(c+1==a.h?"_":" ")),d=0;d<a.w;d++){for(k=g[c][d][0];k.length<h[d][0];)k=" "+k;if(!f){for(var m=0>a.e[c][d].im,n=g[c][d][1];n.length<h[d][1];)n="0"+n;n=(m?"-":"+")+n;k+=n+"i"}l+=k+(c+1==a.h&&d+1==a.w?"_":" ")}l+="|";if(0==c){for(d=" _";d.length+2<l.length;)d+=" ";d+="_";e+=d+"\n"}e+=l+"\n"}return e};Jmat.Matrix.prototype.render=function(a){return Jmat.Matrix.render(this,a)};Jmat.Matrix.cast=function(a){return a instanceof Jmat.Matrix?a:Jmat.Matrix.make(a)};
Jmat.Matrix.copy=function(a){for(var b=new Jmat.Matrix(a.h,a.w),c=0;c<a.h;c++)for(var d=0;d<a.w;d++)b.e[c][d]=a.e[c][d]?Jmat.Complex(a.e[c][d].re,a.e[c][d].im):a.e[c][d];return b};Jmat.Matrix.identity=function(a,b){for(var c=b||a,d=new Jmat.Matrix(a,c),e=0;e<a;e++)for(var f=0;f<c;f++)d.e[e][f]=Jmat.Complex(f==e?1:0);return d};Jmat.Matrix.zero=function(a,b){for(var c=b||a,d=new Jmat.Matrix(a,c),e=0;e<a;e++)for(var f=0;f<c;f++)d.e[e][f]=Jmat.Complex(0);return d};
Jmat.Matrix.add=function(a,b){if(a.w!=b.w||a.h!=b.h)return null;for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].add(b.e[d][e]);return c};Jmat.Matrix.prototype.add=function(a){return Jmat.Matrix.add(this,a)};Jmat.Matrix.sub=function(a,b){if(a.w!=b.w||a.h!=b.h)return null;for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].sub(b.e[d][e]);return c};Jmat.Matrix.prototype.sub=function(a){return Jmat.Matrix.sub(this,a)};
Jmat.Matrix.n3mul_=function(a,b){if(a.w!=b.h)return null;for(var c=new Jmat.Matrix(a.h,b.w),d=0;d<a.h;d++)for(var e=0;e<b.w;e++){for(var f=Jmat.Complex(0),g=0;g<a.w;g++)f=f.add(a.e[d][g].mul(b.e[g][e]));c.e[d][e]=f}return c};Jmat.Matrix.n3mul_nocache_=function(a,b){if(a.w!=b.h)return null;for(var c=new Jmat.Matrix(a.h,b.w),d=0;d<a.h;d++)for(var e=0;e<b.w;e++){for(var f=Jmat.Complex(0),g=0;g<a.w;g++)f=f.add(a.e[d][g].mul(b.e[g][e]));c.e[d][e]=f}return c};
Jmat.Matrix.n3mul_=function(a,b){if(a.w!=b.h)return null;for(var c=new Jmat.Matrix(a.h,b.w),d=[],e=0;e<b.w;e++){for(var f=0;f<a.w;f++)d[f]=b.e[f][e];for(var g=0;g<a.h;g++){for(var h=Jmat.Complex(0),f=0;f<a.w;f++)h=h.add(a.e[g][f].mul(d[f]));c.e[g][e]=h}}return c};
Jmat.Matrix.strassen_=function(a,b){var c=Jmat.Matrix;if(a.w!=b.h)return null;if(2>a.w||2>a.h||2>b.w)return c.n3mul_(a,b);var d=Math.min(a.h,Math.min(a.w,b.w));d&1&&d--;var e=Math.floor(d/2),f=c.submatrix(a,0,e,0,e),g=c.submatrix(a,0,e,e,2*e),h=c.submatrix(a,e,2*e,0,e),k=c.submatrix(a,e,2*e,e,2*e),l=c.submatrix(b,0,e,0,e),m=c.submatrix(b,0,e,e,2*e),n=c.submatrix(b,e,2*e,0,e),p=c.submatrix(b,e,2*e,e,2*e),e=f.add(k).mul(l.add(p)),r=h.add(k).mul(l),q=f.mul(m.sub(p)),u=k.mul(n.sub(l)),t=f.add(g).mul(p),
f=h.sub(f).mul(l.add(m)),g=g.sub(k).mul(n.add(p)),g=e.add(u).sub(t).add(g),t=q.add(t),u=r.add(u),r=e.sub(r).add(q).add(f),e=c(a.h,b.w);c.insertInPlace(e,g,0,0);c.insertInPlace(e,t,0,g.w);c.insertInPlace(e,u,g.h,0);c.insertInPlace(e,r,g.h,g.w);if(d!=a.w||d!=a.h||d!=b.w)for(c=[],r=0;r<b.w;r++){for(t=0;t<a.w;t++)c[t]=b.e[t][r];for(q=0;q<a.h;q++){u=Jmat.Complex(0);t=0;for(r<d&&q<d?t=d:e.e[q][r]=Jmat.Complex(0);t<a.w;t++)u=u.add(a.e[q][t].mul(c[t]));e.e[q][r]=e.e[q][r].add(u)}}return e};
Jmat.Matrix.mul=function(a,b){return 350>Math.min(a.w,Math.min(a.h,b.w))?Jmat.Matrix.n3mul_(a,b):Jmat.Matrix.strassen_(a,b)};Jmat.Matrix.prototype.mul=function(a){return Jmat.Matrix.mul(this,a)};Jmat.Matrix.mulc=function(a,b){for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].mul(b);return c};Jmat.Matrix.prototype.mulc=function(a){return Jmat.Matrix.mulc(this,a)};
Jmat.Matrix.mulr=function(a,b){for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].mulr(b);return c};Jmat.Matrix.prototype.mulr=function(a){return Jmat.Matrix.mulr(this,a)};Jmat.Matrix.elmul=function(a,b){if(a.w!=b.w||a.h!=b.h)return null;for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].mul(b.e[d][e]);return c};
Jmat.Matrix.div=function(a,b){if(a.w!=b.h)return null;var c=new Jmat.Matrix(a.h,b.w);b=Jmat.Matrix.inv(b);for(var d=0;d<a.h;d++)for(var e=0;e<b.w;e++){for(var f=Jmat.Complex(0),g=0;g<a.w;g++)f=f.add(a.e[d][g].mul(b.e[g][e]));c.e[d][e]=f}return c};Jmat.Matrix.prototype.div=function(a){return Jmat.Matrix.div(this,a)};Jmat.Matrix.eldiv=function(a,b){if(a.w!=b.w||a.h!=b.h)return null;for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].div(b.e[d][e]);return c};
Jmat.Matrix.leftdiv=function(a,b){if(a.w!=b.h)return null;var c=new Jmat.Matrix(a.h,b.w);b=Jmat.Matrix.inv(b);for(var d=0;d<b.h;d++)for(var e=0;e<a.w;e++){for(var f=Jmat.Complex(0),g=0;g<b.w;g++)f=f.add(b.e[d][g].mul(a.e[g][e]));c.e[d][e]=f}return c};Jmat.Matrix.prototype.leftdiv=function(a){return Jmat.Matrix.leftdiv(this,a)};Jmat.Matrix.divc=function(a,b){for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].div(b);return c};
Jmat.Matrix.prototype.divc=function(a){return Jmat.Matrix.divc(this,a)};Jmat.Matrix.divr=function(a,b){for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].divr(b);return c};Jmat.Matrix.prototype.divr=function(a){return Jmat.Matrix.divr(this,a)};Jmat.Matrix.isReal=function(a){for(var b=0;b<a.h;b++)for(var c=0;c<a.w;c++)if(0!=a.e[b][c].im)return!1;return!0};
Jmat.Matrix.isValid=function(a){if(!(a&&a.w&&a.h&&a.e&&a.e.length))return!1;for(var b=0;b<a.h;b++)for(var c=0;c<a.w;c++){var d=a.e[b][c];if(d){if(Infinity==d.re||-Infinity==d.re||d.re!=d.re||Infinity==d.im||-Infinity==d.im||d.im!=d.im)return!1}else return!1}return!0};Jmat.Matrix.isNaN=function(a){for(var b=0;b<a.h;b++)for(var c=0;c<a.w;c++)if(Jmat.Complex.isNaN(a.e[b][c]))return!0;return!1};
Jmat.Matrix.isInfOrNaN=function(a){for(var b=0;b<a.h;b++)for(var c=0;c<a.w;c++)if(Jmat.Complex.isInfOrNaN(a.e[b][c]))return!0;return!1};Jmat.Matrix.isSquare=function(a){return a.w==a.h};Jmat.Matrix.isSingular=function(a,b){var c=void 0==b?1E-15:b,d=Jmat.Matrix.conditionNumber(a);return Jmat.Matrix.isSquare(a)&&d.abs()>=1/c};Jmat.Matrix.isInvertible=function(a,b){var c=void 0==b?1E-15:b;return Jmat.Matrix.isSquare(a)&&!Jmat.Matrix.isSingular(a,c)};
Jmat.Matrix.isIdentity=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=0;d<a.h;d++)for(var e=0;e<a.w;e++)if(!Jmat.Complex.nearr(a.e[d][e],e==d?1:0,c))return!1;return!0};Jmat.Matrix.isDiagonal=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=0;d<a.h;d++)for(var e=0;e<a.w;e++)if(e!=d&&!Jmat.Complex.nearr(a.e[d][e],0,c))return!1;return!0};
Jmat.Matrix.isZero=function(a,b){for(var c=void 0==b?1E-15:b,d=0;d<a.h;d++)for(var e=0;e<a.w;e++)if(!Jmat.Complex.nearr(a.e[d][e],0,c))return!1;return!0};Jmat.Matrix.isSymmetric=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=0;d<a.h;d++)for(var e=d+1;e<a.w;e++)if(!Jmat.Complex.near(a.e[d][e],a.e[e][d],c))return!1;return!0};
Jmat.Matrix.isHermitian=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=0;d<a.h;d++)for(var e=d;e<a.w;e++)if(!Jmat.Complex.near(a.e[d][e],Jmat.Complex.conj(a.e[e][d]),c))return!1;return!0};Jmat.Matrix.isSkewSymmetric=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=0;d<a.h;d++)for(var e=d;e<a.w;e++)if(!Jmat.Complex.near(a.e[d][e],Jmat.Complex.neg(a.e[e][d]),c))return!1;return!0};
Jmat.Matrix.isSkewHermitian=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=0;d<a.h;d++)for(var e=d;e<a.w;e++)if(!Jmat.Complex.near(a.e[d][e],Jmat.Complex.conj(a.e[e][d]).neg(),c))return!1;return!0};Jmat.Matrix.isUpperTriangular=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=0;d<a.h;d++)for(var e=0;e<d;e++)if(!Jmat.Complex.nearr(a.e[d][e],0,c))return!1;return!0};
Jmat.Matrix.isLowerTriangular=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=0;d<a.h;d++)for(var e=d+1;e<a.w;e++)if(!Jmat.Complex.nearr(a.e[d][e],0,c))return!1;return!0};Jmat.Matrix.isStrictlyUpperTriangular=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=0;d<a.h;d++)for(var e=0;e<=d;e++)if(!Jmat.Complex.nearr(a.e[d][e],0,c))return!1;return!0};
Jmat.Matrix.isStrictlyLowerTriangular=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=0;d<a.h;d++)for(var e=d;e<a.w;e++)if(!Jmat.Complex.nearr(a.e[d][e],0,c))return!1;return!0};Jmat.Matrix.isUpperHessenberg=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=0;d<a.h;d++)for(var e=0;e+1<d;e++)if(!Jmat.Complex.nearr(a.e[d][e],0,c))return!1;return!0};
Jmat.Matrix.isLowerHessenberg=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=0;d<a.h;d++)for(var e=d+2;e<a.w;e++)if(!Jmat.Complex.nearr(a.e[d][e],0,c))return!1;return!0};Jmat.Matrix.isTridiagonal=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=0;d<a.h;d++)for(var e=0;e<a.w;e++)if(e!=d&&e+1!=d&&e!=d+1&&!Jmat.Complex.nearr(a.e[d][e],0,c))return!1;return!0};
Jmat.Matrix.isOrthogonal=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;var d=a.mul(a.transpose());return Jmat.Matrix.isIdentity(d,c)};Jmat.Matrix.isUnitary=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;var d=a.mul(a.transjugate());return Jmat.Matrix.isIdentity(d,c)};Jmat.Matrix.isNormal=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;var d=a.transjugate();return Jmat.Matrix.near(a.mul(d),d.mul(a),c)};
Jmat.Matrix.isPermutation=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=0;d<a.h;d++){for(var e=0,f=0,g=0,h=0;h<a.w;h++)Jmat.Complex.nearr(a.e[d][h],0,c)?Jmat.Complex.nearr(a.e[d][h],1,c)?g++:f++:e++;if(1!=f||0<g)return!1}for(h=0;h<a.w;h++){for(d=g=f=e=0;d<a.h;d++)Jmat.Complex.nearr(a.e[d][h],0,c)?Jmat.Complex.nearr(a.e[d][h],1,c)?g++:f++:e++;if(1!=f||0<g)return!1}return!0};
Jmat.Matrix.isToeplitz=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=0;d+1<a.h;d++)for(var e=0;e+1<a.w;e++)if(!Jmat.Complex.near(a.e[d][e],a.e[d+1][e+1],c))return!1;return!0};Jmat.Matrix.isHankel=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=1;d<a.h;d++)for(var e=0;e+1<a.w;e++)if(!Jmat.Complex.near(a.e[d][e],a.e[d-1][e+1],c))return!1;return!0};
Jmat.Matrix.isFrobenius=function(a,b){var c=void 0==b?1E-15:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var d=-1,e=0;e<a.h;e++)for(var f=0;f<a.w;f++){if(f==e&&!Jmat.Complex.nearr(a.e[e][f],1,c)||f>e&&!Jmat.Complex.nearr(a.e[e][f],0,c))return!1;if(f<e&&!Jmat.Complex.nearr(a.e[e][f],0,c)){if(0<=d&&f!=d)return!1;d=f}}return!0};
Jmat.Matrix.isInteger=function(a,b){for(var c=void 0==b?1E-15:b,d=0;d<a.h;d++)for(var e=0;e<a.w;e++){var f=a.e[d][e];if(!Jmat.Real.near(f.im,0,c)||Math.abs(Math.round(f.re)-f.re)>c)return!1}return!0};Jmat.Matrix.isBinary=function(a,b){for(var c=void 0==b?1E-15:b,d=0;d<a.h;d++)for(var e=0;e<a.w;e++){var f=a.e[d][e];if(!Jmat.Real.near(f,0,c)&&!Jmat.Real.near(f,1,c))return!1}return!0};Jmat.Matrix.isInvolutory=function(a,b){return Jmat.Matrix.isSquare(a)?Jmat.Matrix.isIdentity(a.mul(a),b):!1};
Jmat.Matrix.isIdempotent=function(a,b){return Jmat.Matrix.isSquare(a)?Jmat.Matrix.near(a,a.mul(a),b):!1};Jmat.Matrix.isNilpotent=function(a,b){var c=Jmat.Matrix,d=void 0==b?1E-15:b;if(!c.isSquare(a))return!1;for(var e=a.w,f=1;c.trace(a).eqr(0,d);){if(c.isZero(a,d))return!0;if(f>=e)break;a=a.mul(a);f*=2}return!1};
Jmat.Matrix.getProperties=function(a){var b=Jmat.Matrix,c={};c.dimensions=""+a.h+"x"+a.w;c.height=a.h;c.width=a.w;c.square=b.isSquare(a);c.zero=b.isZero(a);c.real=b.isReal(a);c.rank=b.rank(a);c.frobeniusNorm=b.norm(a);c.spectralNorm=b.norm2(a);c.conditionNumber=b.conditionNumber(a);c.NaN=b.isNaN(a);c.identity=b.isIdentity(a);c.diagonal=b.isDiagonal(a);c.tridiagonal=b.isTridiagonal(a);c.symmetric=b.isSymmetric(a);c.hermitian=b.isHermitian(a);c.skewHermitian=b.isSkewHermitian(a);c.skewSymmetric=b.isSkewSymmetric(a);
c.upperTriangular=b.isUpperTriangular(a);c.lowerTriangular=b.isLowerTriangular(a);c.strictlyUpperTriangular=b.isStrictlyUpperTriangular(a);c.strictlyLowerTriangular=b.isStrictlyLowerTriangular(a);c.upperHessenberg=b.isUpperHessenberg(a);c.lowerHessenberg=b.isLowerHessenberg(a);c.singular=b.isSingular(a);c.invertible=b.isInvertible(a);c.determinant=b.determinant(a);c.trace=b.trace(a);c.orthogonal=b.isOrthogonal(a);c.unitary=b.isUnitary(a);c.normal=b.isNormal(a);c.permutation=b.isPermutation(a);c.toeplitz=
b.isToeplitz(a);c.hankel=b.isHankel(a);c.frobenius=b.isFrobenius(a);c.integer=b.isInteger(a);c.binary=b.isBinary(a);c.involutory=b.isInvolutory(a);c.idempotent=b.isIdempotent(a);if(c.hermitian)if(a=b.definiteness(a),a==b.INDEFINITE)c.indefinite=!0;else if(a==b.POSITIVE_DEFINITE)c.positiveDefinite=c.positiveSemidefinite=!0;else if(a==b.NEGATIVE_DEFINITE)c.negativeDefinite=c.negativeSemidefinite=!0;else if(a==b.POSITIVE_SEMI_DEFINITE||c.zero)c.positiveSemidefinite=!0;else if(a==b.NEGATIVE_SEMI_DEFINITE||
c.zero)c.negativeSemidefinite=!0;return c};
Jmat.Matrix.summary=function(a){var b=Jmat.Matrix.getProperties(a),c=function(a){"NaN"!=a&&(a=a.replace(/([A-Z])/g," $1").toLowerCase());a=a.replace("hessenberg","Hessenberg");a=a.replace("frobenius","Frobenius");a=a.replace("toeplitz","Toeplitz");a=a.replace("hankel","Hankel");return a=a.replace("frobenius","Frobenius")},d="height width zero real NaN rank frobeniusNorm spectralNorm conditionNumber integer binary".split(" "),e="identity symmetric hermitian skewSymmetric skewHermitian diagonal tridiagonal upperTriangular lowerTriangular strictlyUpperTriangular strictlyLowerTriangular upperHessenberg lowerHessenberg singular invertible determinant trace orthogonal unitary normal permutation toeplitz hankel indefinite positiveDefinite negativeDefinite positiveSemidefinite negativeSemidefinite frobenius involutory idempotent".split(" "),f=
{square:"non-square",real:"complex"};b.small2x2=2>=a.w&&2>=a.h;b.small1x1=1>=a.w&&1>=a.h;b.realsym=b.real&&b.symmetric;b.realskewsym=b.real&&b.skewSymmetric;a={strictlyUpperTriangular:["zero"],strictlyLowerTriangular:["zero"],upperTriangular:["diagonal","strictlyUpperTriangular"],lowerTriangular:["diagonal","frobenius","strictlyLowerTriangular"],upperHessenberg:["upperTriangular","tridiagonal"],lowerHessenberg:["lowerTriangular","tridiagonal"],diagonal:["small1x1","identity","zero"],tridiagonal:["small2x2",
"diagonal"],orthogonal:["normal","identity"],unitary:["normal"],normal:["identity","zero"],hermitian:["normal","realsym"],skewHermitian:["realskewsym"],symmetric:["diagonal"],skewSymmetric:["zero"],permutation:["identity"],invertible:["identity"],singular:["zero"],real:["integer"],toeplitz:["identity","zero"],hankel:["zero"],frobenius:["identity"],positiveDefinite:["identity"],negativeSemidefinite:["zero","negativeDefinite"],positiveSemidefinite:["zero","positiveDefinite"],integer:["binary"],binary:["identity",
"zero"],involutory:["identity"],idempotent:["identity"]};for(var g=b.dimensions+", "+(b.square?"square":f.square),h=0;h<d.length+e.length;h++){var k=h<d.length?d[h]:e[h-d.length];if(!0===b[k]){if(a[k]){for(var l=!1,m=0;m<a[k].length;m++)!0===b[a[k][m]]&&(l=!0);if(l)continue}g+=", "+c(k)}!1===b[k]&&f[k]&&(g+=", "+c(f[k]))}return g=""+g+" matrix with rank "+b.rank+(b.square?", determinant "+b.determinant:"")+" and condition number "+b.conditionNumber+".\n"};Jmat.Matrix.prototype.summary=function(){return Jmat.Matrix.summary(this)};
Jmat.Matrix.render_summary=function(a){return a.render()+"\n"+a.summary()};Jmat.Matrix.prototype.render_summary=function(){return Jmat.Matrix.render_summary(this)};Jmat.Matrix.transpose=function(a){for(var b=new Jmat.Matrix(a.w,a.h),c=0;c<a.h;c++)for(var d=0;d<a.w;d++)b.e[d][c]=a.e[c][d];return b};Jmat.Matrix.prototype.transpose=function(){return Jmat.Matrix.transpose(this)};
Jmat.Matrix.neg=function(a){for(var b=new Jmat.Matrix(a.h,a.w),c=0;c<a.h;c++)for(var d=0;d<a.w;d++)b.e[c][d]=a.e[c][d].neg();return b};Jmat.Matrix.prototype.neg=function(){return Jmat.Matrix.neg(this)};Jmat.Matrix.conj=function(a){for(var b=new Jmat.Matrix(a.h,a.w),c=0;c<a.h;c++)for(var d=0;d<a.w;d++)b.e[c][d]=Jmat.Complex.conj(a.e[c][d]);return b};Jmat.Matrix.prototype.conj=function(){return Jmat.Matrix.conj(this)};Jmat.Matrix.transjugate=function(a){return Jmat.Matrix.conj(Jmat.Matrix.transpose(a))};
Jmat.Matrix.prototype.transjugate=function(){return Jmat.Matrix.transjugate(this)};
Jmat.Matrix.doolittle_lup_=function(a){if(a.h!=a.w)return null;var b=Jmat.Complex;a=Jmat.Matrix.copy(a);for(var c=[],d=0,e=0;e<a.h;e++){for(var f=e,g=a.e[f][e].abs(),h=e+1;h<a.h;h++)a.e[h][e].abs()>g&&(g=a.e[h][e].abs(),f=h);c[e]=f;if(f!=e){for(h=0;h<a.h;h++)g=a.e[f][h],a.e[f][h]=a.e[e][h],a.e[e][h]=g;d^=1}for(h=e+1;h<a.h;h++)a.e[h][e]=a.e[h][e].div(a.e[e][e]),b.isNaN(a.e[h][e])&&(a.e[h][e]=b(0));for(h=e+1;h<a.h;h++)for(f=e+1;f<a.w;f++)a.e[h][f]=a.e[h][f].sub(a.e[h][e].mul(a.e[e][f]))}return[a,c,
d]};Jmat.Matrix.lu=function(a){var b=Jmat.Matrix,c=Jmat.Complex,d=b.doolittle_lup_(a);if(!d)return d;a=d[0];for(var d=d[1],e=b.identity(a.w),f=b.zero(a.w),g=0;g<a.h;g++)for(var h=0;h<a.w;h++)h>=g?f.e[g][h]=a.e[g][h]:e.e[g][h]=a.e[g][h];b=b.zero(a.w);g=[];for(h=0;h<a.h;h++)g[h]=h;for(h=0;h<a.h;h++){var k=g[h];g[h]=g[d[h]];g[d[h]]=k}for(h=0;h<a.h;h++)b.e[g[h]][h]=c(1);return{p:b,l:e,u:f}};
Jmat.Matrix.subrow=function(a,b){if(2>a.h)return null;for(var c=new Jmat.Matrix(a.h-1,a.w),d=0;d<a.h-1;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d<b?d:d+1][e];return c};Jmat.Matrix.subcol=function(a,b){if(2>a.w)return null;for(var c=new Jmat.Matrix(a.h,a.w-1),d=0;d<a.h;d++)for(var e=0;e<a.w-1;e++)c.e[d][e]=a.e[d][e<b?e:e+1];return c};
Jmat.Matrix.minorsub=function(a,b,c){if(2>a.h||2>a.w)return null;for(var d=new Jmat.Matrix(a.h-1,a.w-1),e=0;e<a.h-1;e++)for(var f=0;f<a.w-1;f++)d.e[e][f]=a.e[e<b?e:e+1][f<c?f:f+1];return d};Jmat.Matrix.submatrix=function(a,b,c,d,e){if(0>d||0>b||d>a.w||b>a.h||0>e||0>c||e>a.w||c>a.h)return null;e-=d;c-=b;if(0>=e||0>=c||e>a.w||c>a.h)return null;for(var f=new Jmat.Matrix(c,e),g=0;g<c;g++)for(var h=0;h<e;h++)f.e[g][h]=a.e[b+g][d+h];return f};
Jmat.Matrix.minor=function(a,b,c){if(2>a.h||2>a.w||a.w!=a.h)return Jmat.Complex(NaN);a=Jmat.Matrix.minorsub(a,b,c);return Jmat.Matrix.determinant(a)};Jmat.Matrix.cofactor=function(a,b,c){return Jmat.Matrix.minor(a,b,c).mulr(0==(b+c&1)?1:-1)};
Jmat.Matrix.determinant=function(a){if(a.w!=a.h)return NaN;if(1==a.w)return a.e[0][0];if(2==a.w)return a.e[0][0].mul(a.e[1][1]).sub(a.e[0][1].mul(a.e[1][0]));for(var b=Jmat.Matrix.doolittle_lup_(a),c=Jmat.Complex(1),d=0;d<a.w;d++)c=c.mul(b[0].e[d][d]);b[2]&1&&(c=c.neg());return c};Jmat.Matrix.adj=function(a){if(a.w!=a.h)return NaN;if(1==a.w)return Jmat.Matrix.identity(1,1);for(var b=new Jmat.Matrix(a.h,a.w),c=0;c<a.h;c++)for(var d=0;d<a.w;d++)b.e[c][d]=Jmat.Matrix.cofactor(a,d,c);return b};
Jmat.Matrix.inv=function(a){return a.w!=a.h?null:Jmat.Matrix.mulc(Jmat.Matrix.adj(a),Jmat.Complex.inv(Jmat.Matrix.determinant(a)))};Jmat.Matrix.pseudoinverse_=function(a){a=Jmat.Matrix.svd(a);for(var b=Math.min(a.s.w,a.s.h),c=0;c<b;c++)a.s.e[c][c]=1E-15>Math.abs(a.s.e[c][c].re)?a.s.e[c][c]:Jmat.Complex.inv(a.s.e[c][c]);a.s=Jmat.Matrix.transpose(a.s);return Jmat.Matrix.mul(Jmat.Matrix.mul(a.v,a.s),Jmat.Matrix.transjugate(a.u))};
Jmat.Matrix.pseudoinverse=function(a){var b=Jmat.Matrix.inv(a);return Jmat.Matrix.isValid(b)?b:Jmat.Matrix.pseudoinverse_(a)};Jmat.Matrix.getFirstNonZeroDigit_=function(a){if(0==a)return 0;0>a&&(a=-a);for(var b=0;100>b;b++)if(1>a)a*=10;else if(10<=a)a/=10;else return Math.floor(a);return 0};Jmat.Matrix.getDebugNumber=function(a){for(var b=a.w+10*a.h,c=.1,d=0;d<a.h;d++)for(var e=0;e<a.w;e++)var f=Jmat.Matrix.getFirstNonZeroDigit_(a.e[d][e].re),b=b+f*c,c=c/10;c*=10;b=Math.round(b/c)*c;return Jmat.Complex(b)};
Jmat.Matrix.norm=function(a){for(var b=0,c=0;c<a.h;c++)for(var d=0;d<a.w;d++)b+=a.e[c][d].abssq();b=Math.sqrt(b);return Jmat.Complex(b)};Jmat.Matrix.maxcolnorm=function(a){for(var b=0,c=0;c<a.w;c++){for(var d=0,e=0;e<a.h;e++)d+=a.e[e][c].abssq();d>b&&(b=d)}return Jmat.Complex(b)};Jmat.Matrix.maxrownorm=function(a){for(var b=0,c=0;c<a.h;c++){for(var d=0,e=0;e<a.w;e++)d+=a.e[c][e].abssq();d>b&&(b=d)}return Jmat.Complex(b)};Jmat.Matrix.norm2=function(a){return Jmat.Matrix.svd(a).s.e[0][0]};
Jmat.Matrix.vectorNorm=function(a,b){var c=Jmat.Complex;if(c.isReal(b)){for(var d=0,e=0;e<a.h;e++)for(var f=0;f<a.w;f++){var g=a.e[e][f];b.eqr(0)?c.nearr(g,0,1E-15)||d++:d=b.eqr(1)?d+g.abs():b.eqr(2)?d+g.abssq():b.eqr(Infinity)?Math.max(g.abs(),d):d+Math.pow(g.abssq(),b.re/2)}if(Infinity==d&&0<b.re)return Jmat.Matrix.vectorNorm(a,c(Infinity));b.eqr(2)?d=Math.sqrt(d):b.eqr(0)||b.eqr(1)||b.eqr(Infinity)||(d=Math.pow(d,1/b.re));return c(d)}d=c(0);for(e=0;e<a.h;e++)for(f=0;f<a.w;f++)g=c.abssq(a.e[e][f]),
d=d.add(g.pow(b.divr(2)));return d.eqr(0)?d:c.pow(d,b.inv())};Jmat.Matrix.lpqNorm=function(a,b,c){for(var d=Jmat.Matrix,e=d(1,a.w),f=0;f<a.w;f++)e.e[0][f]=d.vectorNorm(d.col(a,f),b);return d.vectorNorm(e,c)};Jmat.Matrix.schattenNorm=function(a,b){if(b.eqr(2))return Jmat.Matrix.norm(a);if(b.eqr(Infinity))return Jmat.Matrix.norm2(a);var c=Jmat.Matrix,d=c.svd(a),d=c.diagToRow(d.s);return c.vectorNorm(d,b)};
Jmat.Matrix.chebNorm=function(a){for(var b=0,c=0;c<a.w;c++)for(var d=0;d<a.h;d++)b=Math.max(a.e[d][c].abs());return Jmat.Complex(b)};Jmat.Matrix.dist=function(a,b){return Jmat.Matrix.norm(a.sub(b)).re};Jmat.Matrix.cheb=function(a,b){for(var c=0,d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c=Math.max(c,Jmat.Complex.cheb(a.e[d][e],b.e[d][e]));return c};Jmat.Matrix.manhattan=function(a,b){for(var c=0,d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c+=Jmat.Complex.manhattan(a.e[d][e],b.e[d][e]);return c};
Jmat.Matrix.conditionNumber=function(a){var b=Jmat.Matrix.svd(a);a=Math.min(a.w,a.h);b=b.s.e[0][0].div(b.s.e[a-1][a-1]);Jmat.Complex.isNaN(b)&&(b=Jmat.Complex(Infinity));return b};Jmat.Matrix.rank=function(a,b){for(var c=void 0==b?1E-14:b,d=Jmat.Matrix.svd(a).s,e=0,f=Math.min(d.w,d.h),g=0;g<f;g++)Jmat.Real.near(d.e[g][g].re,0,c)||e++;return Jmat.Complex(e)};Jmat.Matrix.trace=function(a){for(var b=Jmat.Complex.ZERO,c=0;c<a.w&&c<a.h;c++)b=b.add(a.e[c][c]);return b};
Jmat.Matrix.col=function(a,b){for(var c=new Jmat.Matrix(a.h,1),d=0;d<a.h;d++)c.e[d][0]=a.e[d][b];return c};Jmat.Matrix.row=function(a,b){for(var c=new Jmat.Matrix(1,a.w),d=0;d<a.w;d++)c.e[0][d]=a.e[b][d];return c};Jmat.Matrix.setCol=function(a,b,c){for(var d=0;d<a.h;d++)a.e[d][c]=b.e[d][0]};Jmat.Matrix.setRow=function(a,b,c){for(var d=0;d<a.w;d++)a.e[c][d]=b.e[0][d]};
Jmat.Matrix.overlap=function(a,b,c,d){for(var e=Jmat.Matrix.zero(Math.max(c+b.h,a.h)-Math.min(0,c),Math.max(d+b.w,a.w)-Math.min(0,d)),f=0;f<a.h;f++)for(var g=0;g<a.w;g++){var h=0>d?g-d:g,k=0>c?f-c:f;e.e[k][h]=a.e[f][g]}for(f=0;f<b.h;f++)for(g=0;g<b.w;g++)h=0>d?g:g+d,k=0>c?f:f+c,e.e[k][h]=e.e[k][h].add(b.e[f][g]);return e};Jmat.Matrix.insertInPlace=function(a,b,c,d){for(var e=0;e<b.h;e++)for(var f=0;f<b.w;f++){var g=f+d,h=e+c;0<=g&&g<a.w&&0<=h&&h<a.h&&(a.e[h][g]=b.e[e][f])}};
Jmat.Matrix.insert=function(a,b,c,d){a=Jmat.Matrix.copy(a);Jmat.Matrix.insertInPlace(a,b,c,d);return a};Jmat.Matrix.augment=function(a,b,c,d){c=void 0==c?0:c;d=void 0==d?a.w:d;for(var e=Jmat.Matrix.zero(Math.max(c+b.h,a.h)-Math.min(0,c),Math.max(d+b.w,a.w)-Math.min(0,d)),f=0;f<a.h;f++)for(var g=0;g<a.w;g++){var h=0>d?g-d:g,k=0>c?f-c:f;e.e[k][h]=a.e[f][g]}for(f=0;f<b.h;f++)for(g=0;g<b.w;g++)h=0>d?g:g+d,k=0>c?f:f+c,e.e[k][h]=b.e[f][g];return e};
Jmat.Matrix.getHouseholderVector_=function(a,b){var c=Jmat.Matrix,d=Jmat.Complex,e=a.e[0][0].eqr(0)?d(-1):d.sign(a.e[0][0]),e=c.identity(a.h,1).mulc(e.mul(c.norm(a))).add(a),f=c.isZero(e,1E-30);f||(e=e.divc(c.norm(e)));f?c=d(0):b?c=d(2):(d=c.mul(c.row(c.transjugate(a),0),e),c=c.mul(c.transjugate(e),c.col(a,0)),c=d.e[0][0].div(c.e[0][0]).addr(1));return[e,c]};
Jmat.Matrix.getGivensParams_=function(a,b){if(b.eqr(0))return[Jmat.Complex(1),Jmat.Complex(0),a];var c=Jmat.Complex.hypot(a,b),d=a.div(c),e=b.div(c).neg();return[d,e,c]};Jmat.Matrix.givensPre_=function(a,b,c,d,e){for(var f=0;f<a.w;f++){var g=a.e[b][f],h=a.e[c][f];a.e[b][f]=g.mul(d.conj()).add(h.mul(e.neg().conj()));a.e[c][f]=g.mul(e).add(h.mul(d))}};Jmat.Matrix.givensPost_=function(a,b,c,d,e){for(var f=0;f<a.h;f++){var g=a.e[f][b],h=a.e[f][c];a.e[f][b]=g.mul(d).add(h.mul(e.neg()));a.e[f][c]=g.mul(e.conj()).add(h.mul(d.conj()))}};
Jmat.Matrix.toHessenberg=function(a){var b=Jmat.Matrix,c=b.transjugate;if(a.h!=a.w)return null;for(var d=Jmat.Matrix.isReal(a),e=b.copy(a),f=0;f+2<a.w;f++)var g=b.submatrix(e,f+1,e.h,f,f+1),h=b.getHouseholderVector_(g,d),g=h[0],h=h[1],k=b.submatrix(e,f+1,e.h,f,e.w),k=k.sub(g.mul(c(g)).mul(k).mulc(h)),e=b.insert(e,k,f+1,f),k=b.submatrix(e,0,e.h,f+1,e.w),k=k.sub(k.mul(g).mul(c(g)).mulc(h)),e=b.insert(e,k,0,f+1);for(a=0;a<e.h;a++)for(g=0;g<Math.max(a-1,0);g++)e.e[a][g]=Jmat.Complex(0);return e};
Jmat.Matrix.qr_hessenberg_=function(a){var b=Jmat.Matrix,c=Jmat.Complex,d=Math.min(a.h-1,a.w),e=b.copy(a);a=b.identity(a.h,a.h);for(var f=0;f<d;f++){var g=b.getGivensParams_(e.e[f][f],e.e[f+1][f]);b.givensPre_(e,f,f+1,g[0],g[1]);e.e[f+1][f]=c(0);b.givensPost_(a,f,f+1,g[0],g[1])}return{q:a,r:e}};
Jmat.Matrix.qr_general_=function(a){var b=Jmat.Matrix,c=b.transjugate,d=Jmat.Matrix.isReal(a),e=a.h,f=a.w,g=[],h=[];if(a.h<a.w)return null;a=b.copy(a);for(var k=0;k<f;k++){var l=b.submatrix(a,k,a.h,k,k+1),l=b.getHouseholderVector_(l,d);g[k]=l[0];h[k]=l[1];l=b.submatrix(a,k,e,k,f);l=l.sub(g[k].mul(c(g[k])).mul(l).mulc(h[k]));a=b.insert(a,l,k,k)}d=b.identity(e,e);for(k=f-1;0<=k;k--)f=b.submatrix(d,k,e,0,e),f=f.sub(g[k].mul(c(g[k])).mul(f).mulc(h[k])),d=b.insert(d,f,k,0);return{q:d,r:a}};
Jmat.Matrix.qr=function(a){return Jmat.Matrix.isUpperHessenberg(a,1E-18)?Jmat.Matrix.qr_hessenberg_(a):Jmat.Matrix.qr_general_(a)};Jmat.Matrix.eig11=function(a){if(1!=a.w||1!=a.h)return null;var b={};b.l=new Jmat.Matrix(1,1);b.l.e[0][0]=Jmat.Complex(a.e[0][0]);b.v=new Jmat.Matrix(1,1);b.v.e[0][0]=Jmat.Complex(1);return b};
Jmat.Matrix.eigval22=function(a){if(2!=a.w||2!=a.h)return null;var b=Jmat.Complex(1),c=a.e[0][0].neg().sub(a.e[1][1]);a=a.e[0][0].mul(a.e[1][1]).sub(a.e[0][1].mul(a.e[1][0]));var d=Jmat.Complex.sqrt(c.mul(c).sub(b.mul(a).mulr(4)));a=c.neg().add(d).div(b.mulr(2));b=c.neg().sub(d).div(b.mulr(2));return b.abssq()>a.abssq()?[b,a]:[a,b]};
Jmat.Matrix.eig22=function(a){if(2!=a.w||2!=a.h)return null;var b=Jmat.Matrix.eigval22(a),c=b[0],b=b[1],d=a.e[0][1].div(c.sub(a.e[0][0])),e=Jmat.Complex(1);a=a.e[0][1].div(b.sub(a.e[0][0]));var f=Jmat.Complex(1),g={};g.l=new Jmat.Matrix(2,1);g.l.e[0][0]=c;g.l.e[1][0]=b;g.v=new Jmat.Matrix(2,2);g.v.e[0][0]=d;g.v.e[1][0]=e;g.v.e[0][1]=a;g.v.e[1][1]=f;return g};
Jmat.Matrix.eigval_=function(a){for(var b=Jmat.Complex,c=Jmat.Matrix,d=a.w,e=b(0),f=b(0),g=b(0),h=b(0),k=b(0),l=[],g=0;g<d;g++)l[g]=b(0);for(;0<d;)for(var m=0;30>=m;m++){if(30==m)return null;for(g=d-1;1<=g;g--)if(b.abs1r(a.e[g][g-1])<=1.2E-16*(b.abs1r(a.e[g-1][g-1])+b.abs1r(a.e[g][g]))){a.e[g][g-1]=b(0);break}if(g==d-1){l[d-1]=a.e[d-1][d-1].add(f);d--;break}10==m||20==m?(e.re=Math.abs(a.e[d-1][d-2].re)+Math.abs(a.e[d-2][d-3].re),e.im=Math.abs(a.e[d-1][d-2].im)+Math.abs(a.e[d-2][d-3].im)):(e=a.e[d-
1][d-1],g=a.e[d-2][d-1].mul(a.e[d-1][d-2]),g.eqr(0)||(h=a.e[d-2][d-2].sub(e).divr(2),k=b.sqrt(h.mul(h).add(g)),0>h.re*k.re+h.im*k.im&&(k=k.neg()),g=g.div(h.add(k)),e=e.sub(g)));for(g=0;g<d;g++)a.e[g][g]=a.e[g][g].sub(e);f=f.add(e);g=[];for(h=0;h+1<d;h++)g[h]=c.getGivensParams_(a.e[h][h],a.e[h+1][h]),c.givensPre_(a,h,h+1,g[h][0],g[h][1]),a.e[h+1][h]=b(0),a.e[h][h]=g[h][2];for(h=0;h+1<d;h++)c.givensPost_(a,h,h+1,g[h][0],g[h][1])}return l};
Jmat.Matrix.eigval=function(a){var b=Jmat.Matrix;if(a.w!=a.h||1>a.w)return null;var c=a.w;if(1==c)return[a.e[0][0]];if(2==c)return b.eigval22(a);a=b.toHessenberg(a);b=b.eigval_(a);b.sort(function(a,b){return b.abssq()-a.abssq()});return b};
Jmat.Matrix.eigenVectorFor=function(a,b,c){var d=Jmat.Matrix;if(a.w!=a.h||1>a.w)return null;var e=a.w;c=void 0==c?1:c;a=d.copy(a);for(var f=0;f<e;f++)a.e[f][f]=a.e[f][f].sub(b);b=d.zero(e,1);if(a=d.solve(a,b,.01))2==c&&(a=a.divc(d.norm(a))),1==c&&(a.e[e-1][0].eqr(0)||(a=a.divc(a.e[e-1][0])));else for(a=d.zero(e,1),f=0;f<e;f++)a.e[f][0]=Jmat.Complex(NaN,NaN);return a};
Jmat.Matrix.jacobi_=function(a,b,c){for(var d=[],e=[],f=a.w,g=0;g<f;g++){d[g]=[];for(var h=0;h<f;h++)d[g][h]=a.e[g][h].re}Jmat.Real.matrix_jacobi(d,e,f,b);if(1==c||void 0==c)for(g=0;g<f;g++)if(0!=e[g][f-1])for(h=0;h<f;h++)e[g][h]/=e[g][f-1];e=Jmat.Matrix(e).transpose();a=Jmat.Matrix(f,1);for(b=0;b<f;b++)a.e[b][0]=Jmat.Complex(d[b][b]);return{l:a,v:e}};
Jmat.Matrix.eig=function(a,b){var c=Jmat.Matrix;if(a.w!=a.h||1>a.w)return null;var d=a.w;if(1==d)return c.eig11(a);if(2==d)return c.eig22(a);if(c.isReal(a)&&c.isSymmetric(a))return Jmat.Matrix.jacobi_(a,b);var e=c.eigval(a);e.sort(function(a,b){return b.abssq()-a.abssq()});for(var f=null,f=new c(d,d),g=0;g<d;g++){var h=c.eigenVectorFor(a,e[g],b);c.setCol(f,h,g)}return{l:e,v:f}};Jmat.Matrix.evd=function(a){a=Jmat.Matrix.eig(a);return{v:a.v,d:Jmat.Matrix.diag(a.l)}};
Jmat.Matrix.definiteness_=function(a,b){var c=void 0==b?1E-12:b,d=Jmat.Matrix.eigval(a);if(!d)return null;for(var e=[!1,!1,!1],f=0;f<d.length;f++)Jmat.Real.near(d[f].re,0,c)?e[1]=!0:0<d[f].re?e[2]=!0:e[0]=!0;return e};Jmat.Matrix.INDEFINITE=0;Jmat.Matrix.POSITIVE_DEFINITE=1;Jmat.Matrix.POSITIVE_SEMI_DEFINITE=2;Jmat.Matrix.NEGATIVE_DEFINITE=3;Jmat.Matrix.NEGATIVE_SEMI_DEFINITE=4;
Jmat.Matrix.definiteness=function(a,b){if(!Jmat.Matrix.isHermitian(a,b))return null;var c=Jmat.Matrix.definiteness_(a,b);return!c[2]||c[0]||c[1]?!c[0]||c[2]||c[1]?c[0]?c[2]?c[0]&&c[2]?Jmat.Matrix.INDEFINITE:null:Jmat.Matrix.NEGATIVE_SEMI_DEFINITE:Jmat.Matrix.POSITIVE_SEMI_DEFINITE:Jmat.Matrix.NEGATIVE_DEFINITE:Jmat.Matrix.POSITIVE_DEFINITE};Jmat.Matrix.arrayToCol=function(a){for(var b=new Jmat.Matrix(a.length,1),c=0;c<a.length;c++)b.e[c][0]=Jmat.Complex.cast(a[c]);return b};
Jmat.Matrix.arrayToRow=function(a){for(var b=new Jmat.Matrix(1,a.length),c=0;c<a.length;c++)b.e[0][c]=Jmat.Complex.cast(a[c]);return b};Jmat.Matrix.arrayToDiag=function(a){for(var b=new Jmat.Matrix(a.length,a.length),c=0;c<a.length;c++)b.e[c][c]=Jmat.Complex.cast(a[c]);return b};Jmat.Matrix.diag=function(a){for(var b=a.w*a.h,b=Jmat.Matrix.zero(b,b),c=0,d=0;d<a.h;d++)for(var e=0;e<a.w;e++)b.e[c][c]=a.e[d][e],c++;return b};
Jmat.Matrix.diagToCol=function(a){for(var b=Math.min(a.h,a.w),c=Jmat.Matrix(b,1),d=0;d<b;d++)c.e[d][0]=a.e[d][d];return c};Jmat.Matrix.diagToRow=function(a){for(var b=Math.min(a.h,a.w),c=Jmat.Matrix(1,b),d=0;d<b;d++)c.e[0][d]=a.e[d][d];return c};Jmat.Matrix.get1=function(a,b){return a.e[Math.floor(b/a.w)][b%a.w]};Jmat.Matrix.prototype.get1=function(a){return Jmat.Matrix.get1(this,a)};Jmat.Matrix.set1=function(a,b,c){a.e[Math.floor(b/a.w)][b%a.w]=c};
Jmat.Matrix.cross=function(a,b){if(3!=a.w*a.h||3!=b.w*b.h)return Jmat.Matrix(NaN);var c=new Jmat.Matrix(a.h,a.w);Jmat.Matrix.set1(c,0,a.get1(1).mul(b.get1(2)).sub(a.get1(2).mul(b.get1(1))));Jmat.Matrix.set1(c,1,a.get1(2).mul(b.get1(0)).sub(a.get1(0).mul(b.get1(2))));Jmat.Matrix.set1(c,2,a.get1(0).mul(b.get1(1)).sub(a.get1(1).mul(b.get1(0))));return c};
Jmat.Matrix.dot=function(a,b){if(a.w!=b.w||a.h!=b.h)if(a.w!=b.h||a.h!=b.w||1!=a.w&&1!=a.h)return Jmat.Matrix(NaN);for(var c=a.w*a.h,d=Jmat.Complex(0),e=0;e<c;e++)d=d.add(a.get1(e).mul(b.get1(e).conj()));return d};
Jmat.Matrix.zsvdc_=function(a,b,c,d,e,f,g,h,k,l,m,n){var p,r,q,u,t,v,w,y,A,z,x,B,D,I;z=function(a){return Math.abs(a.re)+Math.abs(a.im)};var J=function(a,b){return b.eqr(0)?Jmat.Complex(0):b.mulr(a.abs()/b.abs())};I=function(a,b,c){for(var d=Jmat.Complex(0),e=0;e<a;e++)var f=b[c+e],d=d.add(f.mul(f.conj()));return Jmat.Complex.sqrt(d)};x=function(a,b,c,d,e,f){for(var g=0;g<a;g++)e[f+g]=e[f+g].add(c[d+g].mul(b))};w=function(a,b,c,d,e){for(var f=Jmat.Complex(0),g=0;g<a;g++)f=f.add(b[c+g].conj().mul(d[e+
g]));return f};var F=function(a,b,c,d){for(var e=0;e<a;e++)c[d+e]=c[d+e].mul(b)},G=function(a,b){var c=Math.abs(a),d=Math.abs(b),e;e=Math.sqrt(a*a+b*b);var f=c>d?a:b;e=0==f?0:0>f?-Math.abs(e):Math.abs(e);var f=0==e?1:a/e,g=0==e?0:b/e;return[e,c>d?g:0==e?0:0==f?1:1/f,f,g]},H=function(a,b,c,d,e,f,g){for(var h=0;h<a;h++){var k=b[c+h],l=d[e+h];b[c+h]=k.mulr(f).add(l.mulr(g));d[e+h]=l.mulr(f).sub(k.mulr(g))}},K=function(a,b,c,d,e){for(var f=0;f<a;f++){var g=b[f+c];b[f+c]=d[f+e];d[f+e]=g}},E=!1,C=!1;u=
Math.floor(n%100/10);r=1<u?Math.min(c,d):c;0!=u&&(E=!0);0!=n%10&&(C=!0);u=0;B=Math.min(c-1,d);D=Math.max(0,Math.min(d-2,c));A=Math.max(B,D);for(n=0;n<A;n++){v=n+1;n<B&&(e[n]=Jmat.Complex(I(c-n,a,n+n*b)),1E-150>z(e[n])||(1E-150>z(a[n+n*b])||(e[n]=J(e[n],a[n+n*b])),t=Jmat.Complex(1).div(e[n]),F(c-n,t,a,n+n*b),a[n+n*b]=a[n+n*b].addr(1)),e[n]=e[n].neg());for(q=v;q<d;q++)n<B&&!(1E-150>z(e[n]))&&(t=w(c-n,a,n+n*b,a,n+q*b).neg().div(a[n+n*b]),x(c-n,t,a,n+n*b,a,n+q*b)),f[q]=a[n+q*b].conj();if(E&&n<B)for(p=
n;p<c;p++)g[p+n*h]=a[p+n*b];if(n<D){f[n]=Jmat.Complex(I(d-n-1,f,v));1E-150>z(f[n])||(1E-150>z(f[v])||(f[n]=J(f[n],f[v])),t=Jmat.Complex(1).div(f[n]),F(d-n-1,t,f,v),f[v]=Jmat.Complex(1).add(f[v]));f[n]=f[n].conj().neg();if(v<c&&!(1E-150>z(f[n]))){for(q=v;q<c;q++)m[q]=Jmat.Complex(0);for(q=v;q<d;q++)x(c-n-1,f[q],a,v+q*b,m,v);for(q=v;q<d;q++)x(c-n-1,f[q].neg().div(f[v]).conj(),m,v,a,v+q*b)}if(C)for(p=v;p<d;p++)k[p+n*l]=f[p]}}m=Math.min(d,c+1);B<d&&(e[B]=a[B+B*b]);c<m&&(e[m-1]=Jmat.Complex(0));D+1<m&&
(f[D]=a[D+(m-1)*b]);f[m-1]=Jmat.Complex(0);if(E){for(q=B;q<r;q++){for(p=0;p<c;p++)g[p+q*h]=Jmat.Complex(0);g[q+q*h]=Jmat.Complex(1)}for(a=0;a<B;a++)if(n=B-a-1,0==z(e[n])){for(p=0;p<c;p++)g[p+n*h]=Jmat.Complex(0);g[n+n*h]=Jmat.Complex(1)}else{for(q=v=n+1;q<r;q++)t=w(c-n,g,n+n*h,g,n+q*h).neg().div(g[n+n*h]),x(c-n,t,g,n+n*h,g,n+q*h);F(c-n,Jmat.Complex(-1),g,n+n*h);g[n+n*h]=g[n+n*h].inc();for(p=0;p<n;p++)g[p+n*h]=Jmat.Complex(0)}}if(C)for(a=0;a<d;a++){n=d-a-1;v=n+1;if(n<D&&!(1E-150>z(f[n])))for(q=v;q<
d;q++)t=w(d-v,k,v+n*l,k,v+q*l).neg().div(k[v+n*l]),x(d-v,t,k,v+n*l,k,v+q*l);for(p=0;p<d;p++)k[p+n*l]=Jmat.Complex(0);k[n+n*l]=Jmat.Complex(1)}for(p=0;p<m;p++){1E-150>z(e[p])||(t=Jmat.Complex.abs(e[p]),r=e[p].div(t),e[p]=t,p+1<m&&(f[p]=f[p].div(r)),E&&F(c,r,g,p*h));if(p+1==m)break;1E-150>z(f[p])||(t=Jmat.Complex.abs(f[p]),r=t.div(f[p]),f[p]=t,e[p+1]=e[p+1].mul(r),C&&F(d,r,k,(p+1)*l))}z=m;for(r=0;0!=m;){if(30<=r){u=m;break}for(a=1;a<=m;a++){n=m-a;if(0==n)break;t=e[n-1].abs()+e[n].abs();x=t+f[n-1].abs();
if(x==t){f[n-1]=Jmat.Complex(0);break}}if(n==m-1)v=4;else{v=n+1;a=m+1;for(w=v;w<=a;w++){y=m-w+v;if(y==n)break;t=0;y!=m&&(t+=f[y-1].abs());y!=n+1&&(t+=f[y-2].abs());x=t+e[y-1].abs();if(x==t){e[y-1]=Jmat.Complex(0);break}}y==n?v=3:y==m?v=1:(v=2,n=y)}n++;if(1==v)for(x=m-1,v=f[m-2].re,f[m-2]=Jmat.Complex(0),a=n;a<=x;a++)t=x-a+n,p=e[t-1].re,b=G(p,v),p=b[0],v=b[1],w=b[2],b=b[3],e[t-1]=Jmat.Complex(p),t!=n&&(v=-b*f[t-2].re,f[t-2]=f[t-2].mulr(w)),C&&H(d,k,(t-1)*l,k,(m-1)*l,w,b);else if(2==v)for(v=f[n-2].re,
f[n-2]=Jmat.Complex(0),t=n;t<=m;t++)p=e[t-1].re,b=G(p,v),p=b[0],v=b[1],w=b[2],b=b[3],e[t-1]=Jmat.Complex(p),v=-b*f[t-1].re,f[t-1]=f[t-1].mulr(w),E&&H(c,g,(t-1)*h,g,(n-2)*h,w,b);else if(3==v){x=Math.max(Math.max(Math.max(Math.max(e[m-1].abs(),e[m-2].abs()),f[m-2].abs()),e[n-1].abs()),f[n-1].abs());v=e[m-1].re/x;w=e[m-2].re/x;a=f[m-2].re/x;t=e[n-1].re/x;x=f[n-1].re/x;w=((w+v)*(w-v)+a*a)/2;a*=v*a*v;b=0;if(0!=w||0!=a)b=Math.sqrt(w*w+a),0>w&&(b=-b),b=a/(w+b);v=(t+v)*(t-v)+b;a=t*x;x=m-1;for(t=n;t<=x;t++)b=
G(v,a),v=b[0],a=b[1],w=b[2],b=b[3],t!=n&&(f[t-2]=Jmat.Complex(v)),v=w*e[t-1].re+b*f[t-1].re,f[t-1]=f[t-1].mulr(w).sub(e[t-1].mulr(b)),a=b*e[t].re,e[t]=e[t].mulr(w),C&&H(d,k,(t-1)*l,k,t*l,w,b),b=G(v,a),v=b[0],a=b[1],w=b[2],b=b[3],e[t-1]=Jmat.Complex(v),v=w*f[t-1].re+b*e[t].re,e[t]=f[t-1].mulr(-b).add(e[t].mulr(w)),a=b*f[t].re,f[t]=f[t].mulr(w),E&&t<c&&H(c,g,(t-1)*h,g,t*h,w,b);f[m-2]=Jmat.Complex(v);r++}else if(4==v){0>e[n-1].re&&(e[n-1]=e[n-1].neg(),C&&F(d,Jmat.Complex(-1),k,(n-1)*l));for(;n!=z&&!(e[n].re<=
e[n-1].re);)t=e[n-1],e[n-1]=e[n],e[n]=t,C&&n<d&&K(d,k,(n-1)*l,k,n*l),E&&n<c&&K(c,g,(n-1)*h,g,n*h),n++;r=0;m--}}return u};
Jmat.Matrix.svd=function(a){for(var b=[],c=0;c<a.h;c++)for(var d=0;d<a.w;d++)b[c+d*a.h]=a.e[c][d];var e=[],f=[],g=[];Jmat.Matrix.zsvdc_(b,a.h,a.h,a.w,e,[],f,a.h,g,a.w,[],11);for(c=0;c<e.length;c++)1E-15>Math.abs(e[c])&&(e[c]=0);b={u:new Jmat.Matrix(a.h,a.h),s:new Jmat.Matrix(a.h,a.w),v:new Jmat.Matrix(a.w,a.w)};for(c=0;c<a.h;c++)for(d=0;d<a.h;d++)b.u.e[c][d]=f[c+d*a.h];for(c=0;c<a.h;c++)for(d=0;d<a.w;d++)b.s.e[c][d]=d==c?Jmat.Complex(e[d]):Jmat.Complex(0);for(c=0;c<a.w;c++)for(d=0;d<a.w;d++)b.v.e[c][d]=
g[c+d*a.w];return b};Jmat.Matrix.eq=function(a,b){if(a.w!=b.w||a.h!=b.h)return!1;for(var c=0;c<a.h;c++)for(var d=0;d<a.w;d++)if(!a.e[c][d].eq(b.e[c][d]))return!1;return!0};Jmat.Matrix.near=function(a,b,c){if(a.w!=b.w||a.h!=b.h)return!1;for(var d=0;d<a.h;d++)for(var e=0;e<a.w;e++)if(!Jmat.Complex.near(a.e[d][e],b.e[d][e],c))return!1;return!0};
Jmat.Matrix.relnear=function(a,b,c){if(a.w!=b.w||a.h!=b.h)return!1;for(var d=0;d<a.h;d++)for(var e=0;e<a.w;e++)if(!Jmat.Complex.relnear(a.e[d][e],b.e[d][e],c))return!1;return!0};
Jmat.Matrix.solve=function(a,b,c){var d=Jmat.Matrix;if(a.h==b.h){c=void 0==c?1E-12:c;if(d.isZero(b))return b=d.svd(a),Jmat.Complex.nearr(b.s.e[b.s.h-1][b.s.h-1],0,c)?d.col(b.v,a.w-1):null;b=d.augment(a,b);c=d.rref(b);a=d(a.w,1,0);for(var e=d=0;e<c.h;e++){for(var f=d;f<c.w;f++)if(!c.e[e][f].eqr(0)){if(f==c.w-1)return null;a.e[f][0]=c.e[e][b.w-1];d=f+1;break}if(f==c.w-1)break}return a}};Jmat.Matrix.leastSquares=function(a,b){return Jmat.Matrix.pseudoinverse(a).mul(b)};
Jmat.Matrix.rref=function(a){var b=Jmat.Complex,c=a.h,d=a.w;a=Jmat.Matrix.copy(a);for(var e=function(a,b,c){for(var e=0;e<d;e++){var f=a.e[b][e];a.e[b][e]=a.e[c][e];a.e[c][e]=f}},f=function(a,b,c,e){for(;b<d;b++)a.e[c][b]=a.e[c][b].mul(e)},g=function(a,b,c,d,e){for(var f=a.e[0].length;b<f;b++)a.e[e][b]=a.e[e][b].sub(a.e[c][b].mul(d))},h=[],k=0,l=0;l<d;l++){var m=Jmat.Real.argmax(k,c,function(b){return a.e[b][l].abssq()});if(!a.e[m][l].eqr(0)){m!=k&&e(a,k,m);f(a,l,k,a.e[k][l].inv());for(m=k+1;m<c;m++)a.e[m][l].eqr(0)||
(g(a,l+1,k,a.e[m][l],m),a.e[m][l]=b(0));h.push(l);k++;if(k>=c)break}}for(l=0;l<h.length;l++)for(c=h[l],e=l-1;0<=e;e--)a.e[e][c].eqr(0)||(g(a,c+1,l,a.e[e][c],e),a.e[e][c]=b(0));return a};
Jmat.Matrix.random=function(a,b,c,d,e,f){var g=Jmat.Complex;c=c||b||Math.floor(10*Math.random()+2);b=b||Math.floor(10*Math.random()+2);f=void 0==f?1:f;d=void 0==d?0:d;e=void 0==e?1:e;a=a||{real:!0};var h=a.real||a.integer,k=a.integer,l=a.binary;a=a.hermitian;for(var m=function(a){if(1<=f||Math.random()<f){if(l)return.5<Math.random()?g(1):g(0);a=a?g(Math.random()*(e-d)+d):g.random(d,e);return k?g(Math.floor(a.re)):a}return g(0)},n=Jmat.Matrix(b,c),p=0;p<b;p++)for(var r=0;r<c;r++)n.e[p][r]=a&&p>r?n.e[r][p].conj():
a&&r==p?m(!0):m(h);return n};Jmat.Matrix.matrixfft_=function(a,b){var c=new Jmat.Matrix(a.h,a.w);if(1<a.w)for(var d=0;d<a.h;d++)for(var e=Jmat.Complex.fft(a.e[d],b),f=0;f<a.w;f++)c.e[d][f]=e[f];else c=a;var g=new Jmat.Matrix(a.h,a.w);if(1<a.h)for(d=0;d<a.w;d++)for(e=Jmat.Matrix.transpose(Jmat.Matrix.col(c,d)),e=Jmat.Complex.fft(e.e[0],b),f=0;f<a.h;f++)g.e[f][d]=e[f];else g=c;return g};Jmat.Matrix.fft=function(a){return Jmat.Matrix.matrixfft_(a,0)};
Jmat.Matrix.ifft=function(a){return Jmat.Matrix.matrixfft_(a,1)};Jmat.Matrix.exp=function(a){if(a.h!=a.w)return null;for(var b=a.add(Jmat.Matrix.identity(a.w,a.w)),c=a,d=1,e=2;20>=e;e++)d*=e,c=c.mul(a),b=b.add(c.mulr(1/d));return b};Jmat.Matrix.cos=function(a){if(a.h!=a.w)return null;var b=Jmat.Matrix.identity(a.w,a.w);a=a.mul(a);for(var c=null,d=1,e=1,f=0;20>f;f++)d=0==f?2:d*(2*f+1)*(2*f+2),e=-e,c=null==c?a:c.mul(a),b=b.add(c.mulr(e/d));return b};
Jmat.Matrix.sin=function(a){if(a.h!=a.w)return null;for(var b=a,c=a.mul(a),d=1,e=1,f=0;20>f;f++)d=d*(2*f+2)*(2*f+3),e=-e,a=a.mul(c),b=b.add(a.mulr(e/d));return b};Jmat.Matrix.sqrt=function(a){if(a.h!=a.w)return null;var b=Jmat.Matrix.evd(a);a=b.v;for(var b=b.d,c=0;c<b.w;c++)b.e[c][c]=Jmat.Complex.sqrt(b.e[c][c]);return a.mul(b).mul(Jmat.Matrix.inv(a))};
Jmat.Matrix.log=function(a){if(a.h!=a.w)return null;var b=Jmat.Matrix.evd(a);a=b.v;for(var b=b.d,c=0;c<b.w;c++)b.e[c][c]=Jmat.Complex.log(b.e[c][c]);return a.mul(b).mul(Jmat.Matrix.inv(a))};Jmat.Matrix.powc=function(a,b){if(a.h!=a.w)return null;for(var c=Jmat.Matrix.evd(a),d=c.v,c=c.d,e=0;e<c.w;e++)c.e[e][e]=c.e[e][e].pow(b);return d.mul(c).mul(Jmat.Matrix.inv(d))};Jmat.Quaternion=function(a,b,c,d){if(this instanceof Jmat.Quaternion)this.w=a,this.x=b,this.y=c,this.z=d;else return Jmat.Quaternion.make(a,b,c,d)};Jmat.Quaternion.make=function(a,b,c,d){return void 0==a?new Jmat.Quaternion(0,0,0,0):"number"==typeof a?new Jmat.Quaternion(a,b||0,c||0,d||0):"string"==typeof a?Jmat.Quaternion.parse(a):void 0!=a.re?new Jmat.Quaternion(a.re,a.im||0,b&&b.re||0,b&&b.im||0):a.e&&2==a.w&&2==a.h?Jmat.Quaternion.from2x2(a):a.e&&4==a.w&&4==a.h?Jmat.Quaternion.from4x4(a):Jmat.Quaternion.copy(a)};
Jmat.Quaternion.cast=function(a){return a&&void 0!=a.w?a:void 0==a?Jmat.Quaternion(0):Jmat.Quaternion(a)};Jmat.Quaternion.copy=function(a){return new Jmat.Quaternion(a.w,a.x,a.y,a.z)};
Jmat.Quaternion.toString=function(a,b){if(!a)return 0==a?"invalid0":""+a;var c=b?Jmat.Complex.formatFloat_(a.w,b):""+a.w,d=b?Jmat.Complex.formatFloat_(a.x,b):""+a.x,e=b?Jmat.Complex.formatFloat_(a.x,b):""+a.y,f=b?Jmat.Complex.formatFloat_(a.x,b):""+a.z,g="";0!=a.w&&(g+=c);0!=a.x&&(g+=(0==g.length||0>a.x?d:"+"+d)+"i");0!=a.y&&(g+=(0==g.length||0>a.y?e:"+"+e)+"j");0!=a.z&&(g+=(0==g.length||0>a.z?f:"+"+f)+"k");return g};
Jmat.Quaternion.prototype.toString=function(a){return Jmat.Quaternion.toString(this,a)};
Jmat.Quaternion.parse=function(a){a=a.replace(/ /g,"");var b=a.split(/\b/);a=[];for(var c=!1,d=0;d<b.length;d++){var e=b[d];0!=d&&(c||"-"!=e[0]&&"+"!=e[0])||a.push("");a[a.length-1]+=e;c="e"==e[e.length-1]||"E"==e[e.length-1]}for(var f=c=b=0,g=0,d=0;d<a.length;d++){var e=a[d],h=e[e.length-1];if("i"==h||"j"==h||"k"==h){e=e.substr(0,e.length-1);if(""==e||"+"==e)e="1";"-"==e&&(e="-1");"i"==h&&(c=parseFloat(e));"j"==h&&(f=parseFloat(e));"k"==h&&(g=parseFloat(e))}else b=parseFloat(e)}return new Jmat.Quaternion(b,
c,f,g)};Jmat.Quaternion.add=function(a,b){return new Jmat.Quaternion(a.w+b.w,a.x+b.x,a.y+b.y,a.z+b.z)};Jmat.Quaternion.prototype.add=function(a){return new Jmat.Quaternion(this.w+a.w,this.x+a.x,this.y+a.y,this.z+a.z)};Jmat.Quaternion.sub=function(a,b){return new Jmat.Quaternion(a.w-b.w,a.x-b.x,a.y-b.y,a.z-b.z)};Jmat.Quaternion.prototype.sub=function(a){return new Jmat.Quaternion(this.w-a.w,this.x-a.x,this.y-a.y,this.z-a.z)};
Jmat.Quaternion.mul=function(a,b){return new Jmat.Quaternion(a.w*b.w-a.x*b.x-a.y*b.y-a.z*b.z,a.w*b.x+a.x*b.w+a.y*b.z-a.z*b.y,a.w*b.y-a.x*b.z+a.y*b.w+a.z*b.x,a.w*b.z+a.x*b.y-a.y*b.x+a.z*b.w)};Jmat.Quaternion.prototype.mul=function(a){return Jmat.Quaternion.mul(this,a)};Jmat.Quaternion.mulr=function(a,b){return new Jmat.Quaternion(a.w*b,a.x*b,a.y*b,a.z*b)};Jmat.Quaternion.prototype.mulr=function(a){return new Jmat.Quaternion(this.w*a,this.x*a,this.y*a,this.z*a)};
Jmat.Quaternion.divr=function(a,b){return new Jmat.Quaternion(a.w/b,a.x/b,a.y/b,a.z/b)};Jmat.Quaternion.prototype.divr=function(a){return new Jmat.Quaternion(this.w/a,this.x/a,this.y/a,this.z/a)};Jmat.Quaternion.addr=function(a,b){return new Jmat.Quaternion(a.w+b,a.x,a.y,a.z)};Jmat.Quaternion.prototype.addr=function(a){return new Jmat.Quaternion(this.w+a,this.x,this.y,this.z)};Jmat.Quaternion.subr=function(a,b){return new Jmat.Quaternion(a.w-b,a.x,a.y,a.z)};
Jmat.Quaternion.prototype.subr=function(a){return new Jmat.Quaternion(this.w-a,this.x,this.y,this.z)};Jmat.Quaternion.rsub=function(a,b){return new Jmat.Quaternion(b-a.w,-a.x,-a.y,-a.z)};Jmat.Quaternion.prototype.rsub=function(a){return new Jmat.Quaternion(a-this.w,-this.x,-this.y,-this.z)};Jmat.Quaternion.neg=function(a){return Jmat.Quaternion(-a.w,-a.x,-a.y,-a.z)};Jmat.Quaternion.prototype.neg=function(){return Jmat.Quaternion(-this.w,-this.x,-this.y,-this.z)};
Jmat.Quaternion.conj=function(a){return Jmat.Quaternion(a.w,-a.x,-a.y,-a.z)};Jmat.Quaternion.prototype.conj=function(){return Jmat.Quaternion(this.w,-this.x,-this.y,-this.z)};Jmat.Quaternion.abs=function(a){return Jmat.Quaternion(a.abs())};Jmat.Quaternion.prototype.abs=function(){return Math.sqrt(this.abssq())};Jmat.Quaternion.abssq=function(a){return Jmat.Quaternion(a.abssq())};
Jmat.Quaternion.prototype.abssq=function(){return-Infinity==this.w||-Infinity==this.x||-Infinity==this.y||-Infinity==this.z?Infinity:this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z};Jmat.Quaternion.dist=function(a,b){return a.sub(b).abs()};Jmat.Quaternion.cheb=function(a,b){return Math.max(Math.max(Jmat.Real.dist(a.w,b.w),Jmat.Real.dist(a.x,b.x)),Math.max(Jmat.Real.dist(a.y,b.y),Jmat.Real.dist(a.z,b.z)))};
Jmat.Quaternion.manhattan=function(a,b){return Math.abs(a.w-b.w)+Math.abs(a.x-b.x)+Math.abs(a.y-b.y)+Math.abs(a.z-b.z)};Jmat.Quaternion.absv=function(a){return Jmat.Quaternion(a.absv())};Jmat.Quaternion.prototype.absv=function(){return Math.sqrt(this.absvsq())};Jmat.Quaternion.absvsq=function(a){return Jmat.Quaternion(a.abssq())};Jmat.Quaternion.prototype.absvsq=function(){return-Infinity==this.x||-Infinity==this.y||-Infinity==this.z?Infinity:this.x*this.x+this.y*this.y+this.z*this.z};
Jmat.Quaternion.arg=function(a){return Jmat.Quaternion(a.arg())};Jmat.Quaternion.prototype.arg=function(){return Math.atan2(this.absv(),this.w)};Jmat.Quaternion.inv=function(a){return a.conj().divr(a.abssq())};Jmat.Quaternion.prototype.inv=function(){return this.conj().divr(this.abssq())};Jmat.Quaternion.div=function(a,b){return a.mul(b.inv())};Jmat.Quaternion.prototype.div=function(a){return this.mul(a.inv())};Jmat.Quaternion.leftdiv=function(a,b){return a.inv().mul(b)};
Jmat.Quaternion.prototype.leftdiv=function(a){return this.inv().mul(a)};Jmat.Quaternion.sign=function(a){var b=a.abs();return 0==b?a:a.divr(b)};Jmat.Quaternion.normalize=Jmat.Quaternion.sign;Jmat.Quaternion.prototype.normalize=function(){return Jmat.Quaternion.sign(this)};Jmat.Quaternion.to2x2=function(a){var b=Jmat.Complex;return[[b(a.w,a.x),b(a.y,a.z)],[b(-a.y,a.z),b(a.w,-a.x)]]};Jmat.Quaternion.from2x2=function(a){var b=a.e?a.e:a;a=b[0][0];b=b[0][1];return new Jmat.Quaternion(a.re,a.im,b.re,b.im)};
Jmat.Quaternion.to4x4=function(a){return[[a.w,a.x,a.y,a.z],[-a.x,a.w,-a.z,a.y],[-a.y,a.z,a.w,-a.x],[-a.z,-a.y,a.x,a.w]]};Jmat.Quaternion.from4x4=function(a){a=a.e?a.e:a;return new Jmat.Quaternion(a[0][0].re,a[0][1].re,a[0][2].re,a[0][3].re)};Jmat.Quaternion.to3x3rot=function(a){var b=a.w*a.w,c=a.x*a.x,d=a.y*a.y,e=a.z*a.z;return[[b+c-d-e,2*a.x*a.y-2*a.w*a.z,2*a.x*a.z+2*a.w*a.y],[2*a.x*a.y+2*a.w*a.z,b-c+d-e,2*a.y*a.z-2*a.w*a.x],[2*a.x*a.z-2*a.w*a.y,2*a.y*a.z+2*a.w*a.x,b-c-d+e]]};
Jmat.Quaternion.from3x3rot=function(a){a=a.e?a.e:a;var b=1+a[0][0].re+a[1][1].re+a[2][2].re;if(1E-7<b)return b=2*Math.sqrt(b),new Jmat.Quaternion(.25*b,(a[2][1].re-a[1][2].re)/b,(a[0][2].re-a[2][0].re)/b,(a[1][0].re-a[0][1].re)/b);if(a[0][0].re>a[1][1].re&&a[0][0].re>a[2][2].re)return b=2*Math.sqrt(1+a[0][0].re-a[1][1].re-a[2][2].re),new Jmat.Quaternion((a[2][1].re-a[1][2].re)/b,.25*b,(a[1][0].re+a[0][1].re)/b,(a[0][2].re-a[2][0].re)/b);if(a[1][1].re>a[2][2].re)return b=2*Math.sqrt(1+a[1][1].re-a[0][0].re-
a[2][2].re),new Jmat.Quaternion((a[0][2].re-a[2][0].re)/b,(a[1][0].re+a[0][1].re)/b,.25*b,(a[2][1].re+a[1][2].re)/b);b=2*Math.sqrt(1+a[2][2].re-a[0][0].re-a[1][1].re);return new Jmat.Quaternion((a[1][0].re-a[0][1].re)/b,(a[0][2].re+a[2][0].re)/b,(a[2][1].re+a[1][2].re)/b,.5*b)};Jmat.Quaternion.prototype.getVector=function(){return[[this.x],[this.y],[this.z]]};Jmat.Quaternion.prototype.qvector=function(){return new Jmat.Quaternion(0,this.x,this.y,this.z)};
Jmat.Quaternion.exp=function(a){var b=Math.exp(a.w),c=a.absv(),d=b*Math.sin(c)/c;return new Jmat.Quaternion(b*Math.cos(c),d*a.x,d*a.y,d*a.z)};Jmat.Quaternion.log=function(a){var b=a.abs(),c=a.absv();if(0==c)return new Jmat.Quaternion(Math.log(a.w),0,0,0);c=Math.acos(a.w/b)/c;return new Jmat.Quaternion(Math.log(b),c*a.x,c*a.y,c*a.z)};Jmat.Quaternion.logy=function(a,b){return Jmat.Quaternion.log(a).div(Jmat.Quaternion.log(b))};Jmat.Quaternion.logr=function(a,b){return Jmat.Quaternion.log(a).divr(Math.log(b))};
Jmat.Quaternion.log2=function(a){return Jmat.Quaternion.log(a).divr(Math.LN2)};Jmat.Quaternion.log10=function(a){return Jmat.Quaternion.log(a).divr(Math.LN10)};Jmat.Quaternion.pow=function(a,b){var c=Jmat.Quaternion;return c.exp(c.log(a).mul(b))};Jmat.Quaternion.prototype.pow=function(a){return Jmat.Quaternion.pow(this,a)};Jmat.Quaternion.powr=function(a,b){var c=Jmat.Quaternion;return c.exp(c.log(a).mulr(b))};Jmat.Quaternion.prototype.powr=function(a){return Jmat.Quaternion.powr(this,a)};
Jmat.Quaternion.sqrt=function(a){return a.powr(.5)};Jmat.Quaternion.eq=function(a,b){return a&&b?a.w==b.w&&a.x==b.x&&a.y==b.y&&a.z==b.z:a==b};Jmat.Quaternion.prototype.eq=function(a){return a&&this.w==a.w&&this.x==a.x&&this.y==a.y&&this.z==a.z};Jmat.Quaternion.eqr=function(a,b){return a&&b?a.w==b&&0==a.x&&0==a.y&&0==a.z:a==b};Jmat.Quaternion.prototype.eqr=function(a){return this.w==a&&0==this.x&&0==this.y&&0==this.z};
Jmat.Quaternion.near=function(a,b,c){return a.w-c<=b.w&&a.w+c>=b.w&&a.x-c<=b.x&&a.x+c>=b.x&&a.y-c<=b.y&&a.x+c>=b.y&&a.z-c<=b.z&&a.x+c>=b.z};Jmat.Quaternion.relnear=function(a,b,c){return a.eq(b)?!0:a.sub(b).abs()<Math.max(a.abs(),b.abs())*c};Jmat.Quaternion.ONE=new Jmat.Quaternion(1,0,0,0);Jmat.Quaternion.I=new Jmat.Quaternion(0,1,0,0);Jmat.Quaternion.J=new Jmat.Quaternion(0,0,1,0);Jmat.Quaternion.K=new Jmat.Quaternion(0,0,0,1);
Jmat.Quaternion.sin=function(a){var b=a.absv(),c=Math.sin(a.w)*Jmat.Real.cosh(b),d=Math.cos(a.w)*Jmat.Real.sinh(b);return new Jmat.Quaternion(c,d*a.x/b,d*a.y/b,d*a.z/b)};Jmat.Quaternion.cos=function(a){var b=a.absv();if(0==b)return Jmat.Quaternion(Math.cos(a.w),0,0,0);var c=Math.cos(a.w)*Jmat.Real.cosh(b),d=Math.sin(a.w)*Jmat.Real.sinh(b);return new Jmat.Quaternion(c,-d*a.x/b,-d*a.y/b,-d*a.z/b)};Jmat.Quaternion.tan=function(a){var b=Jmat.Quaternion;return b.sin(a).div(b.cos(a))};
Jmat.Quaternion.asin=function(a){var b=0==a.absvsq()?Jmat.Quaternion.I:a.qvector().divr(a.absv());return b.mul(Jmat.Quaternion.asinh(a.mul(b))).neg()};Jmat.Quaternion.acos=function(a){return(0==a.absvsq()?Jmat.Quaternion.I:a.qvector().divr(a.absv())).mul(Jmat.Quaternion.acosh(a)).neg()};Jmat.Quaternion.atan=function(a){var b=0==a.absvsq()?Jmat.Quaternion.I:a.qvector().divr(a.absv());return b.conj().mul(Jmat.Quaternion.atanh(a.mul(b)))};
Jmat.Quaternion.sinh=function(a){a=Jmat.Quaternion.exp(a);var b=Jmat.Quaternion.inv(a);return a.sub(b).divr(2)};Jmat.Quaternion.cosh=function(a){a=Jmat.Quaternion.exp(a);var b=Jmat.Quaternion.inv(a);return a.add(b).divr(2)};Jmat.Quaternion.tanh=function(a){a=Jmat.Quaternion.exp(a);var b=Jmat.Quaternion.inv(a);return a.sub(b).div(a.add(b))};Jmat.Quaternion.asinh=function(a){return Jmat.Quaternion.log(a.add(Jmat.Quaternion.sqrt(a.mul(a).addr(1))))};Jmat.Quaternion.acosh=function(a){return Jmat.Quaternion.log(a.add(Jmat.Quaternion.sqrt(a.subr(1)).mul(Jmat.Quaternion.sqrt(a.addr(1)))))};
Jmat.Quaternion.atanh=function(a){return Jmat.Quaternion.log(a.addr(1).div(a.rsub(1))).mulr(.5)};Jmat.Quaternion.isReal=function(a){return 0==a.x&&0==a.y&&0==a.z};Jmat.Quaternion.isNaN=function(a){return isNaN(a.w)||isNaN(a.x)||isNaN(a.y)||isNaN(a.z)};Jmat.Quaternion.isInf=function(a){return Infinity==Math.abs(a.w)||Infinity==Math.abs(a.x)||Infinity==Math.abs(a.y)||Infinity==Math.abs(a.z)};Jmat.Quaternion.isInfOrNaN=function(a){return!a||Jmat.Quaternion.isNaN(a)||Jmat.Quaternion.isInf(a)};
Jmat.Quaternion.lambertwb=function(a,b){return Jmat.Complex.lambertwb_generic_(Jmat.Quaternion,a,b)};Jmat.Quaternion.lambertw=function(a){return Jmat.Quaternion.lambertwb(0,a)};Jmat.Quaternion.lambertwm=function(a){return Jmat.Quaternion.lambertwb(-1,a)};Jmat.Complex.hypergeometric0F1=function(a,b){var c=Jmat.Complex;if(c.isNegativeInt(a))return c(Infinity,Infinity);if(-80>b.re&&a.abssq()<b.abssq()/3){var d=c.gamma(a).divr(2*c.SQRTPI.re),e=c.sqrt(b.neg()),f=c.exp(e.muli(-2)).mul(e.muli(-1).pow(a.rsub(.5))),g=c.hypergeometric([a.subr(.5),a.rsub(1.5)],[],e.muli(4).inv().neg()),h=c.exp(e.muli(2)).mul(e.muli(1).pow(a.rsub(.5))),c=c.hypergeometric([a.subr(.5),a.rsub(1.5)],[],e.muli(4).inv());return d.mul(f.mul(g).add(h.mul(c)))}d=c.ONE;c=c.ZERO;for(f=
0;30>f;f++){0<f&&(d.eqr(0)||(d=d.div(a.addr(f-1))),d=d.mul(b).divr(f));if(d.eqr(0))break;c=c.add(d)}return c};Jmat.Complex.hypergeometric1F1_series_=function(a,b,c){for(var d=Jmat.Complex,e=a.div(b).mul(c).divr(1),d=d(1),f=1;200>f;f++){1<f&&(e=e.mul(a.addr(f-1)),e.eqr(0)||(e=e.div(b.addr(f-1))),e=e.mul(c),e=e.divr(f));if(e.eqr(0)||1E-28>e.abssq()/d.abssq())break;d=d.add(e)}return d};
Jmat.Complex.hypergeometric1F1_asymp_=function(a,b,c){var d=Jmat.Complex;if(d.isNegativeInt(b))return d(NaN);for(var e=d.ONE,f=d.ONE,g=d.ONE,h=d.ONE,k=1;30>k&&!(g=g.mul(a.addr(k-1)).mul(a.sub(b).addr(k)).divr(k).div(c.neg()),h=h.mul(b.sub(a).addr(k-1)).mul(a.rsub(k)).divr(k).div(c),e=e.add(g),f=f.add(h),1E-28>g.abssq()&&1E-28>h.abssq());k++);if(1E-10<g.abssq()||1E-10<h.abssq())return d(NaN);g=0>=c.arg()?-1:1;if(100>c.abs())return g=d.gammaDiv_(b,b.sub(a)).mul(d.exp(a.muli(g*Math.PI))).div(c.pow(a)),
a=d.gammaDiv_(b,a).mul(d.exp(c)).mul(c.pow(a.sub(b))),g.mul(e).add(a.mul(f));g=d.loggammaDiv_(b,b.sub(a)).add(a.muli(g*Math.PI)).sub(d.log(c).mul(a));a=d.loggammaDiv_(b,a).add(c).add(d.log(c).mul(a.sub(b)));return d.exp(g.add(d.log(e))).add(d.exp(a.add(d.log(f))))};
Jmat.Complex.hypergeometric1F1_rational_=function(a,b,c){var d=Jmat.Complex;c=c.neg();for(var e=c.mul(c),f=e.mul(c),g=b.mul(b.inc()),h=d(1),k=d(1).add(a.inc().mul(c).div(b).divr(2)),l=d(1).add(a.addr(2).mul(c).div(b.inc()).divr(2)).add(a.inc().mul(a.addr(2)).mul(e).div(g).divr(12)),m=a.mul(c).div(b),n=d(1),p=k.sub(m),r=a.addr(2).mul(c).div(b.inc()).divr(2).inc(),e=a.mul(a.inc()).mul(e).div(g).divr(2),m=l.sub(m.mul(r)).add(e),q,u,r=3;50>r;r++)g=2*r,u=a.rsub(r-2).div(b.addr(r-1).mulr(2*(g-3))),e=a.addr(r).mul(a.addr(r-
1)).div(b.addr(r-1).mul(b.addr(r-2)).mulr(4*(g-3)*(g-1))),q=a.addr(r-2).mul(a.addr(r-1)).mul(a.rsub(r-2)).div(b.addr(r-3).mul(b.addr(r-2)).mul(b.addr(r-1)).mulr(8*(g-3)*(g-3)*(g-5))).neg(),g=a.addr(r-1).mul(b.rsub(r-1)).div(b.addr(r-2).mul(b.addr(r-1)).mulr(2*(g-3))).neg(),u=u.mul(c).inc(),e=e.mul(c).add(g).mul(c),g=q.mul(f),q=m.mul(u).add(p.mul(e)).add(n.mul(g)),u=l.mul(u).add(k.mul(e)).add(h.mul(g)),n=p,p=m,m=q,h=k,k=l,l=u;a=p.div(k);b=q.div(u);d=1E-10<a.sub(b).abs()?d(NaN):b;return d};
Jmat.Complex.hypergeometric1F1=function(a,b,c){var d=Jmat.Complex;if(b.sub(a).abssq()<a.abssq())return d.hypergeometric1F1(b.sub(a),b,c.neg()).mul(d.exp(c));if(a.eq(b))return d.exp(c);if(d.isNegativeInt(b)&&!(d.isNegativeInt(a)&&a.re>=b.re))return d(Infinity);if(a.eqr(0)||c.eqr(0))return d(1);if(c.eqr(Infinity))return d(Infinity,Infinity);if(8>c.mul(a).div(b).abs())return d.hypergeometric1F1_series_(a,b,c);var e=d.hypergeometric1F1_asymp_(a,b,c);d.isNaN(e)&&(e=d.hypergeometric1F1_rational_(a,b,c));
return e};
Jmat.Complex.hypergeometric2F1=function(a,b,c,d){var e=Jmat.Complex;if(1.0001<d.abs()){var f=d.div(d.dec());if(.75>f.abs())return e.ONE.sub(d).pow(a.neg()).mul(e.hypergeometric2F1(a,c.sub(b),c,f));f=e.isNegativeIntOrZero;if(f(a)||f(b)||f(b)||e.isInt(a.sub(b))||f(c.sub(a))||f(c.sub(b)))a=a.addr(1E-8),b=b.subr(2E-8),c=c.addr(3E-8);var g=d.inv(),f=d.neg().pow(a.neg());d=d.neg().pow(b.neg());var h=e.gammaDiv22_(c,b.sub(a),b,c.sub(a)),k=e.gammaDiv22_(c,a.sub(b),a,c.sub(b)),l=e.hypergeometric2F1(a,e.ONE.sub(c).add(a),
e.ONE.sub(b).add(a),g);a=e.hypergeometric2F1(b,e.ONE.sub(c).add(b),e.ONE.sub(a).add(b),g);b=h.mul(f).mul(l);a=k.mul(d).mul(a);return b.add(a)}f=d.div(d.dec());if(f.abs()<d.abs())return e.ONE.sub(d).pow(a.neg()).mul(e.hypergeometric2F1(a,c.sub(b),c,f));f=30;.5<d.abs()&&(f=60);.75<d.abs()&&(f=100);k=a.mul(b).div(c).mul(d);g=e(1);for(h=1;h<f;h++){1<h&&(k=k.mul(a.addr(h-1)),k=k.mul(b.addr(h-1)),k.eqr(0)||(k=k.div(c.addr(h-1))),k=k.mul(d),k=k.divr(h));if(k.eqr(0))break;if(e.near(k,e.ZERO,1E-15))break;
g=g.add(k)}return g};Jmat.Complex.generalized_hypergeometric_=function(a,b,c){for(var d=c,e=0;e<a.length;e++)d=d.mul(a[e]);for(e=0;e<b.length;e++)d=d.div(b[e]);for(var f=Jmat.Complex(1),g=1;40>g;g++){if(1<g){for(e=0;e<a.length;e++)d=d.mul(a[e].addr(g-1));for(e=0;e<b.length;e++)d=d.eqr(0)?d:d.div(b[e].addr(g-1));d=d.mul(c);d=d.divr(g)}if(d.eqr(0))break;f=f.add(d)}return f};
Jmat.Complex.hypergeometric=function(a,b,c){return c.eqr(0)?Jmat.Complex(1):0==a.length&&0==b.length?Jmat.Complex.exp(c):1==a.length&&0==b.length?Jmat.Complex.pow(c.rsub(1),a[0].neg()):0==a.length&&1==b.length?Jmat.Complex.hypergeometric0F1(b[0],c):1==a.length&&1==b.length?Jmat.Complex.hypergeometric1F1(a[0],b[0],c):2==a.length&&1==b.length?Jmat.Complex.hypergeometric2F1(a[0],a[1],b[0],c):Jmat.Complex.generalized_hypergeometric_(a,b,c)};
Jmat.Complex.regularized_hypergeometric=function(a,b,c){for(var d=Jmat.Complex,e=d(1),f=!1,g=0;g<b.length;g++){if(!f&&d.isInt(b[g])&&0>=b[g].re){for(var f=[],h=[],k=0;k<a.length;k++)f[k]=d.isInt(a[k])?a[k].addr(1E-7):a[k];for(k=0;k<b.length;k++)h[k]=d.isInt(b[k])?b[k].addr(1E-7):b[k];a=f;b=h;f=!0}e=e.mul(d.gamma(b[g]))}return d.hypergeometric(a,b,c).div(e)};
Jmat.Complex.legendrep=function(a,b,c,d){var e=Jmat.Complex;if(b.eqr(0)&&e.isInt(a)&&0<=a.re){if(0==a.re)return e(1);if(1==a.re)return c;if(2==a.re)return c.mul(c).mulr(3).subr(1).divr(2)}d=d||2;if(!(1>d||3<d)){var f=c.addr(1).pow(b.divr(2));d=3==d?c.subr(1).pow(b.divr(2)):c.rsub(1).pow(b.divr(2));a=e.regularized_hypergeometric([a.neg(),a.addr(1)],[b.rsub(1)],c.rsub(1).divr(2));return f.div(d).mul(a)}};
Jmat.Complex.legendreq=function(a,b,c,d){var e=Jmat.Complex;d=d||2;if(!(1>d||3<d)){var f=function(a){if(0==a.im&&Jmat.Real.isInt(2*a.re)){var b=Jmat.Real.mod(Math.round(2*a.re),4);if(0==b)return e(1,0);if(1==b)return e(0,1);if(2==b)return e(-1,0);if(3==b)return e(0,-1)}return e.exp(a.muli(Math.PI))};if(3==d){d=a.add(b).addr(1);var g=e(Jmat.Real.SQRTPI).mul(e.gamma(d)),h=e(2).pow(a.addr(1)),f=f(b),k=c.pow(d);b=c.addr(1).pow(b.divr(2)).mul(c.subr(1).pow(b.divr(2)));a=e.regularized_hypergeometric([d.divr(2),
d.addr(1).divr(2)],[a.addr(1.5)],c.mul(c).inv());return g.div(h).mul(f).div(k).mul(b).mul(a)}e.isInt(b)&&(b=b.addr(1E-8));g=e(Math.PI).div(e.sin(b.mulr(Math.PI)).mulr(2));h=e.cos(b.mulr(Math.PI));f=e.legendrep(a,b,c,d);k=e.gammaDiv_(b.add(a).addr(1),e(1).sub(b).add(a));a=e.legendrep(a,b.neg(),c,d);return g.mul(h.mul(f).sub(k.mul(a)))}};
Jmat.Complex.loggamma=function(a){if(0>a.re){if(0==a.im&&a.re==Math.floor(a.re))return Jmat.Complex(NaN);var b=Jmat.Complex.log(Jmat.Complex.PI.div(Jmat.Complex.sin(Jmat.Complex.PI.mul(a))));Jmat.Complex.isInfOrNaN(b)&&(b=Jmat.Complex.log(Jmat.Complex.newi(2*Math.PI)).sub(Jmat.Complex.newi(-Math.PI).mul(0<a.im?a:a.neg())));return b.sub(Jmat.Complex.loggamma(Jmat.Complex.ONE.sub(a)))}if(1>a.im&&-1<a.im&&1>a.re&&0<=a.re)return Jmat.Complex.log(Jmat.Complex.gamma(a));b=Jmat.Complex(.918938533205);b=
b.add(Jmat.Complex.subr(a,.5).mul(Jmat.Complex.log(a)));b=b.sub(a);b=b.add(a.mulr(12).inv());b=b.sub(Jmat.Complex.powr(a,3).mulr(360).inv());b=b.add(Jmat.Complex.powr(a,5).mulr(1260).inv());b=b.sub(Jmat.Complex.powr(a,7).mulr(1680).inv());return b=b.add(Jmat.Complex.powr(a,9).mulr(1188).inv())};
Jmat.Complex.gamma_inv=function(a){if(Jmat.Complex.isPositive(a)&&.85<a.re)return a=Math.log((a.re+.036533814484900416)/Math.sqrt(2*Math.PI)),Jmat.Complex(a/Jmat.Real.lambertw(a/Math.E)+.5);var b=Jmat.Complex.finvert_newton(a,Jmat.Complex.gamma,function(a){return Jmat.Complex.gamma(a).mul(Jmat.Complex.digamma(a))});return Jmat.Complex.near(Jmat.Complex.gamma(b),a,.01)?b:Jmat.Complex(NaN)};
Jmat.Complex.digamma=function(a){var b=Jmat.Real.frac(a.re);if(.001>b||.999<b||.499<b&&.501>b){if(-98>a.re)return Jmat.Complex.loggamma(a.addr(3E-4)).sub(Jmat.Complex.loggamma(a.addr(1E-4))).divr(2E-4);b=Jmat.Complex.gamma(a.addr(1E-4)).sub(Jmat.Complex.gamma(a.subr(1E-4))).divr(2E-4).div(Jmat.Complex.gamma(a));return Jmat.Complex.isInfOrNaN(b)&&!Jmat.Complex.isInf(a)&&0!=a.im?Jmat.Complex.loggamma(a.addr(3E-4)).sub(Jmat.Complex.loggamma(a.addr(1E-4))).divr(2E-4):b}return Jmat.Complex.loggamma(a.addr(1E-4)).sub(Jmat.Complex.loggamma(a.subr(1E-4))).divr(2E-4)};
Jmat.Complex.trigamma=function(a){var b=Jmat.Real.frac(a.re);if(.001>b||.999<b||.499<b&&.501>b){var c=Jmat.Complex.gamma(a.addr(-2E-4)),b=Jmat.Complex.gamma(a.addr(-1E-4)),d=Jmat.Complex.gamma(a),e=Jmat.Complex.gamma(a.addr(1E-4));a=Jmat.Complex.gamma(a.addr(2E-4));c=c.sub(d).divr(2E-4).div(b);b=d.sub(a).divr(2E-4).div(e)}else c=Jmat.Complex.loggamma(a.addr(-2E-4)),b=Jmat.Complex.loggamma(a),d=Jmat.Complex.loggamma(a.addr(2E-4)),c=c.sub(b).divr(2E-4),b=b.sub(d).divr(2E-4);return c.sub(b).divr(2E-4)};
Jmat.Complex.polygamma=function(a,b){if(a.eqr(0))return Jmat.Complex.digamma(b);if(a.eqr(1))return Jmat.Complex.trigamma(b);var c=Jmat.Complex.hurwitzzeta(a.inc(),b);return Jmat.Complex(-1).pow(a.inc()).mul(Jmat.Complex.factorial(a)).mul(c)};
Jmat.Complex.incgamma_lower=function(a,b){if(0<b.re){var c=b.pow(a).div(a).mul(Jmat.Complex.hypergeometric1F1(a,a.inc(),b.neg()));if(!Jmat.Complex.isNaN(c))return c}for(var c=Jmat.Complex(0),d=Jmat.Complex(1),e=b.pow(a),f=1,g=5<b.abs()?50:30,h=0;h<g;h++)0<h&&(d/=h,f=-f,e=e.mul(b)),c=c.add(Jmat.Complex(f*d).mul(e).div(a.addr(h)));return c};Jmat.Complex.incgamma_upper=function(a,b){Jmat.Complex.isNegativeIntOrZero(a)&&(a=a.addr(1E-7));return Jmat.Complex.gamma(a).sub(Jmat.Complex.incgamma_lower(a,b))};
Jmat.Complex.gamma_p_cache_=[];Jmat.Complex.gamma_p=function(a,b){if(Jmat.Complex.isNegativeIntOrZero(a))return Jmat.Complex(1);var c=Jmat.Complex.calcCache_(a,Jmat.Complex.gamma,Jmat.Complex.gamma_p_cache_);return Jmat.Complex.incgamma_lower(a,b).div(c)};Jmat.Complex.gamma_q=function(a,b){return Jmat.Complex.isNegativeIntOrZero(a)?Jmat.Complex(0):Jmat.Complex.ONE.sub(Jmat.Complex.gamma_p(a,b))};
Jmat.Complex.gamma_p_inv_series_1_=function(a,b){var c=a.inc(),d=c.mul(c),e=a.addr(2),f=e.mul(e),g=a.mul(a),h=g.mul(a),k=h.mul(a),l=a.addr(3),m=a.addr(4),n=[0,1];n[2]=a.inc().inv();n[3]=a.mulr(3).addr(5).div(d.mul(e).mulr(2));n[4]=g.mulr(8).add(a.mulr(33)).addr(31).div(d.mul(c).mul(e).mul(l).mulr(3));n[5]=k.mulr(125).add(h.mulr(1179)).add(g.mulr(3971)).add(a.mulr(5661)).addr(2888).div(d.mul(d).mul(f).mul(l).mul(m).mulr(24));c=b.mul(Jmat.Complex.gamma(c)).pow(a.inv());return Jmat.Complex.powerSeries(n,
n.length,Jmat.Complex.ZERO,c)};Jmat.Complex.gamma_p_inv=function(a,b){return!Jmat.Complex.isReal(b)||!Jmat.Complex.isReal(a)||0>b.re||1<b.re||0>a.re?Jmat.Complex(NaN):Jmat.Complex.gamma_p_inv_series_1_(a,b)};Jmat.Complex.gamma_q_inva=function(a,b){return Jmat.Complex.rootfind_bisection(Jmat.Complex(0),Jmat.Complex(100),function(c){return Jmat.Complex.gamma_q(c,b).sub(a)})};
Jmat.Complex.gammaDiv_=function(a,b){var c=Jmat.Complex;if(a.eq(b))return c.ONE;if(c.isInfOrNaN(a)||c.isInfOrNaN(b))return c(NaN);if(c.isNegativeIntOrZero(b)&&(0<a.re||!c.isInt(a)))return c.ZERO;if(c.isInt(a)&&c.isInt(b)){if(0>=a.re&&0>=b.re){var d=Jmat.Real.isOdd(a.re-b.re)?-1:1;return c.gammaDiv_(b.rsub(1),a.rsub(1)).mulr(d)}if(0<a.re&&0<b.re&&16>Jmat.Real.dist(a.re,b.re)){if(a.re>b.re)for(var d=b.re,e=b.re+1;e<a.re;e++)d*=e;else for(d=1/a.re,e=a.re+1;e<b.re;e++)d/=e;return c(d)}}return c.gamma(a).div(c.gamma(b))};
Jmat.Complex.gammaDiv12_=function(a,b,c){var d=Jmat.Complex;return d.isNegativeIntOrZero(b)?d.isNegativeIntOrZero(c)&&(0<a.re||!d.isInt(a))?d.ZERO:d.gammaDiv_(a,b).div(d.gamma(c)):d.gammaDiv_(a,c).div(d.gamma(b))};Jmat.Complex.gammaDiv21_=function(a,b,c){var d=Jmat.Complex;return d.isNegativeIntOrZero(a)?d.gammaDiv_(a,c).mul(d.gamma(b)):d.gammaDiv_(b,c).mul(d.gamma(a))};
Jmat.Complex.gammaDiv22_=function(a,b,c,d){var e=Jmat.Complex;return e.isNegativeIntOrZero(a)==e.isNegativeIntOrZero(c)?e.gammaDiv_(a,c).mul(e.gammaDiv_(b,d)):e.gammaDiv_(a,d).mul(e.gammaDiv_(b,c))};
Jmat.Complex.loggammaDiv_=function(a,b){var c=Jmat.Complex;if(a.eq(b))return c.ZERO;if(c.isInfOrNaN(a)||c.isInfOrNaN(b))return c(NaN);if(c.isNegativeIntOrZero(b)&&(0<a.re||!c.isInt(a)))return c(-Infinity);if(c.isInt(a)&&c.isInt(b)&&0>=a.re&&0>=b.re){var d=Jmat.Real.isOdd(a.re-b.re)?-1:1,e=c.loggammaDiv_(b.rsub(1),a.rsub(1));-1==d&&(e=e.add(c.newi(Math.PI)));return e}return c.loggamma(a).sub(c.loggamma(b))};
Jmat.Complex.loggammaDiv12_=function(a,b,c){var d=Jmat.Complex;return d.isNegativeIntOrZero(b)?d.isNegativeIntOrZero(c)&&(0<a.re||!d.isInt(a))?d(-Infinity):d.loggammaDiv_(a,b).sub(d.loggamma(c)):d.loggammaDiv_(a,c).sub(d.loggamma(b))};Jmat.Complex.loggammaDiv21_=function(a,b,c){var d=Jmat.Complex;return d.isNegativeIntOrZero(a)?d.loggammaDiv_(a,c).add(d.loggamma(b)):d.loggammaDiv_(b,c).add(d.loggamma(a))};
Jmat.Complex.loggammaDiv2_=function(a,b,c,d){var e=Jmat.Complex;return e.isNegativeIntOrZero(a)==e.isNegativeIntOrZero(c)?e.loggammaDiv_(a,c).add(e.loggammaDiv_(b,d)):e.loggammaDiv_(a,d).add(e.loggammaDiv_(b,c))};Jmat.Complex.permutation=function(a,b){return Jmat.Complex.gammaDiv_(a.inc(),a.sub(b).inc())};
Jmat.Complex.binomial=function(a,b){if(Jmat.Complex.isPositiveIntOrZero(a)&&Jmat.Complex.isPositiveIntOrZero(b)&&b.re<=a.re&&30>a.re)return Jmat.Complex(Jmat.Real.pascal_triangle(a.re,b.re));var c=Jmat.Complex.gammaDiv12_(a.inc(),b.inc(),a.sub(b).inc());100<c.re&&Jmat.Complex.isPositiveInt(a)&&Jmat.Complex.isPositiveInt(b)&&a.re>b.re&&(c=Jmat.Complex.round(c));return c};
Jmat.Complex.stirling2=function(a,b){if(!Jmat.Complex.isInt(b))return Jmat.Complex(NaN);var c=Jmat.Complex.ZERO,d=Jmat.Real.isOdd(b.re)?-1:1,e=Jmat.Complex(0);for(e.re=0;e.re<=b.re;e.re++)c=c.add(Jmat.Complex.binomial(b,e).mul(e.pow(a)).mulr(d)),d*=-1;return c.div(Jmat.Complex.factorial(b))};Jmat.Complex.beta=function(a,b){return 50>a.re&&-50<a.re&&50>b.re&&-50<b.re?Jmat.Complex.gammaDiv21_(a,b,a.add(b)):Jmat.Complex.exp(Jmat.Complex.loggammaDiv21_(a,b,a.add(b)))};
Jmat.Complex.incbeta=function(a,b,c){if(a.eqr(1))return Jmat.Complex.beta(b,c);if(Jmat.Complex.isPositive(a)&&.75>a.re&&Jmat.Complex.isPositive(b)&&Jmat.Complex.isPositive(c)){c=Jmat.Complex.ONE.sub(c);for(var d,e,f=0;30>f;f++){0==f?(d=Jmat.Complex(1),e=Jmat.Complex(0)):(d=d.mul(c.addr(f-1)),d=d.mul(a),d=d.divr(f));if(d.eqr(0))break;e=e.add(d.div(b.addr(f)))}return a.pow(b).mul(e)}return a.pow(b).div(b).mul(Jmat.Complex.hypergeometric2F1(b,Jmat.Complex.ONE.sub(c),b.inc(),a))};
Jmat.Complex.beta_i=function(a,b,c){return Jmat.Complex.isNegativeIntOrZero(b)&&!Jmat.Complex.isNegativeIntOrZero(c)?Jmat.Complex(1):Jmat.Complex.isNegativeIntOrZero(c)&&!Jmat.Complex.isNegativeIntOrZero(b)?Jmat.Complex(0):Jmat.Complex.isNegativeIntOrZero(c.add(b))&&a.eqr(1)?Jmat.Complex(1):Jmat.Complex.incbeta(a,b,c).div(Jmat.Complex.beta(b,c))};
Jmat.Complex.beta_i_inv=function(a,b,c){if(!(Jmat.Complex.isPositiveOrZero(a)&&Jmat.Complex.isPositiveOrZero(b)&&Jmat.Complex.isPositiveOrZero(c)))return Jmat.Complex(NaN);for(var d=Jmat.Complex.beta(b,c),e=Jmat.Complex.ZERO,f=Jmat.Complex.ZERO,g=Jmat.Complex.ONE;!Jmat.Complex.near(f,g,1E-6);)e=f.add(g).divr(2),Jmat.Complex.incbeta(e,b,c).div(d).re>a.re?g=e:f=e;return e};
Jmat.Complex.bessel0big_=function(a){for(var b=Jmat.Complex,c=[-.0703125,.112152099609375,-.5725014209747314,.6074042001273483,-110.0171402692467,303.8090510922384,-118838.4262567832,625295.1493434797,-4.259392165047669E8,3.646840080706556E9,-3.833534661393944E12,4.854014686852901E13],d=[.0732421875,-.2271080017089844,1.727727502584457,-24.38052969955606,551.3358961220206,-18257.75547429318,832859.3040162893,-5.006958953198893E7,3.836255180230433E9,-3.649010818849833E11,4.218971570284096E13,-5827244631566907],
e=a.abs(),f=50<=e?8:35<=e?10:12,e=b.ONE,g=b(-.125).div(a),h=a.inv(),k=h.mul(h),l=b.ONE,m=0;m<f;m++)l=l.mul(k),e=e.add(l.mulr(c[m])),g=g.add(l.mul(h).mulr(d[m]));c=b.sqrt(a.mulr(Math.PI/2).inv());d=a.subr(.25*Math.PI);a=c.mul(e.mul(b.cos(d)).sub(g.mul(b.sin(d))));b=c.mul(e.mul(b.sin(d)).add(g.mul(b.cos(d))));return[a,b]};
Jmat.Complex.besselj0_=function(a){var b=Jmat.Complex;if(a.eqr(0))return b(1);0>a.re&&(a=a.neg());if(12>a.abs()){var c=b.ONE,b=b.ONE;a=a.mul(a);for(var d=1;40>=d&&!(b=b.mul(a).mulr(-.25/(d*d)),c=c.add(b),b.abssq()<1E-30*c.abssq());d++);return c}return Jmat.Complex.bessel0big_(a)[0]};
Jmat.Complex.bessely0_=function(a){var b=Jmat.Complex;if(a.eqr(0))return b(-Infinity);var c,d,e=0>a.re;e&&(a=a.neg());if(12>a.abs()){c=b.besselj0_(a);var f=0,g=b.ONE;d=b.ZERO;for(var h=a.mul(a),k=1;40>=k;k++){var f=f+1/k,g=g.mulr(-.25/(k*k)).mul(h),l=g.mulr(f);d=d.add(l);if(l.abssq()<1E-30*d.abssq())break}f=b(2/Math.PI);d=f.mul(b.log(a.divr(2)).add(b.EM)).mul(c).sub(f.mul(d))}else d=Jmat.Complex.bessel0big_(a),c=d[0],d=d[1];e&&(d=0>=a.im?d.add(b(0,2).mul(c)):d.sub(b(0,2).mul(c)));return d};
Jmat.Complex.bessel1big_=function(a){for(var b=Jmat.Complex,c=[.1171875,-.144195556640625,.6765925884246826,-6.883914268109947,121.5978918765359,-3302.272294480852,127641.2726461746,-6656367.718817688,4.502786003050393E8,-3.83385752074279E10,4.011838599133198E12,-5.060568503314727E14],d=[-.1025390625,.2775764465332031,-1.993531733751297,27.24882731126854,-603.8440767050702,19718.37591223663,-890297.8767070678,5.310411010968522E7,-4.043620325107754E9,3.827011346598605E11,-4.406481417852278E13,6065091351222699],
e=a.abs(),f=50<=e?8:35<=e?10:12,e=b.ONE,g=b(.375).div(a),h=a.inv(),k=h.mul(h),l=b.ONE,m=0;m<f;m++)l=l.mul(k),e=e.add(l.mulr(c[m])),g=g.add(l.mul(h).mulr(d[m]));c=b.sqrt(a.mulr(Math.PI/2).inv());d=a.subr(.75*Math.PI);a=c.mul(e.mul(b.cos(d)).sub(g.mul(b.sin(d))));b=c.mul(e.mul(b.sin(d)).add(g.mul(b.cos(d))));return[a,b]};
Jmat.Complex.besselj1_=function(a){var b=Jmat.Complex;if(a.eqr(0))return b(0);var c,d=0>a.re;d&&(a=a.neg());if(12>a.abs()){for(var b=c=b.ONE,e=a.mul(a),f=1;40>=f&&!(b=b.mul(e).mulr(-.25/(f*(f+1))),c=c.add(b),b.abssq()<1E-30*c.abssq());f++);c=c.mul(a).mulr(.5)}else c=Jmat.Complex.bessel1big_(a)[0];d&&(c=c.neg());return c};
Jmat.Complex.bessely1_=function(a){var b=Jmat.Complex;if(a.eqr(0))return b(-Infinity);var c,d,e=0>a.re;e&&(a=a.neg());if(12>a.abs()){c=b.besselj1_(a);d=0;for(var f=b.ONE,g=b.ONE,h=a.mul(a),k=1;40>=k;k++){d+=1/k;var f=f.mulr(-.25/(k*(k+1))).mul(h),l=f.mulr(2*d+1/(k+1)),g=g.add(l);if(l.abssq()<1E-30*g.abssq())break}d=b(2/Math.PI).mul(b.log(a.divr(2)).add(b.EM).mul(c).sub(a.inv()).sub(a.mul(g).mulr(.25)))}else d=Jmat.Complex.bessel1big_(a),c=d[0],d=d[1];e&&(d=0>=a.im?d.add(b(0,2).mul(c)).neg():d.sub(b(0,
2).mul(c)).neg());return d};Jmat.Complex.bessel_sqrt_=function(a){return Jmat.Complex.isNegative(a)?Jmat.Complex.sqrt(a).neg():Jmat.Complex.sqrt(a)};Jmat.Complex.bessel_sqrt2piz_=function(a){return Jmat.Complex.bessel_sqrt_(a.rdiv(2/Math.PI))};
Jmat.Complex.besselj_miller_=function(a,b){if(b.eqr(0))return Jmat.Complex(0);if(a.eqr(1))return Jmat.Complex.besselj1_(b);if(a.re<b.abs()/4){for(var c=Jmat.Complex.besselj0_(b),d=Jmat.Complex.besselj1_(b),e=1;e<a.re;e++)var f=d.mulr(2*e).div(b).sub(c),c=d,d=f;return d}for(var c=Jmat.Complex.besselj0_(b),g=Jmat.Complex(1),h=Jmat.Complex.ZERO,e=Math.ceil(Math.max(b.abs(),a.abs())),e=a.re+e;0<e;e--)f=g.mulr(2*e).div(b).sub(h),h=g,g=f,e-1==a.re&&(d=f);c=c.div(g);return d.mul(c)};
Jmat.Complex.besselj_series_=function(a,b){var c=Jmat.Complex,d=c.isNegativeInt(a);d&&(a=a.neg());for(var e=c(0),f=1,g=c.gamma(a.inc()),h=0;50>h;h++)var k=c(h+1),l=c.gamma(k).mul(g),l=c(f).div(l).mul(b.divr(2).pow(c(2*h).add(a))),f=-f,e=e.add(l),g=g.mul(a.add(k));d&&Jmat.Real.isOdd(a.re)&&(e=e.neg());return e};
Jmat.Complex.besselj_hankelexpansion_=function(a,b){var c=Jmat.Complex,d=Math.PI,e,f=3<Math.abs(b.arg());f&&(b=b.neg());e=Jmat.Complex.ONE;for(var g=c.ONE,h=b.sub(a.mulr(d/2)).subr(d/4),k=c.ZERO,l=c.ZERO,m=a.mul(a).mulr(4),n=Math.max(4,Math.min(60,Math.abs(a.re))),p,r=0;r<n;r++){0<r&&(p=m.subr((2*r-1)*(2*r-1)),e=e.mul(p).divr(8*r),g=g.mul(b));p=2>r%4?1:-1;p=e.div(g).mulr(p);if(1E-28>p.abssq())break;0==r%2?l=l.add(p):k=k.add(p)}if(.01<p.abssq())return c(NaN);l=c.cos(h).mul(l);k=c.sin(h).mul(k);e=c.bessel_sqrt2piz_(b).mul(l.sub(k));
f&&(e=e.mul(c.exp(a.muli(d))));return e};Jmat.Complex.besselj_hypergeom_=function(a,b){var c=Jmat.Complex,d=1;c.isNegativeInt(a)&&(c.isOdd(a)&&(d=-1),a=a.neg());c.isNegativeInt(a.addr(.5))&&(a=5>a.abssq()?a.addr(1E-12):a.addr(1E-5));var e=c.hypergeometric1F1(a.addr(.5),a.mulr(2).inc(),b.muli(2)),f=c.log(b.mulr(.5)).mul(a).sub(c.loggamma(a.inc())).add(b.muli(-1));return c.exp(f.add(c.log(e))).mulr(d)};
Jmat.Complex.besselj_large_nu_=function(a,b){var c=Jmat.Complex,d=c.bessel_sqrt2piz_(a).divr(2),c=c.E.mul(b).div(a).divr(2);return d.mul(c.pow(a))};
Jmat.Complex.besselj=function(a,b){var c=Jmat.Complex;return c.isInf(a)||c.isInf(b)?c(0):b.eqr(0)?0==a.re?0==a.im?c(1):c(NaN):0>a.re?c(Infinity,Infinity):c(0):a.eqr(0)?c.besselj0_(b):a.eqr(1)?c.besselj1_(b):a.eqr(.5)?c.bessel_sqrt2piz_(b).mul(c.sin(b)):a.eqr(-.5)?c.bessel_sqrt2piz_(b).mul(c.cos(b)):300<a.re&&Math.abs(a.im)<a.re&&2500>b.abssq()||-300>a.re&&c.isInt(a)&&2500>b.abssq()?c(0):50<a.re&&c.isReal(b)&&a.re>16*b.abs()?Jmat.Complex.besselj_large_nu_(a,b):c.isInt(a)&&50>Math.abs(a.re)?0>a.re?
c.besselj_miller_(a.neg(),b).mulr(c.isOdd(a)?-1:1):c.besselj_miller_(a,b):25>b.abs()?c.besselj_series_(a,b):b.abssq()>a.abssq()?c.besselj_hankelexpansion_(a,b):a.re>2*b.abs()?Jmat.Complex.besselj_large_nu_(a,b):c.besselj_hypergeom_(a,b)};Jmat.Complex.bessely_miller_=function(a,b){for(var c=Jmat.Complex.bessely0_(b),d=Jmat.Complex.bessely1_(b),e=1;e<a.re;e++)var f=d.mulr(2*e).div(b).sub(c),c=d,d=f;return d};
Jmat.Complex.bessely_with_besselj_=function(a,b){var c=Jmat.Complex;if(c.isInt(a.addr(.5)))return c.besselj(a.neg(),b).mulr(c.isOdd(a.addr(.5))?-1:1);var d=c.besselj(a,b),e=c.cos(a.mulr(Math.PI));c.isInt(e.addr(.5))&&(e=c(0));var f=c.besselj(a.neg(),b),c=c.sin(a.mulr(Math.PI));return d.mul(e).sub(f).div(c)};
Jmat.Complex.bessely_hankelexpansion_=function(a,b){var c=Jmat.Complex,d=Math.PI,e=3<Math.abs(b.arg());e&&(b=b.neg());for(var f=Jmat.Complex.ONE,g=c.ONE,h=b.sub(a.mulr(d/2)).subr(d/4),k=c.ZERO,l=c.ZERO,m=a.mul(a).mulr(4),n=Math.max(4,Math.min(60,Math.abs(a.re))),p,r=0;r<n;r++){0<r&&(p=m.subr((2*r-1)*(2*r-1)),f=f.mul(p).divr(8*r),g=g.mul(b));p=2>r%4?1:-1;p=f.div(g).mulr(p);if(1E-28>p.abssq())break;0==r%2?l=l.add(p):k=k.add(p)}if(.01<p.abssq())return c(NaN);l=c.sin(h).mul(l);k=c.cos(h).mul(k);f=c.bessel_sqrt2piz_(b).mul(l.add(k));
e&&(e=c.besselj(a,b),f=f.mul(c.exp(a.muli(-d))).add(c.cos(a.mulr(d)).mul(e).muli(2)));return f};
Jmat.Complex.bessely=function(a,b){var c=Jmat.Complex;if(c.isInf(a))return c.isInf(b)?c(NaN):c.isPositive(b)?c(-Infinity):c(Infinity,Infinity);if(c.isInf(b))return c(0);if(b.eqr(0))return 0==a.re?0==a.im?c(-Infinity):c(NaN):c(Infinity,Infinity);if(a.eqr(0))return c.bessely0_(b);if(a.eqr(1))return c.bessely1_(b);if(c.isInt(a)){var d=0>b.re;d&&(b=b.neg());var e;e=0>a.re?c.bessely_miller_(a.neg(),b).mulr(c.isOdd(a)?-1:1):c.bessely_miller_(a,b);d&&(d=c.besselj(a,b),e=0>=b.im?e.add(c(0,2).mul(d)):e.sub(c(0,
2).mul(d)),c.isOdd(a)&&(e=e.neg()));return e}return 20>b.abs()?c.bessely_with_besselj_(a,b):b.abssq()>a.abssq()?c.bessely_hankelexpansion_(a,b):c(NaN)};Jmat.Complex.hankelh1=function(a,b){var c=Jmat.Complex;return c.isInf(a)?c(Infinity,Infinity):c.isInf(b)?c(0):b.eqr(0)?0==a.re&&0!=a.im?c(NaN):c(Infinity,Infinity):0>a.im?c.exp(a.mul(c.newi(-Math.PI))).mul(c.hankelh1(a.neg(),b)):c.besselj(a,b).add(c.bessely(a,b).mul(c.I))};
Jmat.Complex.hankelh2=function(a,b){var c=Jmat.Complex;return c.isInf(a)?c(Infinity,Infinity):c.isInf(b)?c(0):b.eqr(0)?0==a.re&&0!=a.im?c(NaN):c(Infinity,Infinity):0<a.im?c.exp(a.mul(c.newi(Math.PI))).mul(c.hankelh2(a.neg(),b)):c.besselj(a,b).sub(c.bessely(a,b).mul(c.I))};
Jmat.Complex.besseli=function(a,b){var c=Jmat.Complex;if(c.isInf(a))return c.isInf(b)?c(NaN):c(0);if(b.eqr(Infinity))return c(Infinity);if(c.isInf(b))return c(Infinity,Infinity);if(b.eqr(0))return 0==a.re?0==a.im?c(1):c(NaN):0>a.re?c(Infinity,Infinity):c(0);c=c.I.pow(a.neg()).mul(c.besselj(a,b.mul(c.I)));0==b.im&&0==a.im&&Jmat.Real.near(c.im,0,1E-10)&&(c.im=0);return c};
Jmat.Complex.besselk=function(a,b){var c=Jmat.Complex;if(c.isInf(a))return c.isInf(b)?c(NaN):c.isPositive(b)?c(Infinity):c(Infinity,Infinity);if(b.eqr(Infinity))return c(0);if(c.isInf(a))return c(Infinity,Infinity);if(b.eqr(0))return 0==a.re?0==a.im?c(Infinity):c(NaN):c(Infinity,Infinity);c=0<=b.im?c.I.pow(a.inc()).mulr(Math.PI/2).mul(c.hankelh1(a,c.I.mul(b))):c.newi(-1).pow(a.inc()).mulr(Math.PI/2).mul(c.hankelh2(a,c.newi(-1).mul(b)));0==b.im&&0==a.im&&Jmat.Real.near(c.im,0,.001)&&(c.im=0);return c};
Jmat.Complex.spherical_besselj=function(a,b){var c=Jmat.Complex,d=c.sqrt(c(Math.PI/2).div(b)),c=c.besselj(a.addr(.5),b);return d.mul(c)};Jmat.Complex.spherical_bessely=function(a,b){var c=Jmat.Complex,d=c.sqrt(c(Math.PI/2).div(b)),c=c.bessely(a.addr(.5),b);return d.mul(c)};Jmat.Complex.spherical_hankelh1=function(a,b){var c=Jmat.Complex,d=c.sqrt(c(Math.PI/2).div(b)),c=c.hankelh1(a.addr(.5),b);return d.mul(c)};
Jmat.Complex.spherical_hankelh2=function(a,b){var c=Jmat.Complex,d=c.sqrt(c(Math.PI/2).div(b)),c=c.hankelh2(a.addr(.5),b);return d.mul(c)};
Jmat.Complex.struveh=function(a,b){var c=Jmat.Complex;if(30<c.abs(b)&&50>c.abs(b)){var d=b.divr(2).pow(a.addr(1)),e=c.regularized_hypergeometric([c(1)],[c(1.5),a.addr(1.5)],b.mul(b).divr(-4));return d.mul(e)}if(30<c.abs(b)){for(var d=c(.5),e=c.gamma(d),f=a.addr(.5),g=c.gamma(f),h=c(1),k=b.mul(b).divr(4),l=c=c(0),m=0;30>m;m++){c=c.add(e.div(g).div(h));if(c.eq(l))break;l=c;e=e.mul(d);d=d.addr(1);f=f.subr(1);g=g.div(f);h=h.mul(k)}d=b.mulr(.5).pow(a.subr(1)).divr(Math.PI);return d.mul(c)}for(var d=c(1.5),
e=c.gamma(d),f=c(a.addr(1.5)),g=c.gamma(f),n=c(1),h=c(1),k=b.mul(b).divr(4),l=c=c(0),m=0;100>m;m++){c=c.add(n.mul(h).div(e).div(g));if(c.eq(l))break;l=c;e=e.mul(d);g=g.mul(f);d=d.addr(1);f=f.addr(1);n=n.neg();h=h.mul(k)}d=b.mulr(.5).pow(a.addr(1));return d.mul(c)};Jmat.Complex.struvek=function(a,b){var c=Jmat.Complex;return c.struveh(a,b).sub(c.bessely(a,b))};Jmat.Complex.struvel=function(a,b){var c=Jmat.Complex;return c.exp(a.muli(.5*-Math.PI)).muli(-1).mul(c.struveh(a,b.muli(1)))};
Jmat.Complex.struvem=function(a,b){var c=Jmat.Complex;return c.struvel(a,b).sub(c.besseli(a,b))};Jmat.Complex.angerj=function(a,b){var c=Jmat.Complex;return c.integrate(c(0),c(Math.PI),function(d){return c.cos(a.mul(d).sub(b.mul(c.sin(d))))}).divr(Math.PI)};Jmat.Complex.webere=function(a,b){var c=Jmat.Complex;return c.integrate(c(0),c(Math.PI),function(d){return c.sin(a.mul(d).sub(b.mul(c.sin(d))))}).divr(Math.PI)};
Jmat.Complex.airyloop_=function(a,b,c,d){for(var e=1.3541179394264005,f=.8929795115692493,g=a.mul(a).mul(a),h=Jmat.Complex.ONE,k=1,l=Jmat.Complex.ZERO,m=0;30>m;m++){0<m&&(k*=m,e*=m+2/3-1,f*=m+4/3-1,b/=9,c/=9,h=h.mul(g),a=a.mul(g));var n=h.mulr(b/k/e),p=a.mulr(c/k/f);if(Jmat.Complex.isNaN(n)||Jmat.Complex.isNaN(p))break;if(n.eqr(0)&&p.eqr(0))break;l=l.add(n).add(p.mulr(d))}return l};
Jmat.Complex.airy=function(a){if(8<a.abs()){if(Math.abs(a.arg())<2*Math.PI/3){var b=a.powr(.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.exp(a.neg()).div(b.mulr(2))}a=a.neg();b=a.powr(.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.sin(a.addr(Math.PI/4)).div(b)}return Jmat.Complex.airyloop_(a,Math.pow(3,-2/3),Math.pow(3,-4/3),-1)};
Jmat.Complex.bairy=function(a){if(10<a.abs()){if(Math.abs(a.arg())<Math.PI/3){var b=a.powr(.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.exp(a).div(b)}a=a.neg();b=a.powr(.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.cos(a.addr(Math.PI/4)).div(b)}return Jmat.Complex.airyloop_(a,Math.pow(3,-1/6),Math.pow(3,-5/6),1)};
Jmat.Complex.airy_deriv_loop_=function(a,b,c,d){var e=2.6789385347077475,f=.9027452929509336,g=a.mul(a).mul(a),h=Jmat.Complex.ONE;a=a.mul(a);for(var k=1,l=Jmat.Complex.ZERO,m=0;30>m;m++){0<m&&(k*=m,e*=m+1/3-1,f*=m+5/3-1,b/=9,c/=9,h=h.mul(g),a=a.mul(g));var n=h.mulr(b/k/e),p=a.mulr(c/k/f);if(Jmat.Complex.isNaN(n)||Jmat.Complex.isNaN(p))break;if(n.eqr(0)&&p.eqr(0))break;l=l.add(n.mulr(d)).add(p)}return l};
Jmat.Complex.airy_deriv=function(a){if(8<a.abs()){if(Math.abs(a.arg())<2*Math.PI/3){var b=a.powr(-.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.exp(a.neg()).div(b.mulr(2)).neg()}a=a.neg();b=a.powr(-.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.cos(a.addr(Math.PI/4)).div(b).neg()}return Jmat.Complex.airy_deriv_loop_(a,Math.pow(3,-1/3),Math.pow(3,-5/3),-1)};
Jmat.Complex.bairy_deriv=function(a){if(10<a.abs()){if(Math.abs(a.arg())<Math.PI/3){var b=a.powr(-.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.exp(a).div(b)}a=a.neg();b=a.powr(-.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.sin(a.addr(Math.PI/4)).div(b)}return Jmat.Complex.airy_deriv_loop_(a,Math.pow(3,1/6),Math.pow(3,-7/6),1)};
Jmat.Complex.zetaint_=function(a){for(var b=function(a,b){var c=Jmat.Complex.sin(a.mul(Jmat.Complex.atan(b))),d=b.mul(b).inc().pow(a.divr(2)),e=Jmat.Complex.exp(b.mulr(2*Math.PI)).dec();b=d.mul(e);return c.eq(b)?Jmat.Complex.ONE:c.div(b)},c=Jmat.Complex.ONE;;){var d=b(a,c);if(1E-4>d.abssq()&&1E-4>d.abssq())break;if(1E3<c.re)break;c=c.mulr(2)}for(var c=c.re,d=.01,e=Jmat.Complex.ZERO,f=0;f<c;f+=d)var g=b(a,Jmat.Complex(f)).mulr(d),e=e.add(g),d=1.01*d;return e.mulr(2).addr(.5).add(a.dec().inv())};
Jmat.Complex.zeta=function(a){if(a.eq(Jmat.Complex.ZERO))return Jmat.Complex(-.5);if(a.eqr(-1))return Jmat.Complex(-1/12);if(a.eqr(1))return Jmat.Complex(Infinity);if(a.eqr(3))return Jmat.Complex(1.202056903159594);if(Infinity==a.re)return Jmat.Complex(1);if(Jmat.Complex.isEven(a)&&0>a.re)return Jmat.Complex(0);var b=a.dec().abs();if(10>b){var c=a.dec(),d=c.inv();a=Jmat.Complex.ONE;for(var e=5>b?10:30,b=0;b<e;b++)d=d.add(Jmat.Complex(Jmat.Complex.stieltjes_zeta[b]).mul(a)),a=a.mul(c);return d}if(5<=
a.re){d=Jmat.Complex(0);for(b=1;32>b;b++)d=d.add(Jmat.Complex(b).pow(a).inv());return d}if(.5<=a.re){if(Jmat.Complex.near(a,Jmat.Complex(1,18.125),.1))return Jmat.Complex.zetaint_(a);d=Jmat.Complex(0);c=Jmat.Complex.TWO.pow(Jmat.Complex.ONE.sub(a));c=Jmat.Complex.ONE.div(Jmat.Complex.ONE.sub(c));for(b=e=1;128>b;b++)var f=Jmat.Complex(e).div(Jmat.Complex(b).pow(a)),d=d.add(f),e=-e;return d.mul(c)}b=Jmat.Complex.ONE.sub(a);c=Jmat.Complex.TWO.pow(a);d=Jmat.Complex.PI.pow(a.subr(1));a=Jmat.Complex.sin(a.mulr(Math.PI/
2));e=Jmat.Complex.gamma(b);b=Jmat.Complex.zeta(b);return c.mul(d).mul(a).mul(e).mul(b)};
Jmat.Complex.eta=function(a){if(.5>a.re){a=a.neg();var b=Jmat.Complex.ONE.sub(Jmat.Complex.TWO.pow(a.neg().subr(1))),c=Jmat.Complex.ONE.sub(Jmat.Complex.TWO.pow(a.neg())),b=b.div(c).mulr(2).mul(Jmat.Complex.PI.pow(a.neg().subr(1))),d=Jmat.Complex.sin(Jmat.Complex.PI.mul(a).divr(2)),c=Jmat.Complex.gamma(a),e=Jmat.Complex.eta(a.inc());return b.mul(a).mul(d).mul(c).mul(e)}for(var d=function(a,b){for(var c=0,d=0;d<=a;d++)var e=Jmat.Real.factorial(b+d-1)/Jmat.Real.factorial(b-d),f=Math.pow(4,d)/Jmat.Real.factorial(2*
d),c=c+e*f;return c*b},e=d(50,50),f=Jmat.Complex(0),g=Jmat.Complex(1),h=0;50>h;h++)b=g.mulr(d(h,50)-e),c=Jmat.Complex(h+1).pow(a),f=f.add(b.div(c)),g=g.neg();return f.mulr(-1/e)};Jmat.Complex.lambda=function(a){return Jmat.Complex.ONE.sub(Jmat.Complex.TWO.pow(a.neg())).mul(Jmat.Complex.zeta(a))};Jmat.Complex.hurwitzzeta_generate_hasse_table_=function(a){for(var b=[],c=0;c<a;c++){b[c]=0;for(var d=1,e=0;e<=c;e++)b[e]+=d*Jmat.Real.pascal_triangle(c,e)/(c+1),d=-d}return b};
Jmat.Complex.hurwitzzeta_hasse_tables_=[];Jmat.Complex.hurwitzzeta_hasse_series_=function(a,b){Jmat.Complex.hurwitzzeta_hasse_tables_[30]||(Jmat.Complex.hurwitzzeta_hasse_tables_[30]=Jmat.Complex.hurwitzzeta_generate_hasse_table_(30));for(var c=Jmat.Complex.hurwitzzeta_hasse_tables_[30],d=Jmat.Complex.ZERO,e=0;30>e;e++)d=d.add(b.addr(e).pow(Jmat.Complex.ONE.sub(a)).mulr(c[e]));return d=d.mul(a.dec().inv())};
Jmat.Complex.hurwitzzeta_cos_series_=function(a,b){for(var c=a.rsub(1),d=Jmat.Complex.gamma(c).mulr(2).div(Jmat.Complex(2*Math.PI).pow(c)),e=Jmat.Complex.ZERO,f=1;30>f;f++)var g=Jmat.Complex.cos(c.mulr(Math.PI/2).sub(b.mulr(2*Math.PI*f))),e=e.add(g.div(Jmat.Complex(f).pow(c)));return e.mul(d)};Jmat.Complex.hurwitzzeta_simple_series_=function(a,b){if(Jmat.Complex.isNegativeIntOrZero(b))return Jmat.Complex(Infinity);for(var c=Jmat.Complex.ZERO,d=0;30>d;d++)var e=b.addr(d).pow(a).inv(),c=c.add(e);return c};
Jmat.Complex.hurwitzzeta_euler_=function(a,b){for(var c=b.addr(25).pow(a).inv(),d=a.dec().inv().mul(b.addr(25).pow(a.dec()).inv()),e=Jmat.Complex.ZERO,f=0;25>f;f++)var g=b.addr(f).pow(a).inv(),e=e.add(g);for(var g=a,h=1,k=Jmat.Complex.ZERO,f=1;15>=f;f++)var h=2*h*(2*f-1)*f,g=g.mul(a.addr(2*f-1)).mul(a.addr(2*f)),l=g.div(b.addr(25).pow(a.addr(2*f+1))).neg(),k=k.add(l.mulr(Jmat.Complex.bernoulli[2*f]/h));return e.sub(k).add(c.divr(2)).add(d)};
Jmat.Complex.hurwitzzeta=function(a,b){if(a.eqr(0))return Jmat.Complex(.5).sub(b);if(a.eqr(-1))return Jmat.Complex(-1/12).add(b.mulr(.5)).add(b.mul(b).mulr(-.5));if(b.eqr(1))return Jmat.Complex.zeta(a);if(2<a.re&&0<b.re)return Jmat.Complex.hurwitzzeta_simple_series_(a,b);if(0<=a.re&&-10<b.re)return Jmat.Complex.hurwitzzeta_euler_(a,b);if(0>a.re&&0==b.im&&0<b.re&&1>=b.re)return Jmat.Complex.hurwitzzeta_cos_series_(a,b);if(2<b.re)return Jmat.Complex.hurwitzzeta_hasse_series_(a,b);if(-40<b.re&&!b.eqr(0)){var c=
0>a.re&&0==b.im?Math.ceil(-b.re):Math.ceil(2-b.re+.5),d=Jmat.Complex.ZERO;if(0<c)for(var e=0;e<c;e++){var f=b.addr(e).pow(a).inv();Jmat.Complex.isNaN(f)||(d=d.add(f))}else for(e=0;e<-c;e++)f=b.addr(e).addr(c).pow(a).inv(),Jmat.Complex.isNaN(f)||(d=d.add(f));e=Jmat.Complex.hurwitzzeta(a,b.addr(c));return 0<c?e.add(d):e.sub(d)}return Jmat.Complex(NaN)};Jmat.Complex.lerchphi_pow_=function(a,b,c){return c?a.mul(a).pow(b.divr(2)):a.pow(b)};
Jmat.Complex.lerchphi_generate_binomial_table_=function(a,b,c,d){for(var e=Jmat.Complex,f=[],g=0;g<c;g++){f[g]=e(0);for(var h=1,k=0;k<=g;k++){var l=e.lerchphi_pow_(b.addr(k),a,d);f[g]=f[g].add(l.inv().mulr(h*Jmat.Real.pascal_triangle(g,k)));h=-h}}return f};Jmat.Complex.lerchphi_binomial_table_a_=void 0;Jmat.Complex.lerchphi_binomial_table_s_=void 0;Jmat.Complex.lerchphi_binomial_table_var_=void 0;Jmat.Complex.lerchphi_binomial_table_=void 0;
Jmat.Complex.lerchphi_binomial_series_=function(a,b,c,d){var e=Jmat.Complex;e.lerchphi_binomial_table_&&e.lerchphi_binomial_table_a_.eq(c)&&e.lerchphi_binomial_table_s_.eq(b)&&e.lerchphi_binomial_table_var_==!!d||(e.lerchphi_binomial_table_=e.lerchphi_generate_binomial_table_(b,c,30),e.lerchphi_binomial_table_a_=c,e.lerchphi_binomial_table_s_=b,e.lerchphi_binomial_table_var_=!!d);b=a.neg().div(a.rsub(1));c=e.lerchphi_binomial_table_;d=e.ZERO;for(var f=e(1),g=0;30>g;g++){var h=d.add(f.mul(c[g]));if(e.near(h,
d,1E-15))break;d=h;f=f.mul(b)}return d=d.mul(a.rsub(1).inv())};Jmat.Complex.lerchphi_series_=function(a,b,c,d){for(var e=Jmat.Complex,f=e(0),g=e(1),h=0;30>h;h++){var k=e.lerchphi_pow_(c.addr(h),b,d),k=g.div(k);if(e.near(f.add(k),f,1E-15))break;f=f.add(k);g=g.mul(a)}return f};
Jmat.Complex.lerchphi_integral_=function(a,b,c,d){var e=Jmat.Complex;if(1>c.re){if(e.isNegativeIntOrZero(c))return e(Infinity,Infinity);var f=Math.ceil(1-c.re);if(1E3<f)return e(NaN);for(var g=e(0),h=e(1),k=0;k<f;k++)g=g.add(h.div(e.lerchphi_pow_(c.addr(k),b))),h=h.mul(a);return h.mul(e.lerchphi(a,b,c.addr(f),d)).add(g)}a.eqr(1)&&(a=e(1.0000000000001));var l=e.log(a);d=c.pow(b).mulr(2).inv();f=e.incgamma_upper(b.rsub(1),c.mul(l).neg());d=d.add(f.mul(l.neg().pow(b.subr(1))).div(a.pow(c)));a=e.integrate(e(0),
e(Infinity),function(a){var d=e.sin(e.atan(a.div(c)).mul(b).sub(a.mul(l))),f=c.mul(c).add(a.mul(a)).pow(b.divr(2));a=e.expm1(a.mulr(2*Math.PI));return d.div(f).div(a)},30,1).mulr(2);return d=d.add(a)};Jmat.Complex.lerchphi=function(a,b,c,d){var e=Jmat.Complex;return.75>a.abs()?Jmat.Complex.lerchphi_series_(a,b,c,d):e.lerchphi_integral_(a,b,c,d)};Jmat.Complex.PIPI6_=Jmat.Complex(Math.PI*Math.PI/6);
Jmat.Complex.dilog=function(a){if(a.eqr(0))return Jmat.Complex.ZERO;if(a.eqr(1))return Jmat.Complex.PIPI6_;if(a.eqr(Infinity)||a.eqr(-Infinity))return Jmat.Complex(-Infinity);var b=function(a){for(var b=Jmat.Complex.ZERO,d=a,e=.5>=c?30:50,f=1;f<e;f++){var g=d.divr(f*f),b=b.add(g);if(Jmat.Complex.near(g,Jmat.Complex.ZERO,1E-15))break;d=d.mul(a)}return b},c=a.abs();if(.5>c)return b(a);if(.5>1/c)return b=b(a.inv()).neg(),a=Jmat.Complex.log(a.neg()),b.sub(a.mul(a).divr(2)).sub(Jmat.Complex.PIPI6_);var d=
Jmat.Complex.ONE.sub(a),e=d.abs(),f=Jmat.Complex.ONE.sub(a).inv(),g=f.abs(),h=a.div(a.dec()),k=h.abs(),l=c,m=0;1/c<l&&(l=1/c,m=1);e<l&&(l=e,m=2);g<l&&(l=g,m=3);k<l&&(l=k,m=4);if(.8>l){if(0==m)return b(a);if(1==m)return b=b(a.inv()).neg(),a=Jmat.Complex.log(a.neg()),b.sub(a.mul(a).divr(2)).sub(Jmat.Complex.PIPI6_);if(2==m)return b=b(d).neg(),d=Jmat.Complex.log(d),a=Jmat.Complex.log(a),b.sub(d.mul(a)).add(Jmat.Complex.PIPI6_);if(3==m)return b=b(f),d=Jmat.Complex.log(Jmat.Complex.ONE.sub(a)),a=Jmat.Complex.log(a.neg()),
b.add(d.mul(d).divr(2)).sub(a.mul(d)).sub(Jmat.Complex.PIPI6_);if(4==m)return b=b(h).neg(),a=Jmat.Complex.log(Jmat.Complex.ONE.sub(a)),b.sub(a.mul(a).divr(2))}return Jmat.Complex.dilog(a.mul(a)).divr(2).sub(Jmat.Complex.dilog(a.neg()))};
Jmat.Complex.trilog=function(a){if(a.eqr(0))return Jmat.Complex.ZERO;if(a.eqr(1))return Jmat.Complex.APERY;if(a.eqr(Infinity)||a.eqr(-Infinity))return Jmat.Complex(-Infinity);var b=function(a){for(var b=Jmat.Complex.ZERO,f=a,g=.5>c?30:50,h=1;h<g;h++){var k=f.divr(h*h*h),b=b.add(k);if(Jmat.Complex.near(k,Jmat.Complex.ZERO,1E-15))break;f=f.mul(a)}return b},c=a.abs();return.75>c?b(a):.75>1/c?(b=b(a.inv()),a=Jmat.Complex.log(a.neg()),b.sub(a.mul(a).mul(a).divr(6)).sub(Jmat.Complex.PIPI6_.mul(a))):Jmat.Complex.polylog_integral_(Jmat.Complex(3),
a)};Jmat.Complex.bernoulli=[1,-.5,1/6,0,-1/30,0,1/42,0,-1/30,0,5/66,0,-691/2730,0,7/6,0,-3617/510,0,43867/798,0,-174611/330,0,854513/138,0,-8699436.274358975,0,1.4359735460008333E12,0,-8.861288553122988E9,0,1.799809983498813E8,0];
Jmat.Complex.stieltjes=[.5772156649015329,-.07281584548367673,-.00969036319287232,.002053834420303346,.0023253700654673,7.933238173010627E-4,-2.387693454301996E-4,-5.27289567057751E-4,-3.521233538030395E-4,-3.439477441808805E-5,2.053328149090648E-4,2.701844395439035E-4,1.672729121051402E-4,-2.7463806603760158E-5,-2.0920926205929996E-4,-2.834686553202414E-4,-1.9969685830896976E-4,2.6277037109918338E-5,3.073684081492528E-4,5.036054530473557E-4,4.6634356151155945E-4,1.0443776975600011E-4,-5.415995822039977E-4,
-.0012439620904082457,-.0015885112789035616,-.0010745919527384888,6.568035186371545E-4,.0034778369136185382,.00640006853170063,.007371151770472239,.003557728855573161,-.007513325997815229];
Jmat.Complex.stieltjes_zeta=[.5772156649015329,.07281584548367673,-.00484518159643616,-3.4230573671722433E-4,9.689041939447084E-5,-6.6110318108421895E-6,-3.316240908752772E-7,1.0462094584479188E-7,-8.733218100273798E-9,9.47827778276236E-11,5.658421927608708E-11,-6.768689863513697E-12,3.4921159366720317E-13,4.4104247417577536E-15,-2.3997862217709992E-15,2.1677312200726828E-16,-9.544466076366965E-18,-7.387676660538637E-20,4.800850782488065E-20,-4.139956737713306E-21,1.9168201593991233E-22,-2.0441543122262165E-24,
-4.818498501107353E-25,4.8118570515125666E-26,-2.560263310318815E-27,6.927840895304667E-29,1.6286075504855866E-30,-3.1939375611532554E-31,2.0991515893634255E-32,-8.33674529544144E-34,1.3412593772192187E-35,9.137143891298173E-37];
Jmat.Complex.polylog_integral_=function(a,b){var c=Jmat.Complex;if(1<a.re&&Math.abs(a.im)<a.re&&.1<Math.abs(b.arg())){var d=c.gamma(a),e=function(d){d=d.pow(a.dec()).div(c.exp(d).sub(b));c.isNaN(d)&&(d=c.ZERO);return d},e=c.integrate(c(0),c(Infinity),e,50);return b.div(d).mul(e)}if(c.isNegative(a)&&.1<Math.abs(b.arg())){var f=c.log(b.neg()),e=function(b){var d=b.pow(a.neg()),e=c.sin(a.mulr(Math.PI/2).sub(b.mul(f)));b=c.sinh(b.mulr(Math.PI));d=d.mul(e).div(b);c.isNaN(d)&&(d=c.ZERO);return d};return e=
c.integrate(c(0),c(Infinity),e,30)}if(0>=b.im||0<a.re&&Math.abs(a.im)<a.re)return f=c.log(b.neg()),e=function(b){var d=c.sin(a.mul(c.atan(b)).sub(b.mul(f))),e=c.ONE.add(b.mul(b)).pow(a.divr(2));b=c.sinh(b.mulr(Math.PI));d=d.div(e).div(b);c.isNaN(d)&&(d=c.ZERO);return d},e=c.integrate(c(0),c(10),e,30),b.mulr(.5).add(b.mul(e));if(0<b.im){var g=c.log(b),e=function(b){var d=c.sin(a.mul(c.atan(b)).sub(b.mul(g))),e=c.ONE.add(b.mul(b)).pow(a.divr(2));b=c.exp(b.mulr(2*Math.PI)).subr(1);d=d.div(e).div(b);
c.isNaN(d)&&(d=c.ZERO);return d},e=c.integrate(c(0),c(Infinity),e,30),d=c.incgamma_upper(c.ONE.sub(a),g.neg()),h=g.neg().pow(c.ONE.sub(a));return b.mulr(.5).add(d.div(h)).add(b.mulr(2).mul(e))}return c(NaN)};
Jmat.Complex.polylog_borwein_=function(a,b){var c=b.mul(b).div(b.dec()).abs();if(3.7<=c)return Jmat.Complex(NaN);for(var c=Math.floor(Math.min(31,16/c)),d=[],e=d[0]=Jmat.Complex.ONE,f=Jmat.Complex.ONE,g=Jmat.Complex.ZERO,h=1;h<=c;h++){var f=f.mul(b),k=f.div(Jmat.Complex(h).pow(a)),g=g.add(k),l=Jmat.Complex.binomial(Jmat.Complex(c),Jmat.Complex(h)).mul(f);h%2&&(l=l.neg());e=e.add(l);d[h]=e}l=Jmat.Complex.ZERO;for(h=c+1;h<=2*c;h++)f=f.mul(b),k=f.div(Jmat.Complex(h).pow(a)),e=d[2*c-h],k=k.mul(e),l=l.add(k);
d=b.dec().inv().powr(c);l=l.mul(d);return c%2?g.sub(l):g.add(l)};Jmat.Complex.polylog_borwein_ok_=function(a,b){var c=b.mul(b).div(b.dec()).abs();return-5<=a.re&&0==b.im&&1.5>=c||0<=a.re&&Math.abs(a.im)<a.re&&2>=c||.5>=b.abs()};
Jmat.Complex.polylog_residue_=function(a,b){var c=!1,d=b;0==a.im&&0==b.im&&(b=b.add(Jmat.Complex.newi(-1E-4)),Jmat.Complex.isNegativeInt(a)||0>b.re)&&(c=!0);for(var e=Jmat.Complex.log(b),f=Jmat.Complex.gamma(Jmat.Complex.ONE.sub(a)),g=Jmat.Complex.ZERO,h=0;30>h;h++)g=0<d.im?g.add(Jmat.Complex.newi(2*h*Math.PI).sub(e).pow(a.dec())):g.add(Jmat.Complex.newi(-2*h*Math.PI).sub(e).pow(a.dec()));d=f.mul(g);c&&0!=d.im&&(d=Jmat.Complex(d.re));return d};
Jmat.Complex.polylog=function(a,b){if(Jmat.Complex.isInt(a)){if(a.eqr(0))return b.div(Jmat.Complex.ONE.sub(b));if(a.eqr(1))return Jmat.Complex.log(Jmat.Complex.ONE.sub(b)).neg();if(a.eqr(2))return Jmat.Complex.dilog(b);if(a.eqr(3))return Jmat.Complex.trilog(b);if(a.eqr(-1)){var c=Jmat.Complex.ONE.sub(b);return b.div(c).div(c)}if(a.eqr(-2))return c=Jmat.Complex.ONE.sub(b),b.mul(b.inc()).div(c).div(c).div(c);if(a.eqr(-3)){var c=Jmat.Complex.ONE.sub(b),d=c.mul(c);return b.mul(Jmat.Complex.ONE.add(b.mulr(4)).add(b.mul(b))).div(d).div(d)}if(a.eqr(-4))return c=
Jmat.Complex.ONE.sub(b),d=c.mul(c),b.mul(b.inc()).mul(Jmat.Complex.ONE.add(b.mulr(10)).add(b.mul(b))).div(d).div(d).div(c)}if(1<a.re&&b.eqr(0))return Jmat.Complex(0);if(1<a.re&&b.eqr(1))return Jmat.Complex.zeta(a);var e=b.abs();if(.5>=e&&-10<=a.re||.75>e&&-2<=a.re||.9>e&&-1<a.re){for(var c=Jmat.Complex.ZERO,d=b,e=.5>=e?30:50,f=1;f<e;f++){var g=d.div(Jmat.Complex(f).pow(a)),c=c.add(g);if(Jmat.Complex.near(g,Jmat.Complex.ZERO,1E-15))break;d=d.mul(b)}return c}return Jmat.Complex.polylog_borwein_ok_(a,
b)?Jmat.Complex.polylog_borwein_(a,b):0>a.re?Jmat.Complex.polylog_residue_(a,b):Jmat.Complex.isNegativeInt(a)&&1<e?(c=Jmat.Complex.isOdd(a)?1:-1,Jmat.Complex.polylog(a,b.inv()).mulr(c)):Jmat.Complex.polylog_integral_(a,b)};Jmat.Complex.theta1=function(a,b){if(1<a.im)return Jmat.Complex.theta1(a.neg(),b).neg();for(var c=Jmat.Complex(0),d=Jmat.Complex(1),e=0;20>e;e++)var f=b.powr((e+.5)*(e+.5)),g=Jmat.Complex.sin(a.mulr(2*e+1)),c=c.add(d.mul(f).mul(g)),d=d.neg();return c.mulr(2)};
Jmat.Complex.theta2=function(a,b){if(1<a.im)return Jmat.Complex.theta2(a.neg(),b);for(var c=Jmat.Complex(0),d=0;20>d;d++)var e=b.powr((d+.5)*(d+.5)),f=Jmat.Complex.cos(a.mulr(2*d+1)),c=c.add(e.mul(f));return c.mulr(2)};Jmat.Complex.theta3=function(a,b){if(1<a.im)return Jmat.Complex.theta3(a.neg(),b);for(var c=Jmat.Complex(0),d=0;20>d;d++)var e=b.powr(d*d),f=Jmat.Complex.cos(a.mulr(2*d)),c=c.add(e.mul(f));return c.mulr(2).addr(1)};
Jmat.Complex.theta4=function(a,b){if(1<a.im)return Jmat.Complex.theta4(a.neg(),b);for(var c=Jmat.Complex(0),d=Jmat.Complex(1),e=0;20>e;e++)var f=b.powr(e*e),g=Jmat.Complex.cos(a.mulr(2*e)),c=c.add(d.mul(f).mul(g)),d=d.neg();return c.mulr(2).addr(1)};Jmat.Complex.mulSqrtBranch_=function(a,b){return Jmat.Complex.isPositive(a)&&Jmat.Complex.isPositive(b)?Jmat.Complex.sqrt(a.mul(b)):Jmat.Complex.sqrt(a).mul(Jmat.Complex.sqrt(b))};
Jmat.Complex.ellipticrf=function(a,b,c){for(var d=Jmat.Complex,e=0,f,g,h,k;;){k=a.add(b).add(c).divr(3);if(d.nearr(k,0,1E-14))return d(0);f=a.div(k).rsub(1);g=b.div(k).rsub(1);h=c.div(k).rsub(1);if(.0025>Math.max(Math.max(f.abs(),g.abs()),h.abs()))break;var l=d.sqrt(a),m=d.sqrt(b),n=d.sqrt(c),l=l.mul(m).add(m.mul(n)).add(n.mul(l));a=a.add(l).divr(4);b=b.add(l).divr(4);c=c.add(l).divr(4);e++;if(1E3<e)break}a=f.mul(g).sub(h.mul(h));f=f.mul(g).mul(h);d=d(1).sub(a.divr(10)).add(f.divr(14)).add(a.mul(a).divr(24)).sub(a.mul(f).mulr(3/
44));return k.powr(-.5).mul(d)};
Jmat.Complex.ellipticrc=function(a,b){var c=Jmat.Complex,d;if(0<b.re)d=c(1);else{var e=a.sub(b);d=c.sqrt(a).div(c.sqrt(e));a=e;b=b.neg()}for(var f=0,g;;){e=a.add(b).add(b).divr(3);g=b.div(e).subr(1);if(.0012>g.abs())break;var h=c.sqrt(a).mul(c.sqrt(b)).mulr(2).add(b);a=a.add(h).divr(4);b=b.add(h).divr(4);f++;if(1E3<f)break}var f=g.mul(g),h=f.mul(f),k=h.mul(f),c=c(1).add(f.mulr(.3)).add(f.mul(g).divr(7)).add(h.mulr(.375)).add(h.mul(g).mulr(9/22)).add(k.mulr(159/208)).add(k.mul(g).mulr(1.125));return e.powr(-.5).mul(d).mul(c)};
Jmat.Complex.ellipticrj=function(a,b,c,d){var e=Jmat.Complex,f=d,g,h,k;0>=f.re&&(a.re>b.re&&(g=a,a=b,b=g),b.re>c.re&&(g=b,b=c,c=g),a.re>b.re&&(g=a,a=b,b=g),g=b.sub(f).rdiv(1),h=g.mul(c.sub(b)).mul(b.sub(a)),d=b.add(h),k=e.ellipticrc(a.mul(c).div(b),f.mul(d).div(b)));for(var l=0,m,n,p,r,q=function(a){return a.mul(a)},u=e(0),t=e(1);;){var v=a.add(b).add(c).add(d).add(d).divr(5);m=a.div(v).rsub(1);n=b.div(v).rsub(1);p=c.div(v).rsub(1);r=d.div(v).rsub(1);if(.0015>Math.max(Math.max(m.abs(),n.abs()),Math.max(p.abs(),
r.abs())))break;var w=e.sqrt(a),y=e.sqrt(b),A=e.sqrt(c),z=w.mul(y).add(y.mul(A)).add(A.mul(w)),w=q(d.mul(w.add(y).add(A)).add(w.mul(y).mul(A))),y=d.mul(q(d.add(z))),u=u.add(t.mul(e.ellipticrc(w,y))),t=t.divr(4);a=a.add(z).divr(4);b=b.add(z).divr(4);c=c.add(z).divr(4);d=d.add(z).divr(4);l++;if(1E3<l)break}d=m.mul(n).mul(p);l=r.mul(r).mul(r);m=m.mul(n).add(m.mul(p)).add(n.mul(p)).sub(r.mul(r).mulr(3));n=d.add(m.mul(r).mulr(2)).add(l.mulr(4));p=d.mulr(2).add(m.mul(r)).add(l.mulr(3)).mul(r);r=d.mul(r).mul(r);
r=e(1).sub(m.mulr(3/14)).add(n.divr(6)).add(m.mul(m).mulr(9/88)).sub(p.mulr(3/22)).sub(m.mul(n).mulr(9/52)).add(r.mulr(3/26));u=u.mulr(3).add(t.mul(r).mul(v.powr(-1.5)));0>=f.re&&(a=e.ellipticrf(a,b,c),u=g.mul(h.mul(u).add(k.sub(a).mulr(3))));return u};
Jmat.Complex.ellipticrd=function(a,b,c){for(var d=Jmat.Complex,e=0,f,g,h,k,l=d(0),m=d(1);;){k=a.add(b).add(c.mulr(3)).divr(5);if(d.nearr(k,0,1E-14))return d(0);f=a.div(k).rsub(1);g=b.div(k).rsub(1);h=c.div(k).rsub(1);if(.0015>Math.max(Math.max(f.abs(),g.abs()),h.abs()))break;var n=d.sqrt(a),p=d.sqrt(b),r=d.sqrt(c),n=n.mul(p).add(p.mul(r)).add(r.mul(n)),l=l.add(m.div(r.mul(c.add(n)))),m=m.divr(4);a=a.add(n).divr(4);b=b.add(n).divr(4);c=c.add(n).divr(4);e++;if(1E3<e)break}a=f.mul(g).sub(h.mul(h).mulr(6));
b=f.mul(g).mulr(3).sub(h.mul(h).mulr(8)).mul(h);f=f.mul(g).sub(h.mul(h)).mulr(3).mul(h).mul(h);g=h.mul(g).mul(h).mul(h).mul(h);d=d(1).sub(a.mulr(3/14)).add(b.divr(6)).add(a.mul(a).mulr(9/88)).sub(f.mulr(3/22)).sub(a.mul(b).mulr(9/52)).add(g.mulr(3/26));return m.mul(k.powr(-1.5)).mul(d).add(l.mulr(3))};Jmat.Complex.elliptick=function(a){var b=Jmat.Complex;return b.ellipticrf(b(0),a.mul(a).rsub(1),b(1))};
Jmat.Complex.incellipticf=function(a,b){var c=Jmat.Complex,d=c.sin(a),e=c.cos(a);return d.mul(c.ellipticrf(e.mul(e),b.mul(b).mul(d).mul(d).rsub(1),c(1)))};Jmat.Complex.elliptice=function(a){var b=Jmat.Complex;a=a.mul(a);var c=b.ellipticrf(b(0),a.rsub(1),b(1)),b=b.ellipticrd(b(0),a.rsub(1),b(1));return c.sub(b.mul(a).divr(3))};
Jmat.Complex.incelliptice=function(a,b,c){var d=Jmat.Complex,e=d.sin(a),f=d.cos(a),g=e.mul(e);a=g.mul(e);var f=f.mul(f),h=c.mul(c);c=d.ellipticrf(f,h.mul(g).rsub(1),d(1));d=d.ellipticrd(f,h.mul(g).rsub(1),d(1));return e.mul(c).add(b.mul(a).mul(d).mulr(3))};Jmat.Complex.ellipticpi=function(a,b){var c=Jmat.Complex,d=b.mul(b),e=c.ellipticrf(c(0),d.rsub(1),c(1)),c=c.ellipticrj(c(0),d.rsub(1),c(1),a.rsub(1));return e.add(c.mul(a).divr(3))};
Jmat.Complex.incellipticpi=function(a,b,c){var d=Jmat.Complex,e=d.sin(a),f=d.cos(a),g=e.mul(e);a=g.mul(e);var f=f.mul(f),h=c.mul(c);c=d.ellipticrf(f,h.mul(g).rsub(1),d(1));d=d.ellipticrj(f,h.mul(g).rsub(1),d(1),b.mul(g).rsub(1));return e.mul(c).add(b.mul(a).mul(d).mulr(3))};
Jmat.Complex.agm=function(a,b){if(a.eq(b.neg())||a.eq(Jmat.Complex.ZERO)||b.eq(Jmat.Complex.ZERO))return Jmat.Complex(0);for(var c=Jmat.Complex.isReal(a)&&Jmat.Complex.isReal(b)&&0>a.re==0>b.re,d,e,f=0;60>f&&!a.eq(b);f++)d=a.add(b).divr(2),e=Jmat.Complex.mulSqrtBranch_(a,b),a=d,b=e;c&&(a.im=0);return a};Jmat.Complex.ghm=function(a,b){for(var c,d,e=0;60>e&&!a.eq(b);e++)c=Jmat.Complex.mulSqrtBranch_(a,b),d=Jmat.Complex.TWO.div(a.inv().add(b.inv())),a=c,b=d;return a};
Jmat.Real.tetration_loop_=function(a,b,c,d){for(var e,f=0;f<c;f++){b=d?Jmat.Real.logy(b,a):Math.pow(a,b);if(Jmat.Real.isInfOrNaN(b))break;if(Infinity==b)break;if(b==e)break;e=b;if(1E3<f)return NaN}return b};
Jmat.Real.tetration=function(a,b){var c=Jmat.Real;if(0==b)return 1;if(1==b)return a;if(2==b)return Math.pow(a,a);if(2<=a&&5<b)return Infinity;if(0==a&&c.isPositiveInt(b))return Jmat.Complex.isEven(b)?1:0;if(Infinity==b&&0<a){var d=Math.log(a);return c.lambertw(-d)/-d}return c.isPositiveInt(b)?c.tetration_loop_(a,a,b-1,!1):-1<b&&0>=b?1+b:0<b?(d=b-Math.floor(b),c.tetration_loop_(a,d,Math.ceil(b),!1)):-1>=b?(d=b-Math.floor(b),c.tetration_loop_(a,d,-Math.ceil(b),!0)):NaN};
Jmat.Complex.tetration_loop_=function(a,b,c,d){for(var e=Jmat.Complex,f,g=0;g<c;g++){b=d?e.logy(b,a):a.pow(b);if(e.isInfOrNaN(b))break;if(b.eq(f))break;f=b;if(1E3<g)return e(NaN)}return b};
Jmat.Complex.tetrational=function(a){var b=Jmat.Complex,c=[.30685281944005,.59176735125832,.3964832129017,.17078658150959,.08516537613999,.03804195209047,.01734090876306,.00755271038865,.00328476064839,.0013936174017,5.8758348148E-4,2.4379186661E-4,1.0043966462E-4,4.090111776E-5,1.654344436E-5,6.63102846E-6,2.64145664E-6,1.04446533E-6,4.1068839E-7,1.6048059E-7,6.239367E-8,2.412797E-8,9.28797E-9,3.5585E-9,1.35774E-9,5.1587E-10],d=[b(.37090658903229,1.33682167078891),b(.01830048268799,.06961107694975),
b(-.0422210796016,.02429633404907),b(-.01585164381085,-.01478953595879),b(.00264738081895,-.0065755813052),b(.00182759574799,-2.5319516391E-4),b(3.656299477E-4,2.824651581E-4),b(2.689538943E-5,1.4180498091E-4),b(-3.139436775E-5,3.583704949E-5),b(-1.376358453E-5,-1.83512708E-6),b(-1.8029098E-6,-3.14787679E-6),b(2.639887E-7,-9.2613311E-7),b(2.4961828E-7,-1.3664223E-7),b(6.37479E-9,2.270476E-8),b(-3.41142E-9,5.12289E-9),b(-1.62203E-9,3.1619E-10),b(-3.8743E-10,-2.7282E-10),b(-1.201E-11,-1.344E-10),b(2.57E-11,
-2.543E-11),b(9.35E-12,4.5E-13),b(1.7E-12,1.86E-12),b(-5E-14,7.1E-13),b(-1.6E-13,1.2E-13),b(-5E-14,-1E-14),b(-1E-14,-1E-14)],e=[b(.31813150520476413,1.3372357014306895),b(1),b(-.15131489715565175,-.2967488367322413),b(-.03697630940906762,.09873054431149697),b(.02581159797314014,-.017386962126530753),b(-.0079444196,5.7925018E-4)],f=function(a){var c=b(1.077961437528,-.94654096394782),d=b(.12233176,-.02366108),c=b.exp(e[0].mul(a).add(c));a=d.mul(c).mul(b.exp(a.mul(b.newi(2*Math.PI))));return b.powerSeries(e,
e.length,b.ZERO,c).add(a)},g=function(a){return b.log(a.addr(2)).add(b.powerSeries(c,c.length,b.ZERO,a))},h=function(a){return b.powerSeries(d,d.length,b.newi(3),a)},k=b(Jmat.Real.fracn(a.re),a.im),f=-4.5>a.im?f(k.conj()).conj():-1.5>a.im?h(k.conj()).conj():1.5>a.im?g(k):4.5>a.im?h(k):f(k);return 0<a.re?b.tetration_loop_(b.E,f,Math.floor(a.re),!1):b.tetration_loop_(b.E,f,-Math.ceil(a.re),!0)};
Jmat.Complex.tetration=function(a,b){var c=Jmat.Complex;if(c.isPositive(a)&&c.isPositiveInt(b)&&Infinity!=b.re)return c(Jmat.Real.tetration(a.re,b.re));if(b.eqr(0))return c(1);if(b.eqr(1))return a;if(b.eqr(2))return a.pow(a);if(c.isReal(a)&&2<=a.re&&5<b)return c(Infinity);if(a.eqr(0)&&c.isPositiveInt(b))return c.isEven(b)?c(1):c(0);if(b.eqr(Infinity)){if(a.eqr(1))return c(1);var d=c.log(a);return c.lambertw(d.neg()).div(d.neg())}if(c.isPositiveInt(b))return c.tetration_loop_(a,a,b.re-1,!1);if(c.isReal(b)){if(b.eqr(-1))return c(0);
if(-1<b.re&&0>=b.re)return b.inc();if(0<b.re)return d=b.sub(c.floor(b)),c.tetration_loop_(a,d,Math.ceil(b.re),!1);if(-1>=b.re)return d=b.sub(c.floor(b)),c.tetration_loop_(a,d,-Math.ceil(b.re),!0)}return c.near(a,c.E,1E-15)?c.tetrational(b):c(NaN)};
Jmat.Complex.ei=function(a){var b=Jmat.Complex,c=a.abs();if(0==c)return b(-Infinity);if(Infinity==c)return 0<a.re?b(Infinity):b(0,Math.sign(a.im)*Math.PI);if(5<c)for(var d=b(0),e=b(1),f=Math.min(30,Math.floor(a.abs())+1),g=1;g<=f;g++){var h=e,e=e.mul(a.rdiv(g));if(b.nearr(e,0,1E-15))return g=b(0,Math.sign(a.im)*Math.PI),d=d.addr(1).div(a),100<a.abs()?b.exp(a.add(b.log(d))).add(g):b.exp(a).mul(d).add(g);if(e.abs()>h.abs()){d.sub(h);break}d=d.add(e)}if(1<c&&(0>a.re||1<Math.abs(a.im))){d=b(0,Math.sign(a.im)*
Math.PI);c=b(0);e=b(0);g=b.exp(a);0==a.im?(e=a.rsub(1).inv(),d=e.mul(g).neg()):(c=a.rsub(1).sub(g.div(d)).inv(),e=a.rsub(1).inv(),d=d.mul(e.div(c)));for(g=1;30>g&&(c=a.rsub(2*g+1).sub(c.mulr(g*g)).inv(),e=a.rsub(2*g+1).sub(e.mulr(g*g)).inv(),h=d,d=d.mul(e.div(c)),!b.near(d,h,1E-15));g++);return d}d=0;0!=a.im&&(d=Math.sign(a.im)*Math.abs(b.arg(a).re));d=b.EM.add(b.log(b.abs(a))).add(b(0,d));b=a;for(g=h=1;30>g;g++){c=d.add(b.divr(g*h));if(d.eq(c))break;d=c;b=b.mul(a);h*=g+1}return d};
Jmat.Complex.e1=function(a){var b=Jmat.Complex,c=b.ei(a.neg()).neg();if(0>a.im)c=c.add(b(0,Math.PI));else if(0<a.im||0>a.re)c=c.sub(b(0,Math.PI));return c};Jmat.Complex.li=function(a){var b=Jmat.Complex;return b.ei(b.log(a))};Jmat.Complex.li2=function(a){return Jmat.Complex.li(a).subr(1.045163780117493)};
Jmat.Complex.si_pade_=function(a){var b=a.mul(a),c=b.mulr(-6.053382120104225E-16).addr(7.08240282274876E-13).mul(b).addr(-3.5320197899716837E-10).mul(b).addr(9.432808094387131E-8).mul(b).addr(-1.4101853682133025E-5).mul(b).addr(.0011545722575101668).mul(b).addr(-.045439340981633).mul(b).addr(1),b=b.mulr(3.2110705119371216E-16).addr(4.504909757538658E-13).mul(b).addr(3.280675710557897E-10).mul(b).addr(1.556549863087456E-7).mul(b).addr(4.9917511616975513E-5).mul(b).addr(.010116214573922557).mul(b).addr(1);
return a.mul(c).div(b)};
Jmat.Complex.ci_pade_=function(a){var b=Jmat.Complex,c=a.mul(a),d=c.mulr(-9.937284888575855E-15).addr(1.0648080289118924E-11).mul(c).addr(-4.68889508144848E-9).mul(c).addr(1.052973638462392E-6).mul(c).addr(-1.275283422402677E-4).mul(c).addr(.007518515244388983).mul(c).addr(-.25).mul(c),c=c.mulr(1.3975961673137686E-18).addr(1.8910605471305976E-15).mul(c).addr(1.3853635277277863E-12).mul(c).addr(6.970712957609589E-10).mul(c).addr(2.5553327708612963E-7).mul(c).addr(6.721268008142544E-5).mul(c).addr(.011592605689110734).mul(c).addr(1);return b.log(a).addr(.5772156649015329).add(d.div(c))};
Jmat.Complex.f_pade_=function(a){var b=a.mul(a).inv(),c=b.mulr(-4.9470116864541595E11).addr(4.94816688199952E12).mul(b).addr(1.0079518298036857E13).mul(b).addr(4.2096818057107695E12).mul(b).addr(6.40533830574022E11).mul(b).addr(4.337362388704325E10).mul(b).addr(1.4307340382127464E9).mul(b).addr(2.3775031012543183E7).mul(b).addr(196396.37289514687).mul(b).addr(744.4370681619367).mul(b).addr(1),b=b.mulr(1.1153549350991426E13).addr(1.4346854917158102E13).mul(b).addr(5.060844645934751E12).mul(b).addr(7.085013081495154E11).mul(b).addr(4.585951158477658E10).mul(b).addr(1.4747895219298546E9).mul(b).addr(2.4153567016512685E7).mul(b).addr(197865.24703158395).mul(b).addr(746.4370681619276).mul(b).addr(1);
return c.div(b).div(a)};
Jmat.Complex.g_pade_=function(a){a=a.mul(a).inv();var b=a.mulr(-1.3651713767087168E12).addr(6.432916131430495E12).mul(a).addr(1.8100448746466457E13).mul(a).addr(7.576645832578344E12).mul(a).addr(1.0904952845036278E12).mul(a).addr(6.83052205423625E10).mul(a).addr(2.0629759514676335E9).mul(a).addr(3.1255757079577874E7).mul(a).addr(235239.1816264782).mul(a).addr(813.5952011516862).mul(a).addr(1),c=a.mulr(3.996532578874908E13).addr(4.0183908730765664E13).mul(a).addr(1.171647233717366E13).mul(a).addr(1.3986671069641458E12).mul(a).addr(7.8746501734183E10).mul(a).addr(2.2335554327809935E9).mul(a).addr(3.2602666164709084E7).mul(a).addr(240036.75283557878).mul(a).addr(819.5952011514515).mul(a).addr(1);return a.mul(b).div(c)};
Jmat.Complex.si=function(a){var b=Jmat.Complex;if(4>a.abs())return b.si_pade_(a);if(1<Math.abs(a.re)){var c=b.f_pade_(a),d=b.cos(a),e=b.g_pade_(a),f=b.sin(a);a=b.I.mulr(0>a.re||0==a.re&&0>a.im?Math.PI:-Math.PI);return a.muli(.5).sub(c.mul(d)).sub(e.mul(f))}c=b.e1(a.mul(b.I).neg());d=b.e1(a.mul(b.I));a=b.I.mulr(0>a.re||0==a.re&&0>a.im?Math.PI:-Math.PI);return c.sub(d).add(a).mul(b.I).mulr(.5)};
Jmat.Complex.ci=function(a){var b=Jmat.Complex;if(4>a.abs())return b.ci_pade_(a);if(1<Math.abs(a.re)){var c=b.f_pade_(a),d=b.cos(a),e=b.g_pade_(a),f=b.sin(a),g=b.log(a);a=0<a.re||0==a.re&&0<a.im?b(0):b(0,(0>a.im?-1:1)*Math.PI);return c.mul(f).sub(e.mul(d)).add(a)}c=b.e1(a.mul(b.I).neg());d=b.e1(a.mul(b.I));g=b.log(a);a=(0<a.re||0==a.re&&0<a.im?g:g.subi((0>a.im?-1:1)*Math.PI)).mulr(2);return c.add(d).add(a).mulr(-.5).add(g)};Jmat.Complex.shi=function(a){return Jmat.Complex.si(a.muli(1)).muli(1).neg()};
Jmat.Complex.chi=function(a){var b=Jmat.Complex,c=new b(0,0>a.re&&0<=a.im?3*Math.PI/2:-Math.PI/2);return b.ci(a.muli(1)).add(c)};
Jmat.Complex.erf_inv=function(a){var b=Jmat.Complex;if(0!=a.im&&1<Math.abs(a.re)){var c=0>a.re;c&&(a=a.neg());var d=b.sqrt(b.log(a.mulr(Jmat.Real.SQRTPI).mul(b.ONE.sub(a))).neg());a=b.finvert_newton(a,b.erf,function(a){return b.TWO.divr(Jmat.Real.SQRTPI).mul(b.exp(a.mul(a).neg()))},d);c&&(a=a.neg());return a}if(0==a.im){if(0==a.re)return b(0);if(1==a.re)return b(Infinity);if(-1==a.re)return b(-Infinity)}var e=[.886226899,-1.645349621,.914624893,-.140543331],c=[1,-2.118377725,1.442710462,-.329097515,
.012229801],f=[-1.970840454,-1.62490649,3.429567803,1.641345311],d=[1,3.5438892,1.6370678];.7>=a.abs()?(d=a.mul(a),a=a.mul(d.mulr(e[3]).addr(e[2]).mul(d).addr(e[1]).mul(d).addr(e[0])),a=a.div(d.mulr(c[4]).addr(c[3]).mul(d).addr(c[2]).mul(d).addr(c[1]).mul(d).addr(c[0]))):(c=b.sqrt(b.log(b.ONE.sub(a).divr(2)).neg()),a=c.mulr(f[3]).addr(f[2]).mul(c).addr(f[1]).mul(c).addr(f[0]),a=a.div(c.mulr(d[2]).addr(d[1]).mul(c).addr(d[0])));return a};Jmat.Complex.erfc_inv=function(a){return Jmat.Complex.erf_inv(Jmat.Complex.ONE.sub(a))};
Jmat.Complex.fresnels=function(a){var b=Jmat.Complex,c=Jmat.Real,d=b.erf(b(1,1).mulr(c.SQRTPI/2).mul(a));a=b.erf(b(1,-1).mulr(c.SQRTPI/2).mul(a));return d.sub(a.muli(1)).mul(b(.25,.25))};Jmat.Complex.fresnelc=function(a){var b=Jmat.Complex,c=Jmat.Real,d=b.erf(b(1,1).mulr(c.SQRTPI/2).mul(a));a=b.erf(b(1,-1).mulr(c.SQRTPI/2).mul(a));return d.add(a.muli(1)).mul(b(.25,-.25))};
Jmat.Real.minkowski=function(a){if(a!=a)return NaN;var b=Math.floor(a),c=1,d=b+1,e=1,f,g,h=1,k=b;if(a<b||0>b!=0>=d)return a;for(;;){h/=2;if(k+h==k)break;f=b+d;if(0>f!=0>b)break;g=c+e;if(0>g)break;a<f/g?(d=f,e=g):(k+=h,b=f,c=g)}return k+h};Jmat.Complex.minkowski=function(a){return Jmat.Complex(Jmat.Real.minkowski(a.re),Jmat.Real.minkowski(a.im))};
Jmat.Complex.rootfind_bisection=function(a,b,c,d,e){d=void 0==d?256:d;e=void 0==e?1E-9:e;a=a.re;b=b.re;if(b<a){var f=a;a=b;b=f}if(Infinity==b-a)return Jmat.Complex(NaN);for(var g=f=NaN,h=0,k=0,l=0;l<d;l++){var m=a+l*(b-a)/d,n=c(Jmat.Complex(m)).re;if(Jmat.Real.near(n,0,e))return Jmat.Complex(m);n>h&&(f=m,h=n);n<k&&(g=m,k=n)}if(g!=g||f!=f)return Jmat.Complex(NaN);for(;;){m=(g+f)/2;n=c(Jmat.Complex(m)).re;if(Jmat.Real.near(n,0,e))return Jmat.Complex(m);0<n&&(f=m);0>n&&(g=m);if(Jmat.Real.near(g,f,e))return Jmat.Complex(NaN)}};
Jmat.Complex.rootfind_secant=function(a,b,c,d,e){d=d||30;e=e||1E-15;for(var f=c(a),g=c(b),h=0;h<d;h++){var k=a.mul(g).sub(b.mul(f)).div(g.sub(f));Jmat.Complex.isInfOrNaN(k);var l=c(k);if(Jmat.Real.near(l,0,e))return k;a=b;f=g;b=k;g=l}return b};
Jmat.Complex.rootfind=function(a,b){b||(b={});var c=b.z0||Jmat.Complex.ZERO,d=b.maxit||30,e=void 0==b.prec?1E-9:b.prec;return b.real&&void 0!=b.z1?Jmat.Complex.rootfind_bisection(c,b.z1,a,d,e):b.df?Jmat.Complex.rootfind_newton(a,b.df,c,d):Jmat.Complex.rootfind_newton_noderiv(a,c,d)};
Jmat.Complex.newtonStartValues_=[Jmat.Complex(0),Jmat.Complex(.1),Jmat.Complex(-.1),Jmat.Complex.newi(.1),Jmat.Complex.newi(-.1),Jmat.Complex(.1,.1),Jmat.Complex(.1,-.1),Jmat.Complex(-.1,.1),Jmat.Complex(-.1,-.1),Jmat.Complex(1),Jmat.Complex(-1),Jmat.Complex.newi(1),Jmat.Complex.newi(-1)];
Jmat.Complex.newtonStartValue_=function(a){for(var b=Jmat.Complex.newtonStartValues_,c=Infinity,d=Jmat.Complex(NaN),e=0;e<b.length;e++){var f=b[e],g=a(f),g=Jmat.Complex.manhattan(g,Jmat.Complex.ZERO);g<c&&(c=g,d=f)}return d};Jmat.Complex.newtonStartValuesAround_=[Jmat.Complex(1),Jmat.Complex(-1),Jmat.Complex.newi(1),Jmat.Complex.newi(-1)];
Jmat.Complex.newtonStartValueAround_=function(a,b,c){for(var d=Jmat.Complex.newtonStartValuesAround_,e=Infinity,f=Jmat.Complex(NaN),g=0;g<d.length;g++){var h=b.add(d[g].mulr(c)),k=a(h),k=Jmat.Complex.manhattan(k,Jmat.Complex.ZERO);k<e&&(e=k,f=h)}return f};Jmat.Real.rootfind_newton2=function(a,b,c){b||(b=0);c||(c=30);for(var d=b,e=Infinity,f=NaN,g=0;g<c;g++){var d=b,h=a(b);b-=h[0]/h[1];h=Infinity;Jmat.Real.isInfOrNaN(b)?b=d-.1:h=Math.abs(b-d);if(h<e&&(g=0,f=b,e=h,1E-15>h))break}return f};
Jmat.Real.rootfind_newton=function(a,b,c,d){return Jmat.Real.rootfind_newton2(function(c){return[a(c),b(c)]},c,d)};Jmat.Complex.rootfind_newton=function(a,b,c,d){c||(c=Jmat.Complex.ZERO);d||(d=30);for(var e=c,f=Infinity,g=Jmat.Complex(NaN),h=0;h<d;h++){var k=a(c),l=Jmat.Complex.manhattan(k,Jmat.Complex.ZERO);if(Jmat.Real.near(l,0,1E-15))return c;l<f&&(f=l,g=c);k=c.sub(k.div(b(c)));Jmat.Complex.isInfOrNaN(k)&&(l=Jmat.Complex.manhattan(c,e),k=Jmat.Complex.newtonStartValueAround_(a,c,l?l:.1));e=c=k}return g};
Jmat.Complex.rootfind_newton_noderiv=function(a,b,c){return Jmat.Complex.rootfind_newton(a,function(b){return Jmat.Complex.differentiate_stencil5(b,a)},b,c)};Jmat.Complex.finvert_newton=function(a,b,c,d,e){return Jmat.Complex.rootfind_newton(function(c){return b(c).sub(a)},c,d,e)};Jmat.Complex.finvert_newton_noderiv=function(a,b,c,d){return Jmat.Complex.rootfind_newton_noderiv(function(c){return b(c).sub(a)},c,d)};Jmat.Real.gausleg_cache_=[];
Jmat.Real.gauss_legendre_roots_=function(a){if(Jmat.Real.gausleg_cache_[a])return Jmat.Real.gausleg_cache_[a];for(var b=function(a,b){for(var c=1,d=a,e=2;e<=b;e++)var f=((2*e-1)*a*d-(e-1)*c)/e,c=d,d=f;return[d,(b*c-b*a*d)/(1-a*a)]},c=[],d=[],e=0;e<a;e++){var f=Math.cos(Math.PI*(e+.75)/(a+.5)),f=Jmat.Real.rootfind_newton2(function(c){return b(c,a)},f,100),g=b(f,a);c[e]=f;d[e]=2/((1-f*f)*g[1]*g[1])}Jmat.Real.gausleg_cache_[a]=[c,d];return Jmat.Real.gausleg_cache_[a]};Jmat.Real.gauslag_cache_=[];
Jmat.Real.gauss_laguerre_roots_=function(a){if(Jmat.Real.gauslag_cache_[a])return Jmat.Real.gauslag_cache_[a];for(var b=function(a,b){if(0==b)return[1,0,0];for(var c=1,d=1-a,e=2;e<=b;e++)var f=((2*e-1-a)*d-(e-1)*c)/e,c=d,d=f;return[d,b*(d-c)/a,c]},c=[],d=[],e=0;e<a;e++){var f=0,f=0==e?3/(1+2.4*a):1==e?c[e-1]+15/(1+2.5*a):c[e-1]+(1+2.55*(e-1))/(1.9*(e-1))*(c[e-1]-c[e-2]),f=Jmat.Real.rootfind_newton2(function(c){return b(c,a)},f,100),g=b(f,a);c[e]=f;d[e]=-1/(a*g[1]*g[2])}Jmat.Real.gauslag_cache_[a]=
[c,d];return Jmat.Real.gauslag_cache_[a]};Jmat.Real.integrate_simpson=function(a,b,c,d,e){b=(b-a)/d;for(var f=0,g=0,h=0;h<=d;h++){var k=a+(h-1)*b,l=a+h*b,m=c((k+l)/2),n=c(l);0<h&&(f+=(l-k)/6*(g+4*m+n));g=n;if(e&&49==h%50&&e())return NaN}return f};Jmat.Real.integrate_gaussian_legendre=function(a,b,c,d){if(1>d||d!=Math.round(d)||100<d)return NaN;var e=Jmat.Real.gauss_legendre_roots_(d),f=e[0],e=e[1],g=(b-a)/2;a=(b+a)/2;for(var h=b=0;h<d;h++)b+=c(g*f[h]+a)*e[h];return g*b};
Jmat.Real.integrate_gaussian_laguerre=function(a,b,c){if(1>c||c!=Math.round(c)||100<c)return NaN;var d=Jmat.Real.gauss_laguerre_roots_(c);c=d[0];for(var d=d[1],e=0,f=0;f<c.length;f++)var g=Math.exp(-c[f]),h=b(c[f]+a),e=e+h/g*d[f];return e};
Jmat.Real.integrate_gaussian=function(a,b,c,d){var e=Jmat.Real;return Infinity==b?-Infinity==a?(a=e.integrate_gaussian_laguerre(0,function(a){return c(-a)},d),d=e.integrate_gaussian_laguerre(0,c,d),a+d):e.integrate_gaussian_laguerre(a,c,d):-Infinity==a?e.integrate_gaussian_laguerre(-a,function(a){return c(-a)},d):e.integrate_gaussian_legendre(a,b,c,d)};
Jmat.Real.integrate=function(a,b,c,d,e){void 0==e&&(e=1);d||(d=1==e?20:30);return 0==e?Jmat.Real.integrate_simpson(a,b,c,d):Jmat.Real.integrate_gaussian(a,b,c,d)};Jmat.Complex.integrate_gaussian_legendre=function(a,b,c,d){var e=Jmat.Complex;if(1>d||d!=Math.round(d)||100<d)return e(NaN);var f=Jmat.Real.gauss_legendre_roots_(d),g=f[0],f=f[1],h=b.sub(a).divr(2);a=b.add(a).divr(2);e=e(0);for(b=0;b<d;b++)e=e.add(c(h.mulr(g[b]).add(a)).mulr(f[b]));return h.mul(e)};
Jmat.Complex.integrate_gaussian_laguerre=function(a,b,c){var d=Jmat.Complex;if(1>c||c!=Math.round(c)||100<c)return d(NaN);var e=Jmat.Real.gauss_laguerre_roots_(c);c=e[0];for(var e=e[1],f=d(0),g=0;g<c.length;g++)var h=Math.exp(-c[g]),k=b(d(c[g]).add(a)),f=f.add(k.divr(h).mulr(e[g]));return f};
Jmat.Complex.integrate_gaussian=function(a,b,c,d){var e=Jmat.Complex;return b.eqr(Infinity)?a.eqr(-Infinity)?(a=e.integrate_gaussian_laguerre(e(0),function(a){return c(a.neg())},d),d=e.integrate_gaussian_laguerre(e(0),c,d),a.add(d)):e.integrate_gaussian_laguerre(a,c,d):a.eqr(-Infinity)?e.integrate_gaussian_laguerre(a.neg(),function(a){return c(a.neg())},d):e.integrate_gaussian_legendre(a,b,c,d)};
Jmat.Complex.integrate_simpson=function(a,b,c,d,e){var f=b.sub(a).divr(d),g=Jmat.Complex(0),h=null,k,l,m=2;b.eqr(Infinity)&&(m=Math.pow(1E12/1E-12,1/d));for(var n=0;n<=d;n++){b.eqr(Infinity)?(k=l?l:a,l=l?l.mulr(m):a.addr(1E-12)):(k=a.add(f.mulr(n-1)),l=a.add(f.mulr(n)));var p=c(k.add(l).divr(2)),r=c(l);0<n&&(h=l.sub(k).divr(6).mul(h.add(p.mulr(4)).add(r)),g=g.add(h));h=r;if(e&&49==n%50&&e())return Jmat.Complex(NaN)}return g};
Jmat.Complex.integrate=function(a,b,c,d,e){void 0==e&&(e=1);d||(d=1==e?20:30);return 0==e?Jmat.Complex.integrate_simpson(a,b,c,d):Jmat.Complex.integrate_gaussian(a,b,c,d)};Jmat.Complex.differentiate_newton_noderiv=function(a,b){var c=Math.max(.01,Math.abs(a.re))/1E3,d=b(a.addr(c/2)),e=b(a.subr(c/2));return d.sub(e).divr(c)};
Jmat.Complex.differentiate_stencil5=function(a,b){var c=Math.max(.01,Math.abs(a.re))/1E3,d=b(a.addr(2*c)).neg(),e=b(a.addr(c)).mulr(8),f=b(a.subr(c)).mulr(-8),g=b(a.subr(2*c));return d.add(e).add(f).add(g).divr(12*c)};Jmat.Complex.differentiate2nd_stencil5=function(a,b){var c=Jmat.Complex(Math.max(.01,Math.abs(a.re))/1E3),d=b(a.add(c.mulr(2))).neg(),e=b(a.add(c)).mulr(16),f=b(a).mulr(-30),g=b(a.sub(c)).mulr(16),h=b(a.sub(c.mulr(2))).neg();return d.add(e).add(f).add(g).add(h).div(c.mul(c).mulr(12))};
Jmat.Complex.differentiate=function(a,b){return Jmat.Complex.differentiate_stencil5(a,b)};Jmat.Complex.doSummation=function(a,b,c,d,e){if(0==c||0>c||!Jmat.Complex.isReal(a)||!Jmat.Complex.isReal(b))return Jmat.Complex(NaN);var f=a.re;b=b.re;a=Jmat.Complex(0);for(var g=0;f<=b+c/4;f+=c){var h=d(Jmat.Complex(f));a=a.add(h);if(e&&49==g%50&&e())return Jmat.Complex(NaN);g++}return a};
Jmat.Complex.doProduct=function(a,b,c,d,e){if(0==c||0>c||!Jmat.Complex.isReal(a)||!Jmat.Complex.isReal(b))return Jmat.Complex(NaN);b=b.re;var f=Jmat.Complex.ONE,g=0;for(a=a.re;a<=b+c/4;a+=c){var h=d(Jmat.Complex(a)),f=f.mul(h);if(e&&49==g%50&&e())return Jmat.Complex(NaN);g++}return f};Jmat.Complex.powerSeries=function(a,b,c,d){for(var e=void 0==a[0].re,f=Jmat.Complex.ZERO,g=Jmat.Complex.ONE,h=0;h<b;h++)f=e?f.add(g.mulr(a[h])):f.add(g.mul(a[h])),g=g.mul(d.sub(c));return f};
Jmat.Complex.pdf_uniform=function(a,b,c){return a.re>=b.re&&a.re<=c.re?c.sub(b).inv():Jmat.Complex(0)};Jmat.Complex.cdf_uniform=function(a,b,c){return a.re<b.re?Jmat.Complex(0):a.re<c.re?a.sub(b).div(c.sub(b)):Jmat.Complex(1)};Jmat.Complex.qf_uniform=function(a,b,c){a=b.add(a.mul(c.sub(b)));return a.re>=b.re&&a.re<=c.re?a:Jmat.Complex(NaN)};Jmat.Complex.pdf_standardnormal=function(a){return Jmat.Complex.exp(a.mul(a).mulr(-.5)).mul(Jmat.Complex.INVSQRT2PI)};Jmat.Complex.cdf_standardnormal=function(a){return Jmat.Complex.erf(a.div(Jmat.Complex.SQRT2)).addr(1).mulr(.5)};
Jmat.Complex.qf_standardnormal=function(a){return Jmat.Complex.erf_inv(a.mulr(2).subr(1)).mul(Jmat.Complex.SQRT2)};Jmat.Complex.pdf_normal=function(a,b,c){var d=Jmat.Complex.INVSQRT2PI.div(c);a=a.sub(b).mul(a.sub(b)).div(c.mul(c).mulr(2));return d.mul(Jmat.Complex.exp(a.neg()))};Jmat.Complex.cdf_normal=function(a,b,c){a=a.sub(b).divr(c.abs()).div(Jmat.Complex.SQRT2);return Jmat.Complex.erf(a).addr(1).mulr(.5)};Jmat.Complex.qf_normal=function(a,b,c){return b.add(c.mul(Jmat.Complex.qf_standardnormal(a)))};
Jmat.Complex.pdf_lognormal=function(a,b,c){var d=Jmat.Complex.INVSQRT2PI.div(c).div(a);a=Jmat.Complex.log(a).sub(b);return d.mul(Jmat.Complex.exp(a.mul(a).div(c.mul(c).mulr(2)).neg()))};Jmat.Complex.cdf_lognormal=function(a,b,c){a=Jmat.Complex.log(a).sub(b).div(Jmat.Complex.SQRT2.mul(c));return Jmat.Complex.erf(a).addr(1).mulr(.5)};Jmat.Complex.qf_lognormal=function(a,b,c){a=Jmat.Complex.log(a).sub(b).div(Jmat.Complex.SQRT2.mul(c));return Jmat.Complex.erf(a).addr(1).mulr(.5)};
Jmat.Complex.pdf_cauchy=function(a,b,c){a=a.sub(b);a=a.mul(a).add(c.mul(c)).mulr(Math.PI);return c.div(a)};Jmat.Complex.cdf_cauchy=function(a,b,c){return Jmat.Complex.atan(a.sub(b).div(c)).divr(Math.PI).addr(.5)};Jmat.Complex.qf_cauchy=function(a,b,c){return b.add(c.mul(Jmat.Complex.tan(a.subr(.5).divr(Math.PI))))};Jmat.Complex.pdf_studentt_cache_=[];Jmat.Complex.pdf_studentt_cachefun_=function(a){var b=a.inc().divr(2);return Jmat.Complex.gammaDiv_(b,a.divr(2))};
Jmat.Complex.pdf_studentt=function(a,b){if(b.eqr(1))return a.mul(a).addr(1).mulr(Math.PI).inv();if(b.eqr(2))return a.mul(a).addr(2).powr(1.5).inv();if(b.eqr(3)){var c=a.mul(a).addr(3);return Jmat.Complex(10.392304845413264).div(c.mul(c).mulr(Math.PI))}if(b.eqr(Infinity))return Jmat.Complex.pdf_standardnormal(a);var c=b.inc().divr(2),d=Jmat.Complex.calcCache_(b,Jmat.Complex.pdf_studentt_cachefun_,Jmat.Complex.pdf_studentt_cache_),e=Jmat.Complex.sqrt(Jmat.Complex.PI.mul(b)).inv(),d=d.mul(e);Jmat.Complex.isNaN(d)&&
100<b.re&&(d=Jmat.Complex(Jmat.Complex.INVSQRT2PI));e=a.mul(a).div(b).inc();return d.mul(e.pow(c.neg()))};
Jmat.Complex.cdf_studentt=function(a,b){if(b.eqr(1))return Jmat.Complex.atan(a).divr(Math.PI).addr(.5);if(b.eqr(2))return a.div(Jmat.Complex.sqrt(a.mul(a).addr(2)).mulr(2)).addr(.5);if(b.eqr(Infinity))return Jmat.Complex.cdf_standardnormal(a);if(a.eqr(0))return Jmat.Complex(.5);var c=Jmat.Complex.calcCache_(b,Jmat.Complex.pdf_studentt_cachefun_,Jmat.Complex.pdf_studentt_cache_),d=Jmat.Complex.incbeta(a.mul(a).div(b).neg(),Jmat.Complex(.5),Jmat.Complex.ONE.sub(b).mulr(.5)),d=Jmat.Complex.I.mul(a).mul(d),
e=Jmat.Complex(a.abs()).mulr(2).mul(Jmat.Complex.SQRTPI);return Jmat.Complex(.5).sub(c.mul(d).div(e))};
Jmat.Complex.qf_studentt=function(a,b){if(b.eqr(1))return Jmat.Complex.tan(Jmat.Complex.PI.mul(a.subr(.5)));if(b.eqr(2)){var c=a.mulr(4).mul(Jmat.Complex.ONE.sub(a));return a.subr(.5).mulr(2).mul(Jmat.Complex.sqrt(Jmat.Complex(2).div(c)))}if(b.eqr(4)&&Jmat.Complex.isReal(a))return c=a.mulr(4).mul(Jmat.Complex.ONE.sub(a)),c=Jmat.Complex.sqrt(c),c=Jmat.Complex.cos(Jmat.Complex(1/3).mul(Jmat.Complex.acos(c))).div(c),Jmat.Complex.sign(a.subr(.5)).mulr(2).mul(Jmat.Complex.sqrt(c.dec()));if(b.eqr(Infinity))return Jmat.Complex.qf_standardnormal(a);
Jmat.Real.near(a.im,0,1E-15)&&(a=Jmat.Complex(a.re));Jmat.Real.near(b.im,0,1E-15)&&(b=Jmat.Complex(b.re));if(Jmat.Complex.isPositive(b)&&Jmat.Complex.isPositive(a)&&1>a.re){if(.5>a.re)return c=Jmat.Complex.beta_i_inv(a.mulr(2),b.divr(2),Jmat.Complex(.5)),Jmat.Complex.sqrt(b.mul(c.inv().subr(1))).neg();c=Jmat.Complex.beta_i_inv(Jmat.Complex.ONE.sub(a).mulr(2),b.divr(2),Jmat.Complex(.5));return Jmat.Complex.sqrt(b.mul(c.inv().subr(1)))}return Jmat.Complex(NaN)};
Jmat.Complex.pdf_chi_square=function(a,b){var c=b.divr(2),d=c.eqr(1)?Jmat.Complex(2):Jmat.Complex(2).pow(c),e=Jmat.Complex.isNegativeInt(c)?Jmat.Complex(Infinity):Jmat.Complex.gamma(c),c=a.pow(c.dec()).mul(Jmat.Complex.exp(a.divr(-2)));return d.mul(e).inv().mul(c)};Jmat.Complex.cdf_chi_square=function(a,b){return Jmat.Complex.gamma_p(b.divr(2),a.divr(2))};Jmat.Complex.qf_chi_square=function(a,b){return Jmat.Complex.gamma_p_inv(b.divr(2),a).mulr(2)};
Jmat.Complex.pdf_logistic=function(a,b,c){a=Jmat.Complex.exp(a.sub(b).div(c).neg());b=a.inc();return a.div(c.mul(b).mul(b))};Jmat.Complex.cdf_logistic=function(a,b,c){return Jmat.Complex.tanh(a.sub(b).div(c).divr(2)).mulr(.5).addr(.5)};Jmat.Complex.qf_logistic=function(a,b,c){a=a.div(Jmat.Complex.ONE.sub(a));return b.add(c.mul(Jmat.Complex.log(a)))};Jmat.Complex.pdf_gamma_cache_=[];
Jmat.Complex.pdf_gamma=function(a,b,c){var d=a.pow(b.dec());a=Jmat.Complex.exp(a.div(c).neg());c=c.pow(b);b=Jmat.Complex.calcCache_(b,Jmat.Complex.gamma,Jmat.Complex.pdf_gamma_cache_);return d.mul(a).div(c).div(b)};Jmat.Complex.cdf_gamma=function(a,b,c){return Jmat.Complex.gamma_p(b,a.div(c))};Jmat.Complex.qf_gamma=function(a,b,c){return Jmat.Complex.gamma_p_inv(b,a).mul(c)};Jmat.Complex.pdf_beta=function(a,b,c){var d=a.pow(b.dec());a=a.rsub(1).pow(c.dec());b=Jmat.Complex.beta(b,c);return d.mul(a).div(b)};
Jmat.Complex.cdf_beta=function(a,b,c){return Jmat.Complex.beta_i(a,b,c)};Jmat.Complex.qf_beta=function(a,b,c){return Jmat.Complex.beta_i_inv(a,b,c)};Jmat.Complex.pdf_fisher=function(a,b,c){var d=b.mul(a).pow(b).mul(c.pow(c)),e=b.mul(a).add(c).pow(b.add(c));a=a.mul(Jmat.Complex.beta(b.divr(2),c.divr(2)));return Jmat.Complex.sqrt(d.div(e)).div(a)};Jmat.Complex.cdf_fisher=function(a,b,c){a=b.mul(a).div(b.mul(a).add(c));return Jmat.Complex.beta_i(a,b.divr(2),c.divr(2))};
Jmat.Complex.qf_fisher=function(a,b,c){a=Jmat.Complex.beta_i_inv(a,b.divr(2),c.divr(2));var d=Jmat.Complex.ONE.sub(a);return c.mul(a).div(b.mul(d))};Jmat.Complex.pdf_weibull=function(a,b,c){var d=c.div(b),e=a.div(b).pow(c.dec());a=a.div(b).pow(c).neg();return d.mul(e).mul(Jmat.Complex.exp(a))};Jmat.Complex.cdf_weibull=function(a,b,c){a=a.div(b).pow(c).neg();return Jmat.Complex.ONE.sub(Jmat.Complex.exp(a))};
Jmat.Complex.qf_weibull=function(a,b,c){a=Jmat.Complex.ONE.sub(a);c=Jmat.Complex.log(a).neg().pow(c.inv());return b.mul(c)};Jmat.Complex.pdf_exponential=function(a,b){return 0>a.re?Jmat.Complex(0):b.mul(Jmat.Complex.exp(a.mul(b).neg()))};Jmat.Complex.cdf_exponential=function(a,b){return 0>a.re?Jmat.Complex(0):Jmat.Complex.ONE.sub(Jmat.Complex.exp(a.mul(b).neg()))};Jmat.Complex.qf_exponential=function(a,b){return Jmat.Complex.log(a.rsub(1)).neg().div(b)};
Jmat.Complex.pdf_laplace=function(a,b,c){a=Jmat.Complex.exp(Jmat.Complex(a.sub(b).abs()).neg().div(c));return c.mulr(2).inv().mul(a)};Jmat.Complex.cdf_laplace=function(a,b,c){c=Jmat.Complex.exp(Jmat.Complex(a.sub(b).abs()).neg().div(c));a=Jmat.Complex.sign(a.sub(b));return c.rsub(1).mul(a).mulr(.5).addr(.5)};Jmat.Complex.qf_laplace=function(a,b,c){var d=Jmat.Complex.log(Jmat.Complex(a.subr(.5).abs()).mulr(2).rsub(1));a=Jmat.Complex.sign(a.subr(.5));return b.sub(c.mul(a).mul(d))};
Jmat.Complex.pmf_bernoulli=function(a,b){return a.eqr(0)?b.rsub(1):a.eqr(1)?b:b.pow(a).mul(b.rsub(1).pow(a.rsub(1)))};Jmat.Complex.cdf_bernoulli=function(a,b){return 0>a.re?Jmat.Complex.ZERO:1<=a.re?Jmat.Complex.ONE:b.rsub(1)};Jmat.Complex.qf_bernoulli=function(a,b){return a.re<1-b.re?Jmat.Complex.ZERO:Jmat.Complex.ONE};Jmat.Complex.pmf_binomial=function(a,b,c){return Jmat.Complex.binomial(b,a).mul(c.pow(a)).mul(c.rsub(1).pow(b.sub(a)))};
Jmat.Complex.cdf_binomial=function(a,b,c){return Jmat.Complex.beta_i(c,b.sub(a),a.addr(1))};Jmat.Complex.qf_binomial=function(a,b,c){if(c.eqr(0))return Jmat.Complex.ZERO;if(c.eqr(1))return b;var d=Jmat.Complex,d=Jmat.Complex.rootfind_bisection(d(0),b,function(d){return Jmat.Complex.cdf_binomial(d,b,c).sub(a)},100,1E-14);return Jmat.Complex.round(d)};Jmat.Complex.pmf_poisson=function(a,b){var c=b.pow(a),d=Jmat.Complex.factorial(a),e=Jmat.Complex.exp(b.neg());return c.mul(e).div(d)};
Jmat.Complex.cdf_poisson=function(a,b){return Jmat.Complex.gamma_q(a.addr(1),b)};Jmat.Complex.qf_poisson=function(a,b){return Jmat.Complex.gamma_q_inva(b,a).subr(1)};Jmat.BigInt=function(a,b,c){if(this instanceof Jmat.BigInt)this.a=a||[],this.radix=b||Jmat.BigInt.ARRAYBASE_,this.minus=c||!1;else return Jmat.BigInt.make(a,b,c)};Jmat.BigInt.ARRAYBASE_=32768;Jmat.BigInt.ARRAYBASE_BITS_=15;Jmat.BigInt.STRINGBASE_=10;
Jmat.BigInt.make=function(a,b,c){return void 0==a?new Jmat.BigInt(a,b,c):"number"==typeof a?Jmat.BigInt.fromInt(a,b):"string"==typeof a?Jmat.BigInt.parse(a,Jmat.BigInt.STRINGBASE_,b):void 0!=a.length?new Jmat.BigInt(a,b,c):void 0!=a.re?Jmat.BigInt.fromInt(a.re,b):void 0!=a.w?Jmat.BigInt.fromInt(a.w,b):b&&a.radix!=b?Jmat.BigInt.convertBase(a,b):Jmat.BigInt.copy(a)};
Jmat.BigInt.cast=function(a,b,c){return void 0==a?new Jmat.BigInt(void 0,b,c):void 0==a.a||b&&a.radix!=b?a.radix&&b?Jmat.BigInt.convertBase(a,b):Jmat.BigInt(a,b,c):a};Jmat.BigInt.copy=function(a){return new Jmat.BigInt(a.a.slice(0),a.radix,a.minus)};Jmat.BigInt.parse=function(a,b,c){b=b||Jmat.BigInt.STRINGBASE_;c=c||Jmat.BigInt.ARRAYBASE_;var d=!1;"-"==a[0]&&(d=!0,a=a.substr(1));a=Jmat.BigInt.stringToArray(a,c,b);return new Jmat.BigInt(a,c,d)};
Jmat.BigInt.toString=function(a,b){return a&&a.a?(a.minus?"-":"")+Jmat.BigInt.arrayToString(a.a,a.radix,b):"invalid"};Jmat.BigInt.prototype.toString=function(a){return Jmat.BigInt.toString(this,a)};Jmat.BigInt.stringToArray=function(a,b,c){b=b||Jmat.BigInt.ARRAYBASE_;c=c||Jmat.BigInt.STRINGBASE_;for(var d=[],e=0;e<a.length;e++){var f=Jmat.BigInt.di_(a[e]);d[e]=f}return Jmat.BigInt.convertArrayBase(d,c,b)};
Jmat.BigInt.arrayToString=function(a,b,c){a=Jmat.BigInt.convertArrayBase(a,b||Jmat.BigInt.ARRAYBASE_,c||Jmat.BigInt.STRINGBASE_);b="";for(c=0;c<a.length;c++)b+=Jmat.BigInt.d_[a[c]];0==a.length&&(b="0");return b};Jmat.BigInt.getInBaseTwoWithoutConvert_=function(a){for(var b=[];0<a;)b.push(a&1),a>>=1;Jmat.BigInt.mirror_(b);return new Jmat.BigInt(b,2)};
Jmat.BigInt.convertArrayBase=function(a,b,c,d){if(8<a.length&&10==c&&Jmat.Real.isPOT(b))return d=Jmat.BigInt.convertArrayBase(a,b,1E6),Jmat.BigInt.convertArrayBase(d,1E6,10);var e=Jmat.Real,f=Jmat.BigInt;if(b==c)return a;var g=[];a=f.maybecopystrip_(a);if(2147483648>=b&&2147483648>=c&&e.isPOT(b)&&e.isPOT(c)){var h=e.ilog2(b),e=e.ilog2(c);d=Math.ceil(a.length*h/e);for(var k=0;k<d;k++)g[k]=0;if(b<c)for(b=d-1,c=0,k=a.length-1;0<=k;k--)c+h>e?(d=e-c,0!=d&&(g[b]|=(a[k]&(1<<d)-1)<<c),b--,g[b]=a[k]>>d,c=
h-d):(g[b]|=a[k]<<c,c+=h);else{var l=c-1;b=a.length-1;c=0;for(k=d-1;0<=k;k--)c+e>h?(d=h-c,g[k]=a[b]>>c,b--,g[k]|=(a[b]&l)<<d,c=e-d):(g[k]|=a[b]>>c&l,c+=e)}f.stripInPlace_(g);return g}if(h=e.isPowerOf(b,c)){for(k=0;k<a.length;k++){e=a[k];for(d=0;d<h;d++)g.push(Math.floor(e/(h-d-1))%c);for(d=h-1;0<=d;d--)g[k*h+d]=e%c,e=Math.floor(e/c)}f.stripInPlace_(g);return g}if(h=e.isPowerOf(c,b)){c=Math.ceil(a.length/h);for(k=0;k<c;k++)for(e=1,d=g[c-1-k]=0;d<h;d++){l=a.length-1-k*h-d;if(0>l)break;g[c-1-k]+=a[l]*
e;e*=b}f.stripInPlace_(g);return g}if(8<a.length){h=e.idiv(a.length,2);g=[];l=[];for(k=0;k<h;k++)g[k]=a[k];for(k=h;k<a.length;k++)l[k-h]=a[k];k=d||[];g=f.convertArrayBase(g,b,c,k);d=f.convertArrayBase(l,b,c,k);a=a.length-h;h=k[a];if(!h)var h=e.idiv(a,2),e=a-h,l=k[h],m=k[e],h=l&&m?l.mul(m):l?l.mul(f.pow(f(b,c),f.getInBaseTwoWithoutConvert_(e))):m?m.mul(f.pow(f(b,c),f.getInBaseTwoWithoutConvert_(h))):f.pow(f(b,c),f.getInBaseTwoWithoutConvert_(a));k[a]=h;return f(d,c).add(f(g,c).mul(h)).a}for(k=0;k<
a.length;k++)g=f.baseloop_(g,0,b,[],0,1,a[k],c,!1);0==g.length&&(g=[0]);return g};Jmat.BigInt.convertStringBase=function(a,b,c){if(b==c)return a;a=Jmat.BigInt.stringToArray(a,c,b);return Jmat.BigInt.arrayToString(a,c,c)};
Jmat.BigInt.baseloop_=function(a,b,c,d,e,f,g,h,k){var l=[],m=Math.max(a.length+b,d.length+e),n=a.length;if(d.length||b)if(0==b&&0==e&&1==c&&1==f)for(p=0;p<m;p++)p<a.length&&(g+=a[a.length-p-1]),p<d.length&&(g+=d[d.length-p-1]),l[p]=(g+h)%h,g=Math.floor(g/h);else for(p=0;p<m;p++)p>=b&&p<a.length+b&&(g+=c*a[a.length-p-1+b]),p>=e&&p<d.length+e&&(g+=f*d[d.length-p-1+e]),l[p]=(g+h)%h,g=Math.floor(g/h);else for(var p=0;p<m;p++)g+=c*a[a.length-p-1],l[p]=(g+h)%h,g=Math.floor(g/h);if(Infinity==g)throw"infinite overflow";
for(;0<g;)l.push((g+h)%h),g=Math.floor(g/h);if(k){for(;l.length>n&&0==l[l.length-1];)l.length--;for(;l.length<n;)l.push(0)}else for(;1<l.length&&0==l[l.length-1];)l.length--;Jmat.BigInt.mirror_(l);return l};Jmat.BigInt.intToArray=function(a,b){if(a>Jmat.Real.BIGGESTJSINT)throw"too large integer literal for JS";for(var c=b||Jmat.BigInt.ARRAYBASE_,d=[];0<a;)d.push(a%c),a=Math.floor(a/c);0==d.length&&(d=[0]);1<d.length&&Jmat.BigInt.mirror_(d);return d};
Jmat.BigInt.arrayToInt=function(a,b){for(var c=b||Jmat.BigInt.ARRAYBASE_,d=0,e=1,f=0;f<a.length;f++)if(d+=e*a[a.length-1-f],e*=c,Infinity==d||Infinity==e)return Infinity;return d};Jmat.BigInt.fromInt=function(a,b){var c=b||Jmat.BigInt.ARRAYBASE_,d=!1;0>a&&(d=!0,a=-a);return new Jmat.BigInt(Jmat.BigInt.intToArray(a,c),c,d)};Jmat.BigInt.toInt=function(a){return Jmat.BigInt.arrayToInt(a.a,a.radix)*(a.minus?-1:1)};
Jmat.BigInt.prototype.toInt=function(){return Jmat.BigInt.arrayToInt(this.a,this.radix)*(this.minus?-1:1)};Jmat.BigInt.ZERO=Jmat.BigInt(0);Jmat.BigInt.ONE=Jmat.BigInt(1);Jmat.BigInt.TWO=Jmat.BigInt(2);Jmat.BigInt.convertBase=function(a,b){return a.radix==b?a:new Jmat.BigInt(Jmat.BigInt.convertArrayBase(a.a,a.radix,b),b,a.minus)};Jmat.BigInt.cloneArray=function(a){return a.slice(0)};Jmat.BigInt.cloneArrayTo=function(a,b){b.length=a.length;for(var c=0;c<a.length;c++)b[c]=a[c]};
Jmat.BigInt.lshift_radix=function(a,b){if(0==b)return a;if(0>b)return Jmat.BigInt.rshift_radix(a,-b);for(var c=Jmat.BigInt.copy(a),d=0;d<b;d++)c.a.push(0);return c};Jmat.BigInt.prototype.lshift_radix=function(a){return Jmat.BigInt.lshift_radix(this,a)};Jmat.BigInt.rshift_radix=function(a,b){if(0==b)return a;if(0>b)return Jmat.BigInt.lshift_radix(a,-b);var c=Jmat.BigInt.copy(a);c.a=c.a.slice(0,-b);return c};Jmat.BigInt.prototype.rshift_radix=function(a){return Jmat.BigInt.rshift_radix(this,a)};
Jmat.BigInt.lshift=function(a,b){var c=Jmat.BigInt;if(0==b)return a;if(0>b)return c.rshift(a,-b);a=c.cast(a,Jmat.BigInt.ARRAYBASE_);var d=new c([],a.radix),e=Math.floor(b/c.ARRAYBASE_BITS_),f=b%c.ARRAYBASE_BITS_;if(0==f){for(var g=0;g<a.a.length;g++)d.a[g]=a.a[g];for(g=0;g<e;g++)d.a.push(0)}else{d.a=[];for(var h=(1<<c.ARRAYBASE_BITS_-f)-1<<f,k=(1<<f)-1,g=0;g<=a.a.length;g++){var l=(0<g?a.a[g-1]:0)<<f&h|(g<a.a.length?a.a[g]:0)<<f>>c.ARRAYBASE_BITS_&k;(l||d.a.length)&&d.a.push(l)}for(g=0;g<e;g++)d.a.push(0);
0==d.a.length&&(d.a=[0])}a.minus&&(d=d.neg());return d};Jmat.BigInt.prototype.lshift=function(a){return Jmat.BigInt.lshift(this,a)};
Jmat.BigInt.rshift=function(a,b){var c=Jmat.BigInt;if(0==b)return a;if(0>b)return c.lshift(a,-b);a=c.cast(a,Jmat.BigInt.ARRAYBASE_);var d=new c([],a.radix),e=Math.floor(b/c.ARRAYBASE_BITS_),f=b%c.ARRAYBASE_BITS_;if(0==f){d.a=[];for(var g=0;g<a.a.length-e;g++)d.a.push(a.a[g])}else{d.a=[];for(var h=(1<<f)-1<<c.ARRAYBASE_BITS_-f,k=(1<<c.ARRAYBASE_BITS_-f)-1,g=0;g<a.a.length-e;g++)d.a.push((0<g?a.a[g-1]:0)<<c.ARRAYBASE_BITS_>>f&h|(g<a.a.length?a.a[g]:0)>>f&k)}0==d.a.length&&(d.a=[0]);a.minus&&(d=d.neg());
c.stripInPlace_(d.a);return d};Jmat.BigInt.prototype.rshift=function(a){return Jmat.BigInt.rshift(this,a)};Jmat.BigInt.bitand=function(a,b){var c=Jmat.BigInt;a=c.cast(a,c.ARRAYBASE_);b=c.cast(b,c.ARRAYBASE_);if(a.minus||b.minus){var d=Math.max(c.getNumBits(a),c.getNumBits(b));a.minus&&(a=a.addr(1).bitnot(d));b.minus&&(b=b.addr(1).bitnot(d))}for(var c=new c([],c.ARRAYBASE_),d=Math.min(a.a.length,b.a.length),e=0;e<d;e++)c.a[d-1-e]=(a.a[a.a.length-1-e]||0)&(b.a[b.a.length-1-e]||0);return c};
Jmat.BigInt.prototype.bitand=function(a){return Jmat.BigInt.bitand(this,a)};Jmat.BigInt.bitandr=function(a,b){var c=Jmat.BigInt;if(a.minus)return c.bitand(a,c(b)).toInt();a=c.cast(a,b<c.ARRAYBASE_?c.ARRAYBASE_:2147483648);return a.a[a.a.length-1]&b};
Jmat.BigInt.bitor=function(a,b){var c=Jmat.BigInt;a=c.cast(a,c.ARRAYBASE_);b=c.cast(b,c.ARRAYBASE_);if(a.minus||b.minus){var d=Math.max(c.getNumBits(a),c.getNumBits(b));a.minus&&(a=a.addr(1).bitnot(d));b.minus&&(b=b.addr(1).bitnot(d))}for(var c=new c([],c.ARRAYBASE_),d=Math.max(a.a.length,b.a.length),e=0;e<d;e++)c.a[d-1-e]=(a.a[a.a.length-1-e]||0)|(b.a[b.a.length-1-e]||0);return c};Jmat.BigInt.prototype.bitor=function(a){return Jmat.BigInt.bitor(this,a)};
Jmat.BigInt.bitxor=function(a,b){var c=Jmat.BigInt;a=c.cast(a,c.ARRAYBASE_);b=c.cast(b,c.ARRAYBASE_);if(a.minus||b.minus){var d=Math.max(c.getNumBits(a),c.getNumBits(b));a.minus&&(a=a.addr(1).bitnot(d));b.minus&&(b=b.addr(1).bitnot(d))}for(var c=new c([],c.ARRAYBASE_),d=Math.max(a.a.length,b.a.length),e=0;e<d;e++)c.a[d-1-e]=(a.a[a.a.length-1-e]||0)^(b.a[b.a.length-1-e]||0);return c};Jmat.BigInt.prototype.bitxor=function(a){return Jmat.BigInt.bitxor(this,a)};
Jmat.BigInt.bitneg=function(a){a=Jmat.BigInt.cast(a,Jmat.BigInt.ARRAYBASE_);a=a.addr(1);return a=a.neg()};Jmat.BigInt.prototype.bitneg=function(){return Jmat.BigInt.bitneg(this)};
Jmat.BigInt.bitnot=function(a,b){if(0>=b)return a;var c=Jmat.BigInt;a=c.cast(a,c.ARRAYBASE_);var d=c.maybecopystrip_(a.a),e,f=c.ARRAYBASE_-1;if(void 0!=b){e=c(0);for(var g=b%c.ARRAYBASE_BITS_,c=Math.ceil(b/c.ARRAYBASE_BITS_),h=(1<<g)-1,k=0;k<c;k++)e.a[k]=(d[d.length-c+k]||0)^f,0==k&&0!=g&&(e.a[k]&=h)}else{if(!d.length)return a;g=Jmat.Real.ilog2(d[0])+1;if(0==g)for(e=c(1),k=0;k<d.length;k++)e.a.push(d[k]^f);else for(h=(2<<g)-1,e=c(0),e.a[0]=(d[0]^f)&h,k=1;k<d.length;k++)e.a[k]=d[k]^f}e.minus=a.minus;
return e};Jmat.BigInt.prototype.bitnot=function(a){return Jmat.BigInt.bitnot(this,a)};Jmat.BigInt.abs=function(a){return a.abs()};Jmat.BigInt.prototype.abs=function(){return this.minus?new Jmat.BigInt(this.a,this.radix,!1):this};Jmat.BigInt.dist=function(a,b){return a.sub(b).abs()};Jmat.BigInt.cheb=function(a,b){return Jmat.BigInt.dist(a,b)};Jmat.BigInt.manhattan=function(a,b){return Jmat.BigInt.dist(a,b)};Jmat.BigInt.neg=function(a){return a.neg()};
Jmat.BigInt.prototype.neg=function(){return new Jmat.BigInt(this.a,this.radix,!this.minus)};Jmat.BigInt.getSign=function(a){return a.getSign()};Jmat.BigInt.prototype.getSign=function(){return this.minus?-1:1};Jmat.BigInt.nonZero=function(a){return a.nonZero()};Jmat.BigInt.prototype.nonZero=function(){for(var a=0;a<this.a.length;a++)if(this.a[a])return!0;return!1};Jmat.BigInt.sign=function(a){return a.sign()};Jmat.BigInt.prototype.sign=function(){return this.nonZero()?this.getSign():0};
Jmat.BigInt.add=function(a,b){return a.add(b)};Jmat.BigInt.prototype.add=function(a){if(this.minus!=a.minus)return this.sub(a.neg());a=Jmat.BigInt.cast(a,this.radix);return new Jmat.BigInt(Jmat.BigInt.baseloop_(this.a,0,1,a.a,0,1,0,this.radix,!1),this.radix,this.minus)};Jmat.BigInt.addr=function(a,b){return a.addr(b)};Jmat.BigInt.prototype.addr=function(a){return this.add(Jmat.BigInt.fromInt(a))};Jmat.BigInt.sub=function(a,b){return a.sub(b)};
Jmat.BigInt.prototype.sub=function(a){if(this.minus!=a.minus)return this.add(a.neg());a=Jmat.BigInt.cast(a,this.radix);return this.abs().gte(a.abs())?new Jmat.BigInt(Jmat.BigInt.baseloop_(this.a,0,1,a.a,0,-1,0,this.radix,!1),this.radix,this.minus):new Jmat.BigInt(Jmat.BigInt.baseloop_(a.a,0,1,this.a,0,-1,0,this.radix,!1),this.radix,!this.minus)};Jmat.BigInt.subr=function(a,b){return a.subr(b)};Jmat.BigInt.prototype.subr=function(a){return this.sub(Jmat.BigInt.fromInt(a))};
Jmat.BigInt.rsub=function(a,b){return a.rsub(b)};Jmat.BigInt.prototype.rsub=function(a){return this.subr(a).neg()};Jmat.BigInt.mul=function(a,b){return a.mul(b)};Jmat.BigInt.prototype.mul=function(a){a=Jmat.BigInt.cast(a,this.radix);var b=Jmat.BigInt.karatsuba_(this.strip().a,a.strip().a,this.radix);return new Jmat.BigInt(b,this.radix,this.minus!=a.minus)};Jmat.BigInt.mulr=function(a,b){var c=new Jmat.BigInt([],a.radix,a.minus!=0>b);c.a=Jmat.BigInt.baseloop_(a.a,0,b,[],0,1,0,c.radix,!1);return c};
Jmat.BigInt.prototype.mulr=function(a){var b=new Jmat.BigInt([],this.radix,this.minus!=0>a);b.a=Jmat.BigInt.baseloop_(this.a,0,a,[],0,1,0,b.radix,!1);return b};
Jmat.BigInt.karatsuba_=function(a,b,c){if(1>=a.length||1>=b.length)return Jmat.BigInt.schoolmul_(a,b,c);if(a.length<b.length)return Jmat.BigInt.karatsuba_(b,a,c);if(20>=a.length)return Jmat.BigInt.schoolmul_(a,b,c);var d=Math.floor(a.length/2),e=b.length-(a.length-d),f=a.slice(0,d),g=a.slice(d,a.length),h=0>=e?[0]:b.slice(0,e);b=0>=e?b:b.slice(e,b.length);if(0>=e)return f=Jmat.BigInt.karatsuba_(f,b,c),g=Jmat.BigInt.karatsuba_(g,b,c),Jmat.BigInt.baseloop_(f,a.length-d,1,g,0,1,0,c,!1);var e=Jmat.BigInt.baseloop_(f,
0,1,g,0,1,0,c,!1),k=Jmat.BigInt.baseloop_(h,0,1,b,0,1,0,c,!1),f=Jmat.BigInt.karatsuba_(f,h,c),g=Jmat.BigInt.karatsuba_(g,b,c),h=Jmat.BigInt.karatsuba_(e,k,c);b=Jmat.BigInt.baseloop_(f,0,1,g,0,1,0,c,!1);h=Jmat.BigInt.baseloop_(h,0,1,b,0,-1,0,c,!1);d=a.length-d;a=2*d;d=Jmat.BigInt.baseloop_(h,d,1,g,0,1,0,c,!1);return Jmat.BigInt.baseloop_(f,a,1,d,0,1,0,c,!1)};
Jmat.BigInt.schoolmul_=function(a,b,c){if(1==a.length&&0==a[0])return[0];if(1==a.length&&1==a[0])return b;if(1==b.length&&0==b[0])return[0];if(1==b.length&&1==b[0])return a;if(a.length<b.length)return Jmat.BigInt.schoolmul_(b,a,c);for(var d=[0],e=0,f=0;f<b.length;f++)d=Jmat.BigInt.baseloop_(a,e,b[b.length-f-1],d,0,1,0,c,!1),e++;return d};Jmat.BigInt.compare=function(a,b){return a.compare(b)};
Jmat.BigInt.prototype.compare=function(a){if(a.minus!=this.minus){var b=this.sign();a=a.sign();return b==a?0:b<a?-1:1}a.radix!=this.radix&&(a=Jmat.BigInt.convertBase(a,this.radix));for(var b=Math.max(this.a.length,a.a.length),c=0;c<b;c++){var d=this.a[c-b+this.a.length]||0,e=a.a[c-b+a.a.length]||0;if(d<e)return-1*this.getSign();if(d>e)return 1*this.getSign()}return 0};Jmat.BigInt.comparer=function(a,b){return a.comparer(b)};
Jmat.BigInt.prototype.comparer=function(a){if(0>a!=this.minus){var b=this.sign();a=Math.sign(a);return b==a?0:b<a?-1:1}b=this.getSign();a=Math.abs(a);for(var c=0,d=0;d<this.a.length&&c<=a;d++)c*=this.radix,c+=this.a[d];return(c<a?-1:c==a?0:1)*b};Jmat.BigInt.eq=function(a,b){return 0==Jmat.BigInt.compare(a,b)};Jmat.BigInt.prototype.eq=function(a){return 0==Jmat.BigInt.compare(this,a)};Jmat.BigInt.eqr=function(a,b){return 0==Jmat.BigInt.comparer(a,b)};
Jmat.BigInt.prototype.eqr=function(a){return 0==Jmat.BigInt.comparer(this,a)};Jmat.BigInt.neq=function(a,b){return 0!=Jmat.BigInt.compare(a,b)};Jmat.BigInt.prototype.neq=function(a){return 0!=Jmat.BigInt.compare(this,a)};Jmat.BigInt.neqr=function(a,b){return 0!=Jmat.BigInt.comparer(a,b)};Jmat.BigInt.prototype.neqr=function(a){return 0!=Jmat.BigInt.comparer(this,a)};Jmat.BigInt.gt=function(a,b){return 0<Jmat.BigInt.compare(a,b)};
Jmat.BigInt.prototype.gt=function(a){return 0<Jmat.BigInt.compare(this,a)};Jmat.BigInt.gtr=function(a,b){return 0<Jmat.BigInt.comparer(a,b)};Jmat.BigInt.prototype.gtr=function(a){return 0<Jmat.BigInt.comparer(this,a)};Jmat.BigInt.lt=function(a,b){return 0>Jmat.BigInt.compare(a,b)};Jmat.BigInt.prototype.lt=function(a){return 0>Jmat.BigInt.compare(this,a)};Jmat.BigInt.ltr=function(a,b){return 0>Jmat.BigInt.comparer(a,b)};Jmat.BigInt.prototype.ltr=function(a){return 0>Jmat.BigInt.comparer(this,a)};
Jmat.BigInt.gte=function(a,b){return 0<=Jmat.BigInt.compare(a,b)};Jmat.BigInt.prototype.gte=function(a){return 0<=Jmat.BigInt.compare(this,a)};Jmat.BigInt.gter=function(a,b){return 0<=Jmat.BigInt.comparer(a,b)};Jmat.BigInt.prototype.gter=function(a){return 0<=Jmat.BigInt.comparer(this,a)};Jmat.BigInt.lte=function(a,b){return 0>=Jmat.BigInt.compare(a,b)};Jmat.BigInt.prototype.lte=function(a){return 0>=Jmat.BigInt.compare(this,a)};Jmat.BigInt.lter=function(a,b){return 0>=Jmat.BigInt.comparer(a,b)};
Jmat.BigInt.prototype.lter=function(a){return 0>=Jmat.BigInt.comparer(this,a)};
Jmat.BigInt.sqrt=function(a){var b=Jmat.BigInt;if(a.eqr(0))return b(0);if(!a.minus){var c=b([0],a.radix),d=Jmat.BigInt.copystrip_(a);1==d.a.length&&1==d.a[0]&&(c=b([1],a.radix));d.a=d.a.slice(0,Math.ceil(d.a.length/2)+1);16<a.radix&&(d.a[0]=Math.min(d.a[0],Math.ceil(Math.sqrt(d.a[0]+1))));for(var e=b([1],a.radix);;){var f=c.add(d).divr(2),g=f.mul(f),g=b.compare(g,a);if(0==g){a=f;break}else 0>g?c=f:d=f;if(0>=b.compare(d.sub(c),e)){a=c;break}}return a}};Jmat.BigInt.isOdd=function(a){return a.bitand(Jmat.BigInt.ONE).eqr(1)};
Jmat.BigInt.isEven=function(a){return a.bitand(Jmat.BigInt.ONE).eqr(0)};Jmat.BigInt.root=function(a,b){var c=Jmat.BigInt,d=b.toInt();return 0>=d?void 0:d>Jmat.Real.BIGGESTJSINT?a.eqr(0)?c(0):c.isEven(b)&&a.minus?void 0:c(a.minus?-1:1):Jmat.BigInt.rootr(a,d)};
Jmat.BigInt.rootr=function(a,b){var c=Jmat.BigInt;if(!(0>=b)){if(a.eqr(0))return c(0);if(1==b)return a;if(2==b)return c.sqrt(a);if(!Jmat.Real.isEven(b)||!a.minus){if(b>c.log2(a.abs()).toInt())return c(a.minus?-1:1);var d=c([0],a.radix),e=Jmat.BigInt.copystrip_(a);1==e.a.length&&1==e.a[0]&&(d=c([1],a.radix));e.a=e.a.slice(0,Math.ceil(e.a.length/b)+1);16<a.radix&&(e.a[0]=Math.min(e.a[0],Math.ceil(Jmat.Real.root(e.a[0]+1,b))));for(var f=c([1],a.radix);;){var g=d.add(e).divr(2),h=c.powr(g,b),h=c.compare(h,
a);if(0==h){c=g;break}else 0>h?d=g:e=g;if(0>=c.compare(e.sub(d),f)){c=d;break}}return c}}};Jmat.BigInt.perfectsquare=function(a){var b=Jmat.BigInt;if(a.minus)return null;var c=b.bitandr(a,15);if(0!=c&&1!=c&&4!=c&&9!=c)return null;b=b.sqrt(a);return b.mul(b).eq(a)?b:null};
Jmat.BigInt.perfectpow=function(a,b,c,d){var e=Jmat.BigInt,f=d?e.cast(d):void 0,g=c?e.cast(c):void 0;if(!a.minus){if(c&&d)return[g.pow(f),g,f];if(c){if(a.lter(1)&&b)return[g.mul(g),g,e(2)];c="number"!=typeof c?c:g.toInt();f=e.logr(a,c);b&&(f=f.addr(1));c=g.pow(f);return[c,g,f]}if(d)return c="number"!=typeof d?d:f.toInt(),g=e.rootr(a,c),b&&(g=g.addr(1)),c=g.powr(c),[c,g,f];if(a.ltr(5))return c=a.toInt(),b?0==c?[e(1),e(1),e(2)]:4==c?[e(8),e(2),e(3)]:[e(4),e(2),e(2)]:0==c?void 0:4==a?[e(4),e(2),e(2)]:
[e(1),e(1),e(2)];f=e.log2(a).toInt();b&&f++;var h=a;d=0;for(var k=e(0),l=e(0),m=2;m<=f;m++)if(5<m&&0==m%5)m++;else if(3<m&&0==m%3)m++;else{g=e.rootr(a,m);g.eqr(2)&&(m=f);b&&(g=g.addr(1));c=g.powr(m);var n=a.sub(c).abs();if(n.lt(h)&&(h=n,d=m,k=g,l=c,n.eqr(0)))break;2<m&&m++}if(2==d||3==d||5==d)a=Jmat.BigInt.perfectpow(k),a[0].eq(k)&&(k=a[1],d*=a[2].toInt());return[l,k,e(d)]}};
Jmat.BigInt.mulmany_=function(a){if(0==a.length)return Jmat.BigInt.ONE;for(;1<a.length;){for(var b=Math.floor(a.length/2),c=[],d=0;d<b;d++)c.push(a[d].mul(a[a.length-d-1]));1==a.length%2&&c.push(a[b]);a=c}return a[0]};Jmat.BigInt.factorial=function(a){var b=Jmat.BigInt;a=a.toInt();if(Infinity!=a){if(19>a)return b(Jmat.Real.factorial(a));for(var c=Jmat.Real.eratosthenes(a),d=[],e=0;e<c.length;e++){for(var f=c[e],g=Math.floor(a/f),h=0;0<g;)h+=g,g=Math.floor(g/f);d[e]=b.powr(b(f),h)}return b.mulmany_(d)}};
Jmat.BigInt.primorial=function(a){var b=Jmat.BigInt;a=a.toInt();if(Infinity!=a)return a=Jmat.Real.eratosthenes(a),b.mulmany_(a)};Jmat.BigInt.nearestPrime=function(a){var b=Jmat.BigInt;if(a.lter(2))return b(2);if(a.lter(4))return b(3);var c=b.previousPrime(a),c=a.sub(c);return b.previousPrime(a.add(c).subr(1))};
Jmat.BigInt.nextPrime=function(a){var b=Jmat.BigInt;if(a.ltr(2))return b(2);if(a.ltr(3))return b(3);var c=a.modr(6).toInt(),d=2;0==c||5==c?(a=a.addr(0==c?1:2),d=4):a=a.addr(5-c);for(;;){if(b.isPrime(a))return a;a=a.addr(d);d^=6}};Jmat.BigInt.previousPrime=function(a){var b=Jmat.BigInt;if(a.lter(7))return a.lter(2)?void 0:a.lter(3)?b(2):a.lter(5)?b(3):b(5);var c=a.modr(6).toInt(),d=2;0==c||1==c?(a=a.subr(c+1),d=4):a=a.subr(c-1);for(;;){if(b.isPrime(a))return a;a=a.subr(d);d^=6}};
Jmat.BigInt.min=function(a,b){return a.lt(b)?a:b};Jmat.BigInt.max=function(a,b){return a.gt(b)?a:b};Jmat.BigInt.primeCache_=[];
Jmat.BigInt.qs_sieve_=function(a,b,c,d,e,f){var g=Jmat.BigInt,h=c.sub(b).toInt();c=[];for(var k=0;k<h;k++)c[k]=0;for(k=1;k<d.length;k++){var l=d[k];if(!(4>l))for(var m=Math.log(l),n=-b.modr(l).toInt();n<h;){var p=n+e[k],r=n+(l-e[k]);0<=p&&p<h&&(c[p]+=m);0!=e[k]&&0<=r&&r<h&&(c[r]+=m);n+=l}}e=[[],[],[]];for(k=0;k<c.length;k++)if(h=b.addr(k),l=h.mul(h).sub(a),m=g.rlog(l.abs()),c[k]>=.95*m-10){m=l;n=[];m.minus&&(n.push(-1),m=m.abs());for(p=1;p<d.length&&!m.eqr(0);p++)for(;m.modr(d[p]).eqr(0);)m=m.divr(d[p]),
n.push(d[p]);if(m=m.eqr(1)?n:null)if(e[0].push(l),e[1].push(h),e[2].push(m),e[0].length>=f)break}return e};
Jmat.BigInt.qs_rref_=function(a){for(var b=a.length,c=a[0].length,d=function(a,b,c){var d=a[b];a[b]=a[c];a[c]=d},e=function(a,b,c,d){for(var e=a[0].length;b<e;b++)a[d][b]^=a[c][b]},f=[],g=0,h=0;h<c;h++){var k=Jmat.Real.argmax(g,b,function(b){return a[b][h]});if(0!=a[k][h]){g!=k&&d(a,g,k);for(k=g+1;k<b;k++)0!=a[k][h]&&e(a,h,g,k);f.push(h);g++;if(g>=b)break}}for(h=0;h<f.length;h++)for(b=f[h],c=h-1;0<=c;c--)0!=a[c][b]&&e(a,b,h,c)};
Jmat.BigInt.qs_solve_=function(a,b){var c=a.length,d=a[0].length;b=b||1;for(var e=[],f=0;f<d;f++)e[f]=-1;for(--c;0<=c;c--){for(var g=0;g<d&&0==a[c][g];)g++;if(g!=d){for(var h=0,f=g+1;f<d;f++)a[c][f]&&(-1==e[f]&&(e[f]=b&1,b>>=1),1==e[f]&&(h^=1));e[g]=h}}if(0!=b)return null;d=[];for(f=0;f<e.length;f++)0<e[f]&&d.push(f);return d};
Jmat.BigInt.qsieve_=function(a,b){var c=Jmat.BigInt,d=function(a,b){b=b||2;for(a=""+a;a.length<b;)a="0"+a;return a},e=function(a){return d(a.getHours())+":"+d(a.getMinutes())+":"+d(a.getSeconds())+"."+d(a.getMilliseconds(),3)},f=function(a){b&&console.log("["+e(new Date)+"]: "+a)},g=c.rlog10(a),h=Math.floor(50*g*g),k=c.sqrt(a),l=[-1].concat(Real.eratosthenes(h));if(6E3<l.length)return null;for(var m=[0],n=[-1],p=1;p<l.length;p++){g=c.legendre(a,c(l[p]));if(0==g)return c(l[p]);if(1==g&&(n.push(l[p]),
m.push(c.ressol(a,c(l[p])).toInt()),3E3<n.length))break}var p=n.length+1,r=999*p;f("input: "+a+", smoothness bound: "+h+", num primes: "+l.length+", num filtered primes: "+n.length+", sieving for "+p+" smooth numbers in batches of "+r);for(var l=n,q=k.subr(r),h=[],n=[],g=[];h.length<p;)k=c.qs_sieve_(a,q,q.addr(r),l,m,p-h.length),q=q.addr(r),h=h.concat(k[0]),n=n.concat(k[1]),g=g.concat(k[2]),f("found "+k[0].length+" for this batch, "+h.length+" total");f("sieving done, found "+h.length+" smooth numbers");
m={};for(p=0;p<l.length;p++)m[l[p]]=p;for(var r=[],u=0;u<l.length;u++)r.push([]);for(p=0;p<h.length;p++){for(u=0;u<l.length;u++)r[u][p]=0;for(var t=g[p],u=0;u<t.length;u++)r[m[t[u]]][p]^=1}f("performing gaussian elemination...");c.qs_rref_(r);f("gaussian elemination done. Matrix size: "+r.length+"x"+r[0].length);for(q=0;20>q;q++){f("solving...");var v=c.qs_solve_(r,q);if(!v||!v.length)break;for(var w=[],y=[],k=[],p=0;p<v.length;p++){y.push(h[v[p]]);w.push(n[v[p]]);for(var t=g[v[p]],A=[],u=0;u<l.length;u++)A[u]=
0;for(u=0;u<t.length;u++)A[m[t[u]]]++;for(u=0;u<A.length;u++)k[u]=(k[u]||0)+A[u]}u=c.mulmany_(w);for(p=0;p<k.length;p++)k[p]>>=1;t=[];for(p=0;p<k.length;p++)0!=k[p]&&t.push(c.pow(c(l[p]),c(k[p])));k=c.mulmany_(t);p=c.gcd(a,u.sub(k));f("gcd: "+p);if(!p.eqr(1)&&!p.eq(a))return p}return null};
Jmat.BigInt.factorize=function(a){var b=Jmat.BigInt,c=[];a.minus&&(a=b.neg(a),c.push(b(-1)));if(a.lter(2))return 0!=c.length&&a.eqr(1)||c.push(a),c;if(a.ltr(Jmat.Real.BIGGESTJSINT)){a=Jmat.Real.factorize(a);for(var d=0;d<a.length;d++)c.push(b(a[d]));return c}for(var e=function(a){if(b.isPrime(a))return a;for(var c=Math.min(5E4,b.sqrt(a).toInt()),d=1,k=0;;){k>=b.primeCache_.length&&(b.primeCache_[k]=Jmat.Real.nextPrime(d));d=b.primeCache_[k];k++;if(d!=d||d>c)break;if(a.modr(d).eqr(0))return b(d)}c=
b.perfectpow(a);return c[0].eq(a)&&c[1].lt(a)?e(c[1]):(a=b.qsieve_(a))?e(a):b(0)};;){d=e(a);if(d.eqr(0))return c.sort(function(a,c){return b.compare(a,c)}),c.push(b(0)),c;c.push(d);if(d.eqr(a))return c.sort(function(a,c){return b.compare(a,c)}),c;a=a.div(d)}};Jmat.BigInt.legendre=function(a,b){return Jmat.BigInt.modpow(a,b.subr(1).divr(2),b)};
Jmat.BigInt.ressol=function(a,b){var c=Jmat.BigInt;if(b.eqr(2))return c(0);if(b.lter(2))return null;a=a.mod(b);for(var d=b.subr(1),e=0;0==c.bitandr(d,1);)d=d.divr(2),e++;if(1==e){var f=c.modpow(a,b.addr(1).divr(4),b);return f.mul(f).mod(b).neq(a)?c(0):f}for(f=c(1);f=f.addr(1),!c.legendre(f,b).gtr(1););for(var g=c.modpow(f,d,b),f=c.modpow(a,d.addr(1).divr(2),b),d=c.modpow(a,d,b),h=e;!d.eqr(1);){for(var e=d,k=0;!e.eqr(1);)if(e=e.mul(e).mod(b),k++,k==h)return 0;g=c.modpow(g,c.modpow(c(2),c(h-k-1),b.subr(1)),
b);e=g.mul(g).mod(b);f=f.mul(g).mod(b);d=d.mul(e).mod(b);g=e;h=k}return f.mul(f).mod(b).neq(a)?c(0):f};Jmat.BigInt.logy=function(a,b){return Jmat.BigInt.logr(a,b.toInt())};Jmat.BigInt.logr=function(a,b){if(a.eqr(b))return Jmat.BigInt(1);if(!(a.minus||0>b||a.eqr(0))){if(1==b)return a;if(2==b)return Jmat.BigInt.log2(a);var c=Jmat.BigInt.convertBase(a,b);return Jmat.BigInt.fromInt(Jmat.BigInt.getNumDigits(c)-1,a.radix)}};
Jmat.BigInt.log2=function(a){if(!a.minus)return a=Jmat.BigInt.getNumBits(a),0==a?void 0:Jmat.BigInt.fromInt(a-1)};Jmat.BigInt.log10=function(a){return Jmat.BigInt.logr(a,10)};Jmat.BigInt.rlog2=function(a){var b=Jmat.BigInt.getNumBits(a);return 128<b?(a=Jmat.BigInt.rshift(a,b-128),Jmat.Real.log2(a.toInt())+b-128):Jmat.Real.log2(a.toInt())};Jmat.BigInt.rlog=function(a){return Jmat.BigInt.rlog2(a)*Math.LN2};Jmat.BigInt.rlog10=function(a){return Jmat.BigInt.rlog2(a)/3.321928094887362};
Jmat.BigInt.div=function(a,b){return a.div(b)};Jmat.BigInt.prototype.div=function(a){a.radix!=this.radix&&(a=Jmat.BigInt.convertBase(a,this.radix));return Jmat.BigInt.divmod_(this,a)[0]};Jmat.BigInt.mod=function(a,b){return a.mod(b)};Jmat.BigInt.prototype.mod=function(a){a.radix!=this.radix&&(a=Jmat.BigInt.convertBase(a,this.radix));return Jmat.BigInt.divmod_(this,a)[1]};Jmat.BigInt.divmod=function(a,b){return a.divmod(b)};
Jmat.BigInt.prototype.divmod=function(a){a.radix!=this.radix&&(a=Jmat.BigInt.convertBase(a,this.radix));return a.abs().ltr(65536)?Jmat.BigInt.divsmall_(this,a.toInt()):Jmat.BigInt.divmod_(this,a)};Jmat.BigInt.divr=function(a,b){return 0==b?void 0:1==b?a:-1==b?a.neg():a.abs().ltr(Math.abs(b))?Jmat.BigInt(0):a.eqr(b)?Jmat.BigInt(1):65536>Math.abs(b)?Jmat.BigInt.divsmall_(a,b)[0]:Jmat.BigInt.div(a,Jmat.BigInt(b))};Jmat.BigInt.prototype.divr=function(a){return Jmat.BigInt.divr(this,a)};
Jmat.BigInt.half_=function(a){if(Jmat.Real.isPOT(a.radix)){var b=a.a[a.a.length-1]%2;return[Jmat.BigInt.rshift(a,1),Jmat.BigInt(b)]}for(var b=[],c=a.radix,d=0,e=0;e<a.a.length;e++){var f=a.a[e]+d,d=Jmat.Real.isOdd(f)?c:0,f=Math.floor(f/2);(0<f||0<b.length)&&b.push(f)}return[new Jmat.BigInt(b,c,a.minus),0==d?Jmat.BigInt(0,c):Jmat.BigInt(1,c)]};
Jmat.BigInt.divsmall_=function(a,b){if(b==a.radix)return[a.rshift_radix(a),Jmat.BigInt(0)];if(2==b)return Jmat.BigInt.half_(a);if(-2==b){var c=Jmat.BigInt.half_(a);return[c[0].neg(),c[1].neg()]}var c=a.minus,d=0>b,e=a.minus!=0>b;b=Math.abs(b);for(var f=[],g=a.radix,h=0,k=0;k<a.a.length;k++){var l=a.a[k]+h*g,h=l%b,l=Math.floor(l/b);(0<l||0<f.length)&&f.push(l)}k=Jmat.BigInt(h,g);h&&(c&&d?k=k.neg():d?k=k.subr(b):c&&(k=k.subr(b).neg()));return[new Jmat.BigInt(f,g,e),k]};
Jmat.BigInt.modr=function(a,b){return 0==b?void 0:1==b||-1==b?Jmat.BigInt(0):Math.abs(b)<a.radix&&0==a.radix%b?Jmat.BigInt(Jmat.Real.mod(a.a[a.a.length-1],b)):65536>Math.abs(b)?Jmat.BigInt.divsmall_(a,b)[1]:Jmat.BigInt.mod(a,Jmat.BigInt(b))};Jmat.BigInt.prototype.modr=function(a){return Jmat.BigInt.modr(this,a)};
Jmat.BigInt.leemondiv_=function(a,b,c){var d=Jmat.BigInt,e=a.radix,f=a.radix-1,g,h,k,l,m,n,p=d.copy(a);a=a.strip();b=d.copystrip_(b);h=b.a.length;k=b.a[b.a.length-1-h+1];for(n=0;k;n++)k>>=1;n=c-n;b=b.lshift(n);p=p.lshift(n);b.a.splice(0,0,0);g=Math.max(h,p.a.length);d=d(0,e);for(k=0;k<a.a.length;k++)d.a[k]=0;for(d.a.splice(0,0,0);;){k=b.lshift_radix(g-h);if(k.gt(p))break;p=p.sub(k);d.a[d.a.length-g+h-1]++}for(;p.a.length<a.a.length+1;)p.a.splice(0,0,0);for(k=g-1;k>=h;k--){var r=p.a.length-1;a=d.a.length-
1;var q=b.a.length-1;for(d.a[a-(k-h)]=p.a[r-k]==b.a[q-(h-1)]?f:Math.floor((p.a[r-k]*e+p.a[r-(k-1)])/b.a[q-(h-1)]);;)if(l=(1<h?b.a[q-(h-2)]:0)*d.a[a-(k-h)],m=l>>c,l&=f,g=m+d.a[a-(k-h)]*b.a[q-(h-1)],m=g>>c,g&=f,m==p.a[r-k]?g==p.a[r-(k-1)]?l>(1<k?p.a[r-(k-2)]:0):g>p.a[r-(k-1)]:m>p.a[r-k])d.a[a-(k-h)]--;else break;g=b.lshift_radix(k-h);l=g.mulr(d.a[a-(k-h)]);p.lt(l)?(p.a=Jmat.BigInt.baseloop_(p.a,0,1,g.a,0,1,0,e,!0),p.a=Jmat.BigInt.baseloop_(p.a,0,1,l.a,0,-1,0,e,!0),d.a[a-(k-h)]--):p.a=Jmat.BigInt.baseloop_(p.a,
0,1,l.a,0,-1,0,e,!0)}p=p.rshift(n);return[d,p]};
Jmat.BigInt.divmod_=function(a,b,c){var d=Jmat.BigInt;if(!b.eqr(0)){if(b.eqr(1))return[a,d(0)];if(b.eqr(-1))return[a.neg(),d(0)];if(b.abs().ltr(65536))return Jmat.BigInt.divsmall_(a,b.toInt());if(b.abs().gt(a.abs()))return[d(0),a];if(b.eq(a))return[d(1),d(0)];var e=a.minus!=b.minus;a=a.abs();b=b.abs();c||(a=d.cast(a,d.ARRAYBASE_),b=d.cast(b,d.ARRAYBASE_));c=d.leemondiv_(a,b,c||d.ARRAYBASE_BITS_);a=c[0];c=c[1];d.stripInPlace_(a.a);d.stripInPlace_(c.a);e&&(a=a.neg(),c=c.add(b),c.minus&&c.eqr(0)&&(c.minus=
!1));return[a,c]}};Jmat.BigInt.pow=function(a,b){var c=b;b=Jmat.BigInt.cast(b,2);var d=a.radix;if(b.minus)return Jmat.BigInt(0,d);var e=!1;a.minus&&b.modr(2).eqr(1)&&(e=!0);a=a.abs();for(var c=Jmat.BigInt.maybecopystrip_(b.a,b!=c),d=Jmat.BigInt(1,d),f=a,g=c.length,h=0;h<g;h++)0==c[h]?(f=d.mul(f),d=d.mul(d)):(d=d.mul(f),f=f.mul(f));e&&(d=d.neg());return d};Jmat.BigInt.prototype.pow=function(a){return Jmat.BigInt.pow(this,a)};Jmat.BigInt.powr=function(a,b){return Jmat.BigInt.pow(a,Jmat.BigInt.fromInt(b))};
Jmat.BigInt.prototype.powr=function(a){return Jmat.BigInt.pow(this,Jmat.BigInt.fromInt(a))};Jmat.BigInt.gcd=function(a,b){var c=Jmat.BigInt;a=a.abs();for(b=b.abs();;){if(b.eqr(0))return a;var d=c.mod(a,b);a=b;b=d}};
Jmat.BigInt.egcd=function(a,b){for(var c=Jmat.BigInt,d=c(0),e=c(1),f=c(1),c=c(0),g=a,h=b,k;!g.eqr(0);){var l=h.div(g);k=g;g=h.sub(l.mul(g));h=k;k=d;d=e.sub(l.mul(d));e=k;k=f;f=c.sub(l.mul(f));c=k}if(f.sign()!=a.sign()||d.sign()!=b.sign())k=f,f=d,d=k,k=c,c=e,e=k,f.sign()!=a.sign()&&(f=f.neg()),d.sign()!=b.sign()&&(d=d.neg());return[h,e,c,f,d]};
Jmat.BigInt.invmod=function(a,b){for(var c=Jmat.BigInt,d=b,e=c(1),f=c(0);;){if(a.eqr(1)){c=e;break}if(a.eqr(0)){c=c(0);break}var g=b.divmod(a),f=f.sub(e.mul(g[0]));b=g[1];if(b.eqr(1)){c=f;break}if(b.eqr(0)){c=c(0);break}g=a.divmod(b);e=e.sub(f.mul(g[0]));a=g[1]}c.minus&&(c=d.add(c));return c};Jmat.BigInt.monred_=function(a,b,c,d,e){c=a.mul(e).bitand(c);a=a.add(c.mul(d)).rshift(b);return a.gte(d)&&(a=a.sub(d),a.gte(d))?null:a};
Jmat.BigInt.genmonred_=function(a){var b=Jmat.BigInt.getNumBits(a),c=Jmat.BigInt.lshift(Jmat.BigInt(1),b),d=c.subr(1),e=Jmat.BigInt.invmod(a,c).neg().bitand(d),f=c.lshift(b).mod(a);return function(c,h){return h?Jmat.BigInt.monred_(c.mul(f),b,d,a,e):Jmat.BigInt.monred_(c,b,d,a,e)}};
Jmat.BigInt.modpow=function(a,b,c,d){var e=Jmat.BigInt,f=b;b=e.cast(b,2);b=e.maybecopystrip_(b.a,b!=f);f=e.ONE;a.gt(c)&&(a=a.mod(c));var g=b.length;if(c.modr(2).eqr(1)&&1<g){c=d||e.genmonred_(c);f=c(f,!0);a=c(a,!0);for(d=0;d<g;d++)0==b[d]?(a=f.mul(a),f=f.mul(f)):(f=f.mul(a),a=a.mul(a)),f=c(f),a=c(a);f=c(f)}else for(d=0;d<g;d++)0==b[d]?(a=f.mul(a).mod(c),f=f.mul(f).mod(c)):(f=f.mul(a).mod(c),a=a.mul(a).mod(c));return f};
Jmat.BigInt.randomBits=function(a){for(var b=Jmat.BigInt([],Jmat.BigInt.ARRAYBASE_),c=Math.ceil(a/Jmat.BigInt.ARRAYBASE_BITS_),d=0;d<c;d++)b.a[d]=Math.floor(Jmat.BigInt.ARRAYBASE_*Math.random());a=a*(Jmat.BigInt.ARRAYBASE_BITS_-1)%Jmat.BigInt.ARRAYBASE_BITS_;c=Jmat.BigInt.ARRAYBASE_-1;for(d=0;d<a;d++)c=Math.floor(c/2);c+1<Jmat.BigInt.ARRAYBASE_&&(b.a[0]&=c);return b};Jmat.BigInt.randomPrime=function(a){return Jmat.BigInt.nextPrime(Jmat.BigInt.randomBits(a))};
Jmat.BigInt.firstPrimes_=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97];Jmat.BigInt.isPrimeSimple=function(a){a=Jmat.BigInt.cast(a);if(a.ltr(2))return 0;for(var b=0;b<Jmat.BigInt.firstPrimes_.length;b++){if(a.eqr(Jmat.BigInt.firstPrimes_[b]))return 1;if(0==a.modr(Jmat.BigInt.firstPrimes_[b]).toInt())return 0}return-1};
Jmat.BigInt.isPrimeMillerRabin=function(a,b){for(var c=Jmat.BigInt,d=b||c.chooseMillerRabinBase_(a),e=a.divr(2),f=c.ONE;c.bitand(e,c.ONE).eqr(0);)e=e.divr(2),f=f.addr(1);for(var g=c.genmonred_(a),h=0;h<d.length;h++){var k;a:{k=a;for(var l=f,m=c.cast(d[h]),m=c.modpow(m,e,k,g),n=void 0;!l.eqr(0);){n=m.mul(m).mod(k);if(n.eqr(1)&&!m.eqr(1)&&!m.eq(k.subr(1))){k=!1;break a}m=n;l=l.subr(1)}k=n.eqr(1)}if(!k)return!1}return!0};
Jmat.BigInt.chooseMillerRabinBase_=function(a){var b=Jmat.BigInt.getNumBits(a);if(64>=b)a=a.ltr(1373653)?[2,3]:a.ltr(9080191)?[31,73]:a.ltr(4759123141)?[2,7,61]:a.ltr(1122004669633)?[2,13,23,1662803]:a.ltr(2152302898747)?[2,3,5,7,11]:a.ltr(3474749660383)?[2,3,5,7,11,13]:a.ltr(341550071728321)?[2,3,5,7,11,13,17]:a.ltr(0xd655278977733)?[2,2570940,880937,610386380,4130785767]:[2,325,9375,28178,450775,9780504,1795265022];else{a=[2,3];for(var c=0;18>c;c++)a.push(Jmat.BigInt.randomBits(b-1))}return a};
Jmat.BigInt.isPrime=function(a){if(a.ltr(Jmat.Real.BIGGESTJSPRIME))return Jmat.Real.isPrime(a.toInt());var b=Jmat.BigInt.isPrimeSimple(a);return-1!=b?!!b:Jmat.BigInt.isPrimeMillerRabin(a)};Jmat.BigInt.d_="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");Jmat.BigInt.di_=function(a){a=a.charCodeAt(0);if(57>=a)return a-48;90<a&&(a-=32);return a-65+10};Jmat.BigInt.mirror_=function(a){for(var b=0;b<a.length/2;b++){var c=a[b];a[b]=a[a.length-b-1];a[a.length-b-1]=c}};
Jmat.BigInt.getNumBits=function(a){a.radix&&0==(a.radix&a.radix-1)||(a=Jmat.BigInt.cast(a,Jmat.BigInt.ARRAYBASE_));var b=Jmat.BigInt.maybecopystrip_(a.a);if(0==b.length)return 0;var c=Jmat.Real.ilog2(b[0])+1;0<b.length&&(a=Jmat.Real.ilog2(a.radix),c+=a*(b.length-1));return c};Jmat.BigInt.getNumDigits=function(a){for(var b=0;b<a.a.length&&0==a.a[b];)b++;return a.a.length-b};Jmat.BigInt.stripInPlace_=function(a){for(;0==a[0]&&1<a.length;)a.shift()};
Jmat.BigInt.copystrip_=function(a){for(var b=0,c=0;c<a.a.length&&0==a.a[c];c++)b++;var d=Array(a.a.length-b);if(0==d.length)return new Jmat.BigInt([0],a.radix);for(c=0;c<d.length;c++)d[c]=a.a[c+b];return Jmat.BigInt(d,a.radix)};Jmat.BigInt.maybecopystrip_=function(a,b){if(1>=a.length||0!=a[0])return a;b||(a=Jmat.BigInt.copyarray_(a));Jmat.BigInt.stripInPlace_(a);return a};Jmat.BigInt.strip=function(a){return a.strip()};
Jmat.BigInt.prototype.strip=function(){return 1>=this.a.length||0!=this.a[0]?this:Jmat.BigInt.copystrip_(this)};Jmat.BigInt.copyarray_=function(a){return a.slice(0)};Jmat.BigInt.FORMAT_UNKNOWN_=0;Jmat.BigInt.FORMAT_BIGINT_=1;Jmat.BigInt.FORMAT_ARRAY_=2;Jmat.BigInt.FORMAT_STRING_=3;Jmat.BigInt.getFormat=function(a){return"string"==typeof a?Jmat.BigInt.FORMAT_STRING_:"[object Array]"===Object.prototype.toString.call(a)?Jmat.BigInt.FORMAT_ARRAY_:a instanceof Jmat.BigInt?Jmat.BigInt.FORMAT_BIGINT_:Jmat.BigInt.FORMAT_UNKNOWN_};
Jmat.BigInt.toFormat=function(a,b,c){if(void 0!=a){if(b==Jmat.BigInt.getFormat(a)){if(void 0==c)return a;if(b==Jmat.BigInt.FORMAT_BIGINT_)return a.minus==c?a:a.neg();if(b==Jmat.BigInt.FORMAT_STRING_)return"-"==a[0]==c?a:c?"-"+a:a.substr(1)}a=Jmat.BigInt.cast(a);void 0!=c&&a.minus!=c&&(a=a.neg());return b==Jmat.BigInt.FORMAT_BIGINT_?a:b==Jmat.BigInt.FORMAT_ARRAY_?a.a:b==Jmat.BigInt.FORMAT_STRING_||b==Jmat.BigInt.FORMAT_UNKNOWN_?a.toString():a}};
Jmat.BigInt.enrichFunction_=function(a,b,c,d){if(3==d)Jmat.BigInt.enrichFunction_(b,c,0),1<c&&Jmat.BigInt.enrichFunction_(b,c-1,2);else if(4==d)Jmat.BigInt.enrichFunction_(b,c,1),1<c&&Jmat.BigInt.enrichFunction_(b,c-1,2);else{var e=2==d?Jmat.BigInt.prototype[b]:Jmat.BigInt[b],f=function(){for(var a=Jmat.BigInt.getFormat(arguments[0]),b=0;b<c;b++)arguments[b]=Jmat.BigInt.cast(arguments[b]);b=e.apply(this,arguments);return 1==d?Jmat.BigInt.toFormat(b,a):b};2==e.length&&2==c&&1==d&&(f=function(a,b){var c=
e(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b));return Jmat.BigInt.toFormat(c,Jmat.BigInt.getFormat(a))});1==e.length&&1==c&&2==d&&(f=function(a){return e.call(this,Jmat.BigInt.cast(a))});2==d?a.prototype[b]=f:a[b]=f}};
Jmat.BigInt.enrichFunctions_=function(){Jmat.BigIntC=function(){return Jmat.BigInt.apply(this,arguments)};for(var a in Jmat.BigInt)Jmat.BigIntC[a]=Jmat.BigInt[a];for(a in Jmat.BigInt.prototype)Jmat.BigIntC.prototype[a]=Jmat.BigInt.prototype[a];a=Jmat.BigIntC;Jmat.BigInt.enrichFunction_(a,"add",2,1);Jmat.BigInt.enrichFunction_(a,"addr",1,1);Jmat.BigInt.enrichFunction_(a,"sub",2,1);Jmat.BigInt.enrichFunction_(a,"subr",1,1);Jmat.BigInt.enrichFunction_(a,"mul",2,1);Jmat.BigInt.enrichFunction_(a,"mulr",
1,1);Jmat.BigInt.enrichFunction_(a,"div",2,1);Jmat.BigInt.enrichFunction_(a,"divr",1,1);Jmat.BigInt.enrichFunction_(a,"mod",2,1);Jmat.BigInt.enrichFunction_(a,"modr",1,1);Jmat.BigInt.enrichFunction_(a,"divmod",2,0);Jmat.BigInt.enrichFunction_(a,"lshift",1,1);Jmat.BigInt.enrichFunction_(a,"rshift",1,1);Jmat.BigInt.enrichFunction_(a,"bitand",2,1);Jmat.BigInt.enrichFunction_(a,"bitor",2,1);Jmat.BigInt.enrichFunction_(a,"bitxor",2,1);Jmat.BigInt.enrichFunction_(a,"bitneg",1,1);Jmat.BigInt.enrichFunction_(a,
"bitnot",1,1);Jmat.BigInt.enrichFunction_(a,"abs",1,1);Jmat.BigInt.enrichFunction_(a,"neg",1,1);Jmat.BigInt.enrichFunction_(a,"sign",1,0);Jmat.BigInt.enrichFunction_(a,"getSign",1,0);Jmat.BigInt.enrichFunction_(a,"nonZero",1,0);Jmat.BigInt.enrichFunction_(a,"compare",2,0);Jmat.BigInt.enrichFunction_(a,"comparer",1,0);Jmat.BigInt.enrichFunction_(a,"sqrt",1,1);Jmat.BigInt.enrichFunction_(a,"root",2,1);Jmat.BigInt.enrichFunction_(a,"rootr",1,1);Jmat.BigInt.enrichFunction_(a,"logy",2,1);Jmat.BigInt.enrichFunction_(a,
"logr",1,1);Jmat.BigInt.enrichFunction_(a,"log2",1,1);Jmat.BigInt.enrichFunction_(a,"log10",1,1);Jmat.BigInt.enrichFunction_(a,"rlog2",1,0);Jmat.BigInt.enrichFunction_(a,"rlog",1,0);Jmat.BigInt.enrichFunction_(a,"rlog10",1,0);Jmat.BigInt.enrichFunction_(a,"pow",2,1);Jmat.BigInt.enrichFunction_(a,"powr",1,1);Jmat.BigInt.enrichFunction_(a,"gcd",2,1);Jmat.BigInt.enrichFunction_(a,"egcd",2,0);Jmat.BigInt.enrichFunction_(a,"invmod",2,1);Jmat.BigInt.enrichFunction_(a,"modpow",3,1);Jmat.BigInt.enrichFunction_(a,
"isPrimeSimple",1,0);Jmat.BigInt.enrichFunction_(a,"isPrimeMillerRabin",1,0);Jmat.BigInt.enrichFunction_(a,"isPrime",1,0);Jmat.BigInt.enrichFunction_(a,"perfectpow",1,0);Jmat.BigInt.enrichFunction_(a,"nextPrime",1,1);Jmat.BigInt.enrichFunction_(a,"factorize",1,0);Jmat.BigInt.enrichFunction_(a,"factorial",1,1);Jmat.BigInt.enrichFunction_(a,"primorial",1,1);Jmat.BigInt.enrichFunction_(a,"legendre",2,0);Jmat.BigInt.enrichFunction_(a,"ressol",2,1)};Jmat.BigInt.enrichFunctions_();Jmat.add=function(a,b){return Jmat.matrixIn_(a)&&Jmat.matrixIn_(b)?Jmat.Matrix.add(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.add(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.add(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.Complex.add(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.sub=function(a,b){return Jmat.matrixIn_(a)&&Jmat.matrixIn_(b)?Jmat.Matrix.sub(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.sub(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.sub(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.Complex.sub(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.mul=function(a,b){return Jmat.matrixIn_(a)&&Jmat.matrixIn_(b)?Jmat.Matrix.mul(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.matrixIn_(a)?Jmat.Matrix.mulc(Jmat.Matrix.cast(a),Jmat.Complex.cast(b)):Jmat.matrixIn_(b)?Jmat.Matrix.mulc(Jmat.Matrix.cast(b),Jmat.Complex.cast(a)):Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.mul(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.mul(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.Complex.mul(Jmat.Complex.cast(a),
Jmat.Complex.cast(b))};
Jmat.div=function(a,b){return Jmat.matrixIn_(a)&&Jmat.matrixIn_(b)?Jmat.Matrix.div(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.matrixIn_(a)?Jmat.Matrix.divc(Jmat.Matrix.cast(a),Jmat.Complex.cast(b)):Jmat.matrixIn_(b)?Jmat.Matrix.divc(Jmat.Matrix.cast(b),Jmat.Complex.cast(a)):Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.div(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.div(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.Complex.div(Jmat.Complex.cast(a),
Jmat.Complex.cast(b))};Jmat.eq=function(a,b){return Jmat.matrixIn_(a)&&Jmat.matrixIn_(b)?Jmat.Matrix.eq(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.matrixIn_(a)||Jmat.matrixIn_(b)?!1:Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.eq(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.eq(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.Complex.eq(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.near=function(a,b,c){return Jmat.matrixIn_(a)&&Jmat.matrixIn_(b)?Jmat.Matrix.near(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b),Jmat.Real.caststrict(c)):Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.near(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b),Jmat.Real.caststrict(c)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.eq(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.Complex.near(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Real.caststrict(c))};
Jmat.relnear=function(a,b,c){return Jmat.matrixIn_(a)&&Jmat.matrixIn_(b)?Jmat.Matrix.relnear(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b),Jmat.Real.caststrict(c)):Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.relnear(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b),Jmat.Real.caststrict(c)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.eq(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.Complex.relnear(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Real.caststrict(c))};
Jmat.isNaN=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.isNaN(Jmat.Matrix.cast(a)):Jmat.Complex.isNaN(Jmat.Complex.cast(a))};Jmat.pow=function(a,b){return Jmat.matrixIn_(a)?Jmat.Matrix.powc(Jmat.Matrix.cast(a),Jmat.Complex.cast(b)):Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.pow(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.Complex.pow(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.sqrt=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.sqrt(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.sqrt(Jmat.Quaternion.cast(a)):Jmat.bigIntIn_(a)?Jmat.BigInt.sqrt(Jmat.BigInt.cast(a)):Jmat.Complex.sqrt(Jmat.Complex.cast(a))};Jmat.exp=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.exp(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.exp(Jmat.Quaternion.cast(a)):Jmat.Complex.exp(Jmat.Complex.cast(a))};
Jmat.log=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.log(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.log(Jmat.Quaternion.cast(a)):Jmat.Complex.log(Jmat.Complex.cast(a))};Jmat.log1p=function(a){return Jmat.Complex.log1p(Jmat.Complex.cast(a))};Jmat.expm1=function(a){return Jmat.Complex.expm1(Jmat.Complex.cast(a))};
Jmat.logy=function(a,b){return Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.logy(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.Complex.logy(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.log2=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.log2(Jmat.Quaternion.cast(a)):Jmat.Complex.log2(Jmat.Complex.cast(a))};Jmat.log10=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.log10(Jmat.Quaternion.cast(a)):Jmat.Complex.log10(Jmat.Complex.cast(a))};
Jmat.lambertw=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.lambertw(Jmat.Quaternion.cast(a)):Jmat.Complex.lambertw(Jmat.Complex.cast(a))};Jmat.lambertwm=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.lambertwm(Jmat.Quaternion.cast(a)):Jmat.Complex.lambertwm(Jmat.Complex.cast(a))};Jmat.lambertwb=function(a,b){return Jmat.quaternionIn_(b)?Jmat.Quaternion.lambertwb(a,Jmat.Quaternion.cast(b)):Jmat.Complex.lambertwb(Jmat.Real.caststrict(a),Jmat.Complex.cast(b))};
Jmat.tetration=function(a,b){return Jmat.Complex.tetration(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.tetrational=function(a){return Jmat.Complex.tetrational(Jmat.Complex.cast(a))};Jmat.x=function(a){return Jmat.Complex.cast(a)};Jmat.neg=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.neg(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.neg(Jmat.Quaternion.cast(a)):Jmat.Complex.neg(Jmat.Complex.cast(a))};
Jmat.inv=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.inv(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.inv(Jmat.Quaternion.cast(a)):Jmat.Complex.inv(Jmat.Complex.cast(a))};Jmat.conj=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.conj(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.conj(Jmat.Quaternion.cast(a)):Jmat.Complex.conj(Jmat.Complex.cast(a))};
Jmat.sin=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.sin(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.zin(Jmat.Quaternion.cast(a)):Jmat.Complex.sin(Jmat.Complex.cast(a))};Jmat.cos=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.cos(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.cos(Jmat.Quaternion.cast(a)):Jmat.Complex.cos(Jmat.Complex.cast(a))};Jmat.tan=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.tan(Jmat.Quaternion.cast(a)):Jmat.Complex.tan(Jmat.Complex.cast(a))};
Jmat.asin=function(a){return Jmat.Complex.asin(Jmat.Complex.cast(a))};Jmat.acos=function(a){return Jmat.Complex.acos(Jmat.Complex.cast(a))};Jmat.atan=function(a){return Jmat.Complex.atan(Jmat.Complex.cast(a))};Jmat.atan2=function(a,b){return Jmat.Complex.atan2(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.sinc=function(a){return Jmat.Complex.sinc(Jmat.Complex.cast(a))};Jmat.sinh=function(a){return Jmat.Complex.sinh(Jmat.Complex.cast(a))};Jmat.cosh=function(a){return Jmat.Complex.cosh(Jmat.Complex.cast(a))};
Jmat.tanh=function(a){return Jmat.Complex.tanh(Jmat.Complex.cast(a))};Jmat.asinh=function(a){return Jmat.Complex.asinh(Jmat.Complex.cast(a))};Jmat.acosh=function(a){return Jmat.Complex.acosh(Jmat.Complex.cast(a))};Jmat.atanh=function(a){return Jmat.Complex.atanh(Jmat.Complex.cast(a))};Jmat.gamma=function(a){return Jmat.Complex.gamma(Jmat.Complex.cast(a))};Jmat.factorial=function(a){return Jmat.Complex.factorial(Jmat.Complex.cast(a))};Jmat.digamma=function(a){return Jmat.Complex.digamma(Jmat.Complex.cast(a))};
Jmat.trigamma=function(a){return Jmat.Complex.trigamma(Jmat.Complex.cast(a))};Jmat.polygamma=function(a,b){return Jmat.Complex.polygamma(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.loggamma=function(a){return Jmat.Complex.loggamma(Jmat.Complex.cast(a))};Jmat.gamma_inv=function(a){return Jmat.Complex.gamma_inv(Jmat.Complex.cast(a))};Jmat.incgamma_lower=function(a,b){return Jmat.Complex.incgamma_lower(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.incgamma_upper=function(a,b){return Jmat.Complex.incgamma_upper(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.gamma_p=function(a,b){return Jmat.Complex.gamma_p(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.gamma_q=function(a,b){return Jmat.Complex.gamma_q(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.gamma_p_inv=function(a,b){return Jmat.Complex.gamma_p_inv(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.beta=function(a,b){return Jmat.Complex.beta(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.incbeta=function(a,b,c){return Jmat.Complex.incbeta(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.beta_i=function(a,b,c){return Jmat.Complex.beta_i(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.beta_i_inv=function(a,b,c){return Jmat.Complex.beta_i_inv(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.re=function(a){return Jmat.Complex(Jmat.Complex.cast(a).re)};Jmat.im=function(a){return Jmat.Complex(Jmat.Complex.cast(a).im)};
Jmat.abs=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.abs(Jmat.Quaternion.cast(a)):Jmat.Complex.abs(Jmat.Complex.cast(a))};Jmat.arg=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.qrg(Jmat.Quaternion.cast(a)):Jmat.Complex.arg(Jmat.Complex.cast(a))};Jmat.sign=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.sign(Jmat.Quaternion.cast(a)):Jmat.Complex.sign(Jmat.Complex.cast(a))};
Jmat.dist=function(a,b){return Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.dist(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.dist(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.matrixIn_(a)||Jmat.matrixIn_(b)?Jmat.Matrix.dist(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.Complex.dist(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.cheb=function(a,b){return Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.cheb(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.cheb(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.matrixIn_(a)||Jmat.matrixIn_(b)?Jmat.Matrix.cheb(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.Complex.cheb(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.manhattan=function(a,b){return Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.manhattan(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.manhattan(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.matrixIn_(a)||Jmat.matrixIn_(b)?Jmat.Matrix.manhattan(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.Complex.manhattan(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.csgn=function(a){return Jmat.Complex.csgn(Jmat.Complex.cast(a))};
Jmat.floor=function(a){return Jmat.Complex.floor(Jmat.Complex.cast(a))};Jmat.ceil=function(a){return Jmat.Complex.ceil(Jmat.Complex.cast(a))};Jmat.round=function(a){return Jmat.Complex.round(Jmat.Complex.cast(a))};Jmat.trunc=function(a){return Jmat.Complex.trunc(Jmat.Complex.cast(a))};Jmat.frac=function(a){return Jmat.Complex.frac(Jmat.Complex.cast(a))};Jmat.fracn=function(a){return Jmat.Complex.fracn(Jmat.Complex.cast(a))};
Jmat.rotate=function(a,b){return Jmat.Complex.rotate(Jmat.Complex.cast(a),Jmat.Real.caststrict(b))};Jmat.decompose=function(a,b){return Jmat.Complex.decompose(Jmat.Complex.cast(a),Jmat.Real.cast(b))};Jmat.lerp=function(a,b,c){return Jmat.Complex.lerp(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.besselj=function(a,b){return Jmat.Complex.besselj(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.bessely=function(a,b){return Jmat.Complex.bessely(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.besseli=function(a,b){return Jmat.Complex.besseli(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.besselk=function(a,b){return Jmat.Complex.besselk(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.hankelh1=function(a,b){return Jmat.Complex.hankelh1(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.hankelh2=function(a,b){return Jmat.Complex.hankelh2(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.airy=function(a){return Jmat.Complex.airy(Jmat.Complex.cast(a))};Jmat.bairy=function(a){return Jmat.Complex.bairy(Jmat.Complex.cast(a))};
Jmat.airy_deriv=function(a){return Jmat.Complex.airy_deriv(Jmat.Complex.cast(a))};Jmat.bairy_deriv=function(a){return Jmat.Complex.bairy_deriv(Jmat.Complex.cast(a))};Jmat.struveh=function(a,b){return Jmat.Complex.struveh(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.struvek=function(a,b){return Jmat.Complex.struvek(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.struvel=function(a,b){return Jmat.Complex.struvel(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.struvem=function(a,b){return Jmat.Complex.struvem(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.angerj=function(a,b){return Jmat.Complex.angerj(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.webere=function(a,b){return Jmat.Complex.webere(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.theta1=function(a,b){return Jmat.Complex.theta1(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.theta2=function(a,b){return Jmat.Complex.theta2(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.theta3=function(a,b){return Jmat.Complex.theta3(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.theta4=function(a,b){return Jmat.Complex.theta4(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.zeta=function(a){return Jmat.Complex.zeta(Jmat.Complex.cast(a))};Jmat.eta=function(a){return Jmat.Complex.eta(Jmat.Complex.cast(a))};Jmat.lambda=function(a){return Jmat.Complex.lambda(Jmat.Complex.cast(a))};Jmat.dilog=function(a){return Jmat.Complex.dilog(Jmat.Complex.cast(a))};Jmat.trilog=function(a){return Jmat.Complex.trilog(Jmat.Complex.cast(a))};
Jmat.polylog=function(a,b){return Jmat.Complex.polylog(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.hurwitzzeta=function(a,b){return Jmat.Complex.hurwitzzeta(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.hypergeometric0F1=function(a,b){return Jmat.Complex.hypergeometric0F1(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.hypergeometric1F1=function(a,b,c){return Jmat.Complex.hypergeometric1F1(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.hypergeometric2F1=function(a,b,c,d){return Jmat.Complex.hypergeometric2F1(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c),Jmat.Complex.cast(d))};Jmat.hypergeometric=function(a,b,c){for(var d=[],e=0;e<a.length;e++)d[e]=Jmat.Complex.cast(a[e]);a=[];for(e=0;e<b.length;e++)a[e]=Jmat.Complex.cast(b[e]);return Jmat.Complex.hypergeometric(d,a,Jmat.Complex.cast(c))};Jmat.erf=function(a){return Jmat.Complex.erf(Jmat.Complex.cast(a))};Jmat.erfc=function(a){return Jmat.Complex.erfc(Jmat.Complex.cast(a))};
Jmat.erfcx=function(a){return Jmat.Complex.erfcx(Jmat.Complex.cast(a))};Jmat.erf_inv=function(a){return Jmat.Complex.erf_inv(Jmat.Complex.cast(a))};Jmat.erfc_inv=function(a){return Jmat.Complex.erfc_inv(Jmat.Complex.cast(a))};Jmat.erfi=function(a){return void 0==a.re?Jmat.Complex(Jmat.Real.erfi(a)):Jmat.Complex.erfi(Jmat.Complex.cast(a))};Jmat.dawson=function(a){return void 0==a.re?Jmat.Complex(Jmat.Real.dawson(a)):Jmat.Complex.dawson(Jmat.Complex.cast(a))};Jmat.faddeeva=function(a){return Jmat.Complex.faddeeva(Jmat.Complex.cast(a))};
Jmat.pdf_uniform=function(a,b,c){return Jmat.Complex.pdf_uniform(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_uniform=function(a,b,c){return Jmat.Complex.cdf_uniform(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.qf_uniform=function(a,b,c){return Jmat.Complex.qf_uniform(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.pdf_standardnormal=function(a){return Jmat.Complex.pdf_standardnormal(Jmat.Complex.cast(a))};
Jmat.cdf_standardnormal=function(a){return Jmat.Complex.cdf_standardnormal(Jmat.Complex.cast(a))};Jmat.qf_standardnormal=function(a){return Jmat.Complex.qf_standardnormal(Jmat.Complex.cast(a))};Jmat.pdf_normal=function(a,b,c){return Jmat.Complex.pdf_normal(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_normal=function(a,b,c){return Jmat.Complex.cdf_normal(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.qf_normal=function(a,b,c){return Jmat.Complex.qf_normal(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.pdf_lognormal=function(a,b,c){return Jmat.Complex.pdf_lognormal(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_lognormal=function(a,b,c){return Jmat.Complex.cdf_lognormal(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.qf_lognormal=function(a,b,c){return Jmat.Complex.qf_lognormal(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.pdf_cauchy=function(a,b,c){return Jmat.Complex.pdf_cauchy(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_cauchy=function(a,b,c){return Jmat.Complex.cdf_cauchy(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.qf_cauchy=function(a,b,c){return Jmat.Complex.qf_cauchy(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.pdf_studentt=function(a,b){return Jmat.Complex.pdf_studentt(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.cdf_studentt=function(a,b){return Jmat.Complex.cdf_studentt(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.qf_studentt=function(a,b){return Jmat.Complex.qf_studentt(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.pdf_chi_square=function(a,b){return Jmat.Complex.pdf_chi_square(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.cdf_chi_square=function(a,b){return Jmat.Complex.cdf_chi_square(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.qf_chi_square=function(a,b){return Jmat.Complex.qf_chi_square(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.pdf_logistic=function(a,b,c){return Jmat.Complex.pdf_logistic(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_logistic=function(a,b,c){return Jmat.Complex.cdf_logistic(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.qf_logistic=function(a,b,c){return Jmat.Complex.qf_logistic(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.pdf_gamma=function(a,b,c){return Jmat.Complex.pdf_gamma(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_gamma=function(a,b,c){return Jmat.Complex.cdf_gamma(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.qf_gamma=function(a,b,c){return Jmat.Complex.qf_gamma(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.pdf_beta=function(a,b,c){return Jmat.Complex.pdf_beta(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_beta=function(a,b,c){return Jmat.Complex.cdf_beta(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.qf_beta=function(a,b,c){return Jmat.Complex.qf_beta(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.pdf_fisher=function(a,b,c){return Jmat.Complex.pdf_fisher(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.cdf_fisher=function(a,b,c){return Jmat.Complex.cdf_fisher(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.qf_fisher=function(a,b,c){return Jmat.Complex.qf_fisher(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.pdf_weibull=function(a,b,c){return Jmat.Complex.pdf_weibull(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_weibull=function(a,b,c){return Jmat.Complex.cdf_weibull(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.qf_weibull=function(a,b,c){return Jmat.Complex.qf_weibull(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.pdf_exponential=function(a,b){return Jmat.Complex.pdf_exponential(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.cdf_exponential=function(a,b){return Jmat.Complex.cdf_exponential(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.qf_exponential=function(a,b){return Jmat.Complex.qf_exponential(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.pdf_laplace=function(a,b,c){return Jmat.Complex.pdf_laplace(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_laplace=function(a,b,c){return Jmat.Complex.cdf_laplace(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.qf_laplace=function(a,b,c){return Jmat.Complex.qf_laplace(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.permutation=function(a,b){return Jmat.Complex.permutation(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.binomial=function(a,b){return Jmat.Complex.binomial(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.stirling2=function(a,b){return Jmat.Complex.stirling2(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.agm=function(a,b){return Jmat.Complex.agm(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.ghm=function(a,b){return Jmat.Complex.ghm(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.isPrime=function(a){return Jmat.Complex.isPrime(Jmat.Complex.cast(a))};Jmat.smallestPrimeFactor=function(a){return Jmat.Complex(Jmat.Real.smallestPrimeFactor(Jmat.Real.cast(a)))};
Jmat.factorize=function(a){a=Jmat.Real.factorize(Jmat.Real.caststrict(a));for(var b=0;b<a.length;b++)a[b]=Jmat.Complex(a[b]);return a};Jmat.eulerTotient=function(a){return Jmat.Complex(Jmat.Real.eulerTotient(Jmat.Real.caststrict(a)))};Jmat.primeCount=function(a){return Jmat.Complex(Jmat.Real.primeCount(Jmat.Real.caststrict(a)))};Jmat.nearestPrime=function(a){return Jmat.Complex(Jmat.Real.nearestPrime(Jmat.Real.cast(a)))};Jmat.nextPrime=function(a){return Jmat.Complex(Jmat.Real.nextPrime(Jmat.Real.cast(a)))};
Jmat.previousPrime=function(a){return Jmat.Complex(Jmat.Real.previousPrime(Jmat.Real.cast(a)))};Jmat.gcd=function(a,b){return Jmat.Complex(Jmat.Real.gcd(Jmat.Real.caststrict(a),Jmat.Real.caststrict(b)))};Jmat.lcm=function(a,b){return Jmat.Complex(Jmat.Real.lcm(Jmat.Real.caststrict(a),Jmat.Real.caststrict(b)))};Jmat.dms=function(a){return Jmat.Complex(Jmat.Real.dms(Jmat.Real.caststrict(a)))};Jmat.dd=function(a){return Jmat.Complex(Jmat.Real.dd(Jmat.Real.caststrict(a)))};Jmat.bitneg=function(a){return Jmat.Complex.bitneg(Jmat.Complex.cast(a))};
Jmat.bitand=function(a,b){return Jmat.Complex.bitand(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.bitor=function(a,b){return Jmat.Complex.bitor(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.bitxor=function(a,b){return Jmat.Complex.bitxor(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.lshift=function(a,b){return Jmat.Complex.lshift(Jmat.Complex.cast(a),Jmat.Real.caststrict(b))};Jmat.rshift=function(a,b){return Jmat.Complex.rshift(Jmat.Complex.cast(a),Jmat.Real.caststrict(b))};
Jmat.mod=function(a,b){return Jmat.Complex.mod(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.rem=function(a,b){return Jmat.Complex.rem(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.wrap=function(a,b,c){return Jmat.Complex.wrap(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.clamp=function(a,b,c){return Jmat.Complex.clamp(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.minkowski=function(a){return Jmat.Complex.minkowski(Jmat.Complex.cast(a))};
Jmat.lu=function(a){return Jmat.Matrix.lu(Jmat.Matrix.cast(a))};Jmat.qr=function(a){return Jmat.Matrix.qr(Jmat.Matrix.cast(a))};Jmat.svd=function(a){return Jmat.Matrix.svd(Jmat.Matrix.cast(a))};Jmat.eig=function(a){return Jmat.Matrix.eig(Jmat.Matrix.cast(a))};Jmat.pseudoinverse=function(a){return Jmat.Matrix.pseudoinverse(Jmat.Matrix.cast(a))};Jmat.determinant=function(a){return Jmat.Matrix.determinant(Jmat.Matrix.cast(a))};Jmat.transpose=function(a){return Jmat.Matrix.transpose(Jmat.Matrix.cast(a))};
Jmat.transjugate=function(a){return Jmat.Matrix.transjugate(Jmat.Matrix.cast(a))};Jmat.trace=function(a){return Jmat.Matrix.trace(Jmat.Matrix.cast(a))};Jmat.rank=function(a){return Jmat.Matrix.rank(Jmat.Matrix.cast(a))};Jmat.adj=function(a){return Jmat.Matrix.adj(Jmat.Matrix.cast(a))};Jmat.fft=function(a){return Jmat.Matrix.fft(Jmat.Matrix.cast(a))};Jmat.ifft=function(a){return Jmat.Matrix.ifft(Jmat.Matrix.cast(a))};Jmat.solve=function(a,b){return Jmat.Matrix.solve(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b))};
Jmat.dot=function(a,b){return Jmat.Matrix.dot(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b))};Jmat.cross=function(a,b){return Jmat.Matrix.cross(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b))};Jmat.minor=function(a,b,c){return Jmat.Matrix.minor(Jmat.Matrix.cast(a),Jmat.Real.caststrict(b),Jmat.Real.caststrict(c))};Jmat.cofactor=function(a,b,c){return Jmat.Matrix.cofactor(Jmat.Matrix.cast(a),Jmat.Real.caststrict(b),Jmat.Real.caststrict(c))};
Jmat.submatrix=function(a,b,c,d,e){return Jmat.Matrix.submatrix(Jmat.Matrix.cast(a),Jmat.Real.caststrict(b),Jmat.Real.caststrict(c),Jmat.Real.caststrict(d),Jmat.Real.caststrict(e))};Jmat.svd=function(a){return Jmat.Matrix.svd(Jmat.Matrix.cast(a))};Jmat.evd=function(a){return Jmat.Matrix.evd(Jmat.Matrix.cast(a))};Jmat.qr=function(a){return Jmat.Matrix.qr(Jmat.Matrix.cast(a))};Jmat.norm=function(a){return Jmat.Matrix.norm(Jmat.Matrix.cast(a))};Jmat.norm2=function(a){return Jmat.Matrix.norm2(Jmat.Matrix.cast(a))};
Jmat.maxcolnorm=function(a){return Jmat.Matrix.maxcolnorm(Jmat.Matrix.cast(a))};Jmat.maxrownorm=function(a){return Jmat.Matrix.maxrownorm(Jmat.Matrix.cast(a))};Jmat.differentiate=function(a,b){return Jmat.Complex.differentiate(Jmat.Complex.cast(a),b)};Jmat.integrate=function(a,b,c,d){return Jmat.Complex.integrate(Jmat.Complex.cast(a),Jmat.Complex.cast(b),c,Jmat.Real.caststrict(d))};Jmat.rootfind_newton=function(a,b,c,d){return Jmat.Complex.rootfind_newton(a,b,Jmat.Complex.cast(c),Jmat.Real.caststrict(d))};
Jmat.rootfind_newton_noderiv=function(a,b,c){return Jmat.Complex.rootfind_newton_noderiv(a,Jmat.Complex.cast(b),Jmat.Real.caststrict(c))};Jmat.matrixIn_=function(a){return a?"string"==typeof a?2>a.length?!1:"["==a[0]?!0:"-"==a[0]||48<=a.charCodeAt(0)&&57>=a.charCodeAt(0)?!1:-1!=a.indexOf("["):a&&(a instanceof Jmat.Matrix||void 0!=a.length):!1};Jmat.quaternionIn_=function(a){return a?"string"==typeof a&&(0<=a.indexOf("j")||0<=a.indexOf("k"))?!0:a&&a instanceof Jmat.Quaternion:!1};
Jmat.bigIntIn_=function(a){return a?"string"==typeof a&&16<a.length&&-1==a.indexOf(".")&&-1==a.indexOf("e")&&-1==a.indexOf("E")?!0:a&&a instanceof Jmat.BigInt:!1};
Jmat.toString_=function(a,b,c){if(!a)return""+a;var d="";if(b&&a.render)return"\n"+a.render(c);if("object"==typeof a&&Array.isArray(a)){for(var d=d+"[",e=0;e<a.length;e++)d+=Jmat.toString_(a[e],b,c)+(e+1==a.length?"":", ");return d+"]"}if(a.constructor==Object){var d=d+"{",e=!1,f;for(f in a)f&&a[f]&&(e&&(d+=", "),d+=f+": ",d+=Jmat.toString_(a[f],b,c),e=!0);return d+="}"}return d=b&&a.render?"\n"+a.render(c):a.toString?a.toString(c):""+a};Jmat.toString=function(a){return Jmat.toString_(a,!1)};
Jmat.print=function(a){console.log(Jmat.toString(a))};Jmat.render=function(a,b){return Jmat.toString_(a,!0,b)};var Real=Jmat.Real,Complex=Jmat.Complex,Matrix=Jmat.Matrix,BigInt=Jmat.BigIntC||Jmat.BigInt,Quaternion=Jmat.Quaternion;["gamma","factorial","lambertw","erf","erfc"].map(function(a){Math[a]||(Math[a]=Jmat.Real[a])});"sinh cosh tanh asinh acosh atanh clz32 log2 log10 log1p expm1".split(" ").map(function(a){Math[a]||(Math[a]=Jmat.Real[a])});
